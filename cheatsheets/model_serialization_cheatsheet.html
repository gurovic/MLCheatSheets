<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π ML Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

    .container {
      column-count: 3;
      column-gap: 20px;
      max-width: 100%;
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üíæ –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π ML Cheatsheet</h1>
  <div class="subtitle">–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ ‚Ä¢ Production deployment ‚Ä¢ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ<br>üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –ó–∞—á–µ–º –Ω—É–∂–Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è</h2>
    <ul>
      <li><strong>–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ</strong>: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ production</li>
      <li><strong>–≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏</strong>: –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∞—Ç—å –∫–∞–∂–¥—ã–π —Ä–∞–∑</li>
      <li><strong>–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö –≤–µ—Ä—Å–∏–π –º–æ–¥–µ–ª–∏</li>
      <li><strong>–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å</strong>: —Ç–æ—á–Ω–æ —Ç–µ –∂–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
      <li><strong>–û–±–º–µ–Ω</strong>: –ø–µ—Ä–µ–¥–∞—á–∞ –º–æ–¥–µ–ª–∏ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏</li>
      <li><strong>A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 2. Pickle (–±–∞–∑–æ–≤—ã–π –º–µ—Ç–æ–¥)</h2>
    <pre><code>import pickle
from sklearn.ensemble import RandomForestClassifier

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
with open('model.pkl', 'wb') as f:
    pickle.dump(model, f)

# –ó–∞–≥—Ä—É–∑–∫–∞
with open('model.pkl', 'rb') as f:
    loaded_model = pickle.load(f)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
predictions = loaded_model.predict(X_test)</code></pre>
    <p><strong>–ü–ª—é—Å—ã:</strong> –ü—Ä–æ—Å—Ç–æ—Ç–∞, —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º–∏ Python –æ–±—ä–µ–∫—Ç–∞–º–∏</p>
    <p><strong>–ú–∏–Ω—É—Å—ã:</strong> –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ (code injection), –Ω–µ –º–µ–∂—è–∑—ã–∫–æ–≤–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</p>
  </div>

  <div class="block">
    <h2>üî∑ 3. Joblib (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è sklearn)</h2>
    <pre><code>import joblib
from sklearn.linear_model import LogisticRegression

# –û–±—É—á–µ–Ω–∏–µ
model = LogisticRegression()
model.fit(X_train, y_train)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö numpy –º–∞—Å—Å–∏–≤–æ–≤)
joblib.dump(model, 'model.joblib')

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∂–∞—Ç–∏–µ
joblib.dump(model, 'model.joblib', compress=3)  # —É—Ä–æ–≤–µ–Ω—å 0-9

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_model = joblib.load('model.joblib')

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏
print(f"Scikit-learn version: {joblib.__version__}")</code></pre>
    <p><strong>–ü–ª—é—Å—ã:</strong> –ë—ã—Å—Ç—Ä–µ–µ pickle –¥–ª—è –±–æ–ª—å—à–∏—Ö –º–∞—Å—Å–∏–≤–æ–≤, —Å–∂–∞—Ç–∏–µ</p>
    <p><strong>–ú–∏–Ω—É—Å—ã:</strong> –¢–æ–ª—å–∫–æ –¥–ª—è sklearn, –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–µ—Ä—Å–∏—è–º–∏</p>
  </div>

  <div class="block">
    <h2>üî∑ 4. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏</h2>
    <pre><code>import joblib
import json
from datetime import datetime

# –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
metadata = {
    'model_type': 'RandomForestClassifier',
    'n_estimators': 100,
    'train_date': datetime.now().isoformat(),
    'sklearn_version': sklearn.__version__,
    'accuracy': 0.95,
    'features': ['age', 'salary', 'city']
}

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
joblib.dump(model, 'model.joblib')
with open('metadata.json', 'w') as f:
    json.dump(metadata, f, indent=2)

# –ó–∞–≥—Ä—É–∑–∫–∞ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π
with open('metadata.json', 'r') as f:
    meta = json.load(f)
    
if meta['sklearn_version'] != sklearn.__version__:
    print("Warning: Version mismatch!")
    
model = joblib.load('model.joblib')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ Pipeline</h2>
    <pre><code>from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.ensemble import RandomForestClassifier

# –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞
pipeline = Pipeline([
    ('scaler', StandardScaler()),
    ('classifier', RandomForestClassifier(n_estimators=100))
])

# –û–±—É—á–µ–Ω–∏–µ –ø–∞–π–ø–ª–∞–π–Ω–∞
pipeline.fit(X_train, y_train)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –í–°–ï–ì–û –ø–∞–π–ø–ª–∞–π–Ω–∞
joblib.dump(pipeline, 'pipeline.joblib')

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_pipeline = joblib.load('pipeline.joblib')

# –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞ —Å—ã—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö
# (preprocessing —É–∂–µ –≤–∫–ª—é—á–µ–Ω)
predictions = loaded_pipeline.predict(X_test_raw)</code></pre>
    <p><strong>–í–∞–∂–Ω–æ:</strong> –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤–µ—Å—å –ø–∞–π–ø–ª–∞–π–Ω, –≤–∫–ª—é—á–∞—è preprocessing!</p>
  </div>

  <div class="block">
    <h2>üî∑ 6. PyTorch –º–æ–¥–µ–ª–∏</h2>
    <pre><code>import torch
import torch.nn as nn

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
class Net(nn.Module):
    def __init__(self):
        super(Net, self).__init__()
        self.fc1 = nn.Linear(10, 50)
        self.fc2 = nn.Linear(50, 2)
    
    def forward(self, x):
        x = torch.relu(self.fc1(x))
        return self.fc2(x)

model = Net()
# ... –æ–±—É—á–µ–Ω–∏–µ ...

# –°–ø–æ—Å–æ–± 1: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–µ—Å–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
torch.save(model.state_dict(), 'model_weights.pth')

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤–µ—Å–æ–≤
model = Net()  # —Å–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É
model.load_state_dict(torch.load('model_weights.pth'))
model.eval()  # —Ä–µ–∂–∏–º evaluation

# –°–ø–æ—Å–æ–± 2: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—é –º–æ–¥–µ–ª—å
torch.save(model, 'model_full.pth')
loaded_model = torch.load('model_full.pth')
loaded_model.eval()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. TensorFlow/Keras –º–æ–¥–µ–ª–∏</h2>
    <pre><code>import tensorflow as tf
from tensorflow import keras

# –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = keras.Sequential([
    keras.layers.Dense(64, activation='relu', input_shape=(10,)),
    keras.layers.Dense(32, activation='relu'),
    keras.layers.Dense(1, activation='sigmoid')
])
model.compile(optimizer='adam', loss='binary_crossentropy')
# ... –æ–±—É—á–µ–Ω–∏–µ ...

# –°–ø–æ—Å–æ–± 1: SavedModel —Ñ–æ—Ä–º–∞—Ç (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
model.save('my_model')  # —Å–æ–∑–¥–∞—Å—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_model = keras.models.load_model('my_model')

# –°–ø–æ—Å–æ–± 2: HDF5 —Ñ–æ—Ä–º–∞—Ç
model.save('model.h5')
loaded_model = keras.models.load_model('model.h5')

# –°–ø–æ—Å–æ–± 3: –¢–æ–ª—å–∫–æ –≤–µ—Å–∞
model.save_weights('weights.h5')
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
new_model = keras.Sequential([...])  # —Ç–∞ –∂–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
new_model.load_weights('weights.h5')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. ONNX (–º–µ–∂–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)</h2>
    <pre><code># –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è sklearn –≤ ONNX
from skl2onnx import convert_sklearn
from skl2onnx.common.data_types import FloatTensorType

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = RandomForestClassifier()
model.fit(X_train, y_train)

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
initial_type = [('float_input', FloatTensorType([None, X_train.shape[1]]))]
onx = convert_sklearn(model, initial_types=initial_type)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
with open("model.onnx", "wb") as f:
    f.write(onx.SerializeToString())

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏ inference —á–µ—Ä–µ–∑ ONNX Runtime
import onnxruntime as rt
sess = rt.InferenceSession("model.onnx")
input_name = sess.get_inputs()[0].name
pred_onx = sess.run(None, {input_name: X_test.astype(np.float32)})</code></pre>
    <p><strong>–ü–ª—é—Å—ã:</strong> –ö—Ä–æ—Å—Å-–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, production-ready</p>
  </div>

  <div class="block">
    <h2>üî∑ 9. XGBoost/LightGBM –º–æ–¥–µ–ª–∏</h2>
    <pre><code># XGBoost
import xgboost as xgb

# –û–±—É—á–µ–Ω–∏–µ
model = xgb.XGBClassifier()
model.fit(X_train, y_train)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (JSON —Ñ–æ—Ä–º–∞—Ç - —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
model.save_model('xgb_model.json')

# –ó–∞–≥—Ä—É–∑–∫–∞
loaded_model = xgb.XGBClassifier()
loaded_model.load_model('xgb_model.json')

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pickle/joblib
joblib.dump(model, 'xgb_model.joblib')

# LightGBM
import lightgbm as lgb

# –û–±—É—á–µ–Ω–∏–µ
model = lgb.LGBMClassifier()
model.fit(X_train, y_train)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ (—Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç)
model.booster_.save_model('lgb_model.txt')

# –ó–∞–≥—Ä—É–∑–∫–∞
bst = lgb.Booster(model_file='lgb_model.txt')
# –∏–ª–∏ —á–µ—Ä–µ–∑ pickle
joblib.dump(model, 'lgb_model.joblib')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</h2>
    <pre><code>from datetime import datetime
import os

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π –¥–ª—è –≤–µ—Ä—Å–∏–π
def save_model_with_version(model, model_name, version=None):
    if version is None:
        version = datetime.now().strftime("%Y%m%d_%H%M%S")
    
    model_dir = f"models/{model_name}/{version}"
    os.makedirs(model_dir, exist_ok=True)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
    model_path = f"{model_dir}/model.joblib"
    joblib.dump(model, model_path)
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    metadata = {
        'version': version,
        'timestamp': datetime.now().isoformat(),
        'model_type': type(model).__name__,
        'accuracy': model.score(X_test, y_test)
    }
    
    with open(f"{model_dir}/metadata.json", 'w') as f:
        json.dump(metadata, f, indent=2)
    
    return model_dir

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
model_dir = save_model_with_version(model, 'my_classifier', 'v1.0')
print(f"Model saved to: {model_dir}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. MLflow –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–¥–µ–ª—è–º–∏</h2>
    <pre><code>import mlflow
import mlflow.sklearn

# –ù–∞—á–∞–ª–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
mlflow.start_run()

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
mlflow.log_param("n_estimators", 100)
mlflow.log_param("max_depth", 10)

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = RandomForestClassifier(n_estimators=100, max_depth=10)
model.fit(X_train, y_train)

# –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
accuracy = model.score(X_test, y_test)
mlflow.log_metric("accuracy", accuracy)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
mlflow.sklearn.log_model(model, "model")

# –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ
mlflow.end_run()

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏–∑ MLflow
model_uri = "runs:/<run_id>/model"
loaded_model = mlflow.sklearn.load_model(model_uri)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –û–±–ª–∞—á–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (AWS S3)</h2>
    <pre><code>import boto3
import joblib
import io

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ S3
s3 = boto3.client('s3')
bucket_name = 'my-ml-models'

# –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ –ø–∞–º—è—Ç—å
buffer = io.BytesIO()
joblib.dump(model, buffer)
buffer.seek(0)

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ S3
s3.upload_fileobj(
    buffer, 
    bucket_name, 
    'models/my_model_v1.joblib'
)

# –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ S3
buffer = io.BytesIO()
s3.download_fileobj(
    bucket_name,
    'models/my_model_v1.joblib',
    buffer
)
buffer.seek(0)
loaded_model = joblib.load(buffer)

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–∞–π–ª –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ—Ç–æ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å
joblib.dump(model, 'model.joblib')
s3.upload_file('model.joblib', bucket_name, 'models/model.joblib')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 13. –ü—Ä–æ–±–ª–µ–º—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏</h2>
    <table>
      <tr><th>–ü—Ä–æ–±–ª–µ–º–∞</th><th>–†–µ—à–µ–Ω–∏–µ</th></tr>
      <tr><td>–†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ sklearn</td><td>–°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ONNX</td></tr>
      <tr><td>–†–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ Python</td><td>Docker, –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è</td></tr>
      <tr><td>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</td><td>–°–æ—Ö—Ä–∞–Ω—è—Ç—å requirements.txt</td></tr>
      <tr><td>–†–∞–∑–Ω—ã–µ –û–°</td><td>ONNX, Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</td></tr>
    </table>
    <pre><code># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
# requirements.txt
scikit-learn==1.3.0
numpy==1.24.0
pandas==2.0.0

# –ò–ª–∏ —á–µ—Ä–µ–∑ pip freeze
pip freeze > requirements.txt

# Dockerfile –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
FROM python:3.9
COPY requirements.txt .
RUN pip install -r requirements.txt
COPY model.joblib .
COPY app.py .
CMD ["python", "app.py"]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 14. Best Practices</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –î–µ–ª–∞—Ç—å</h3>
        <ul>
          <li>–°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–µ—Å—å pipeline (preprocessing + –º–æ–¥–µ–ª—å)</li>
          <li>–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏</li>
          <li>–°–æ—Ö—Ä–∞–Ω—è—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–≤–µ—Ä—Å–∏—è, –¥–∞—Ç–∞, –º–µ—Ç—Ä–∏–∫–∏)</li>
          <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å joblib –¥–ª—è sklearn</li>
          <li>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å</li>
          <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ONNX –¥–ª—è production</li>
          <li>–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –ù–µ –¥–µ–ª–∞—Ç—å</h3>
        <ul>
          <li>–°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –º–æ–¥–µ–ª—å –±–µ–∑ preprocessing</li>
          <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å pickle –¥–ª—è production</li>
          <li>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
          <li>–ü–µ—Ä–µ–æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª—å –∫–∞–∂–¥—ã–π —Ä–∞–∑</li>
          <li>–ù–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 15. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏</h2>
    <pre><code>import numpy as np

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
X_test_sample = X_test[:5].copy()
y_test_sample = y_test[:5].copy()

np.save('test_X.npy', X_test_sample)
np.save('test_y.npy', y_test_sample)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
original_predictions = model.predict(X_test_sample)
np.save('test_predictions.npy', original_predictions)

# –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏ - –ø—Ä–æ–≤–µ—Ä–∫–∞
loaded_model = joblib.load('model.joblib')
X_test_sample = np.load('test_X.npy')
expected_predictions = np.load('test_predictions.npy')

loaded_predictions = loaded_model.predict(X_test_sample)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç–∏
assert np.allclose(loaded_predictions, expected_predictions), \
    "Predictions don't match!"
print("‚úÖ Model loaded successfully and predictions match!")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 16. –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è production</h2>
    <ul>
      <li>[ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω –ø–æ–ª–Ω—ã–π pipeline (preprocessing + –º–æ–¥–µ–ª—å)</li>
      <li>[ ] –î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–≤–µ—Ä—Å–∏—è, –¥–∞—Ç–∞, –º–µ—Ç—Ä–∏–∫–∏)</li>
      <li>[ ] –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (requirements.txt)</li>
      <li>[ ] –í–µ—Ä—Å–∏—è –º–æ–¥–µ–ª–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞</li>
      <li>[ ] –ó–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≤–µ—Ä—Å–∏–π</li>
      <li>[ ] –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –≤ –æ–±–ª–∞–∫–æ –∏–ª–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</li>
      <li>[ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</li>
      <li>[ ] –ï—Å—Ç—å fallback —Å—Ç—Ä–∞—Ç–µ–≥–∏—è</li>
      <li>[ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ –≤–∏–¥–µ–æ–∏–≥—Ä–µ. –ú—ã –æ–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å –æ–¥–∏–Ω —Ä–∞–∑ (—ç—Ç–æ –¥–æ–ª–≥–æ), —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ—ë, –∏ –ø–æ—Ç–æ–º –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∞—è –∑–∞–Ω–æ–≤–æ¬ª.
    </blockquote>
  </div>

</div>

</body>
</html>
