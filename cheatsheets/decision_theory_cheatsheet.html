<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–¢–µ–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

    .container {
      column-count: 3;
      column-gap: 20px;
      max-width: 100%;
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üé≤ –¢–µ–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å</h2>
    <ul>
      <li><strong>Decision Theory</strong>: –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—Å–Ω–æ–≤–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</li>
      <li><strong>–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å</strong>: –≤—ã–±–æ—Ä –ø—Ä–∏ –Ω–µ–ø–æ–ª–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</li>
      <li><strong>–§—É–Ω–∫—Ü–∏—è –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏</strong>: –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π</li>
      <li><strong>–†–∏—Å–∫</strong>: –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤</li>
      <li><strong>ML –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: –≤—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π, –ø–æ—Ä–æ–≥–æ–≤, –¥–µ–π—Å—Ç–≤–∏–π</li>
    </ul>

  <div class="block">
    <h2>üî∑ 2. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h2>
    <p><strong>–≠–ª–µ–º–µ–Ω—Ç—ã –∑–∞–¥–∞—á–∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π:</strong></p>
    <ul>
      <li><strong>A</strong>: –º–Ω–æ–∂–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π (alternatives)</li>
      <li><strong>Œò</strong>: –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø—Ä–∏—Ä–æ–¥—ã (states)</li>
      <li><strong>L(Œ∏, a)</strong>: —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (loss function)</li>
      <li><strong>P(Œ∏)</strong>: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π —Å–æ—Å—Ç–æ—è–Ω–∏–π</li>
      <li><strong>R(a)</strong>: —Ä–∏—Å–∫ –¥–µ–π—Å—Ç–≤–∏—è a</li>
    </ul>

    <p><strong>–û–±—â–∞—è —Ñ–æ—Ä–º—É–ª–∞ —Ä–∏—Å–∫–∞:</strong></p>
    <pre><code>R(a) = E[L(Œ∏, a)] = ‚àë P(Œ∏) L(Œ∏, a)
                         Œ∏

–¶–µ–ª—å: min R(a)
       a‚ààA</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. –¢–∏–ø—ã –∑–∞–¥–∞—á –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π</h2>
    <table>
      <tr><th>–¢–∏–ø</th><th>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</th><th>–ö—Ä–∏—Ç–µ—Ä–∏–π</th></tr>
      <tr><td><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å</strong></td><td>–ü–æ–ª–Ω–∞—è</td><td>–ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è –≤—ã–≥–æ–¥—ã</td></tr>
      <tr><td><strong>–†–∏—Å–∫</strong></td><td>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã</td><td>–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –ø–æ—Ç–µ—Ä—å</td></tr>
      <tr><td><strong>–ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç—å</strong></td><td>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã</td><td>–†–∞–∑–ª–∏—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏</td></tr>
      <tr><td><strong>–ö–æ–Ω—Ñ–ª–∏–∫—Ç</strong></td><td>–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</td><td>–¢–µ–æ—Ä–∏—è –∏–≥—Ä</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 4. –§—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å –≤ ML</h2>
    <pre><code># –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
def zero_one_loss(y_true, y_pred):
    """0-1 loss: 0 –µ—Å–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, 1 –µ—Å–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ"""
    return (y_true != y_pred).astype(int)

def hinge_loss(y_true, y_score):
    """Hinge loss –¥–ª—è SVM"""
    return np.maximum(0, 1 - y_true * y_score)

def log_loss(y_true, y_prob):
    """–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å"""
    return -np.mean(y_true * np.log(y_prob) + 
                    (1 - y_true) * np.log(1 - y_prob))

# –†–µ–≥—Ä–µ—Å—Å–∏—è
def squared_loss(y_true, y_pred):
    """L2 loss"""
    return (y_true - y_pred) ** 2

def absolute_loss(y_true, y_pred):
    """L1 loss"""
    return np.abs(y_true - y_pred)

def huber_loss(y_true, y_pred, delta=1.0):
    """Huber loss: –∫–æ–º–±–∏–Ω–∞—Ü–∏—è L1 –∏ L2"""
    error = y_true - y_pred
    is_small = np.abs(error) <= delta
    squared_loss = 0.5 * error ** 2
    linear_loss = delta * (np.abs(error) - 0.5 * delta)
    return np.where(is_small, squared_loss, linear_loss)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. Bayesian Decision Theory</h2>
    <pre><code>import numpy as np

# –ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
def bayesian_classifier(X, priors, likelihoods, classes):
    """
    –í—ã–±–∏—Ä–∞–µ—Ç –∫–ª–∞—Å—Å —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –±–∞–π–µ—Å–æ–≤—Å–∫–∏–º —Ä–∏—Å–∫–æ–º
    
    priors: P(C_i) - –∞–ø—Ä–∏–æ—Ä–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∫–ª–∞—Å—Å–æ–≤
    likelihoods: P(X|C_i) - –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è
    """
    posteriors = []
    for i, c in enumerate(classes):
        # –ê–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: P(C_i|X) ‚àù P(X|C_i) * P(C_i)
        posterior = likelihoods[i](X) * priors[i]
        posteriors.append(posterior)
    
    # –í—ã–±–æ—Ä –∫–ª–∞—Å—Å–∞ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∞–ø–æ—Å—Ç–µ—Ä–∏–æ—Ä–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é
    return classes[np.argmax(posteriors)]

# –ü—Ä–∏–º–µ—Ä —Å Gaussian –∫–ª–∞—Å—Å–∞–º–∏
from scipy.stats import norm

# –ö–ª–∞—Å—Å 0: N(0, 1), –∫–ª–∞—Å—Å 1: N(2, 1)
priors = [0.6, 0.4]  # P(C_0), P(C_1)
likelihoods = [
    lambda x: norm.pdf(x, 0, 1),  # P(X|C_0)
    lambda x: norm.pdf(x, 2, 1)   # P(X|C_1)
]

x_test = 1.0
predicted_class = bayesian_classifier(x_test, priors, likelihoods, [0, 1])
print(f"Predicted class for x={x_test}: {predicted_class}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. –ú–∏–Ω–∏–º–∞–∫—Å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π</h2>
    <pre><code># –†–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–ª–Ω–æ–π –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ—Å—Ç–∏
def minimax_criterion(loss_matrix):
    """
    –ú–∏–Ω–∏–º–∞–∫—Å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
    
    loss_matrix[i, j]: –ø–æ—Ç–µ—Ä–∏ –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è i –ø—Ä–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ j
    """
    # –î–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞—Ö–æ–¥–∏–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
    max_losses = np.max(loss_matrix, axis=1)
    
    # –í—ã–±–∏—Ä–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
    optimal_action = np.argmin(max_losses)
    
    return optimal_action, max_losses[optimal_action]

# –ü—Ä–∏–º–µ—Ä: –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ—Ç–µ—Ä—å (3 –¥–µ–π—Å—Ç–≤–∏—è √ó 4 —Å–æ—Å—Ç–æ—è–Ω–∏—è)
loss_matrix = np.array([
    [10, 20, 15, 25],  # –¥–µ–π—Å—Ç–≤–∏–µ 0
    [8,  18, 22, 12],  # –¥–µ–π—Å—Ç–≤–∏–µ 1
    [15, 10, 18, 20]   # –¥–µ–π—Å—Ç–≤–∏–µ 2
])

action, min_max_loss = minimax_criterion(loss_matrix)
print(f"Optimal action: {action}, worst-case loss: {min_max_loss}")

# –ú–∏–Ω–∏–º–∞–∫—Å–Ω—ã–π –∫—Ä–∏—Ç–µ—Ä–∏–π —Å–æ–∂–∞–ª–µ–Ω–∏–π
def minimax_regret(loss_matrix):
    """–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Å–æ–∂–∞–ª–µ–Ω–∏—è"""
    # –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞—Ö–æ–¥–∏–º –ª—É—á—à–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ
    min_losses = np.min(loss_matrix, axis=0)
    
    # –°–æ–∂–∞–ª–µ–Ω–∏–µ = –ø–æ—Ç–µ—Ä–∏ - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
    regret_matrix = loss_matrix - min_losses
    
    # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–∂–∞–ª–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
    max_regrets = np.max(regret_matrix, axis=1)
    
    # –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å–æ–∂–∞–ª–µ–Ω–∏–µ
    return np.argmin(max_regrets), max_regrets</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. –ö—Ä–∏—Ç–µ—Ä–∏–π –õ–∞–ø–ª–∞—Å–∞</h2>
    <pre><code># –ü—Ä–∏–Ω—Ü–∏–ø –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –æ—Å–Ω–æ–≤–∞–Ω–∏—è
def laplace_criterion(loss_matrix):
    """
    –ö—Ä–∏—Ç–µ—Ä–∏–π –õ–∞–ø–ª–∞—Å–∞: –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞–≤–Ω–æ–≤–µ—Ä–æ—è—Ç–Ω—ã
    –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ—Ç–µ—Ä—å
    """
    # –†–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º
    n_states = loss_matrix.shape[1]
    uniform_probs = np.ones(n_states) / n_states
    
    # –°—Ä–µ–¥–Ω–∏–µ –ø–æ—Ç–µ—Ä–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è
    expected_losses = loss_matrix @ uniform_probs
    
    optimal_action = np.argmin(expected_losses)
    return optimal_action, expected_losses[optimal_action]

# –ö—Ä–∏—Ç–µ—Ä–∏–π –ë–∞–π–µ—Å–∞ (–æ–±–æ–±—â–µ–Ω–∏–µ —Å –∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏)
def bayes_criterion(loss_matrix, probabilities):
    """
    –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –ø–æ—Ç–µ—Ä—å –ø—Ä–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è—Ö
    """
    expected_losses = loss_matrix @ probabilities
    optimal_action = np.argmin(expected_losses)
    return optimal_action, expected_losses[optimal_action]

# –ü—Ä–∏–º–µ—Ä
probabilities = np.array([0.3, 0.4, 0.2, 0.1])
action, exp_loss = bayes_criterion(loss_matrix, probabilities)
print(f"Bayes optimal action: {action}, expected loss: {exp_loss:.2f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</h2>
    <pre><code>from sklearn.metrics import confusion_matrix

def find_optimal_threshold(y_true, y_prob, cost_matrix):
    """
    –ù–∞—Ö–æ–¥–∏—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    
    cost_matrix: [[C(0,0), C(0,1)],  # —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫
                  [C(1,0), C(1,1)]]
    C(i,j) = —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è j –ø—Ä–∏ –∏—Å—Ç–∏–Ω–Ω–æ–º –∫–ª–∞—Å—Å–µ i
    """
    thresholds = np.linspace(0, 1, 100)
    costs = []
    
    for threshold in thresholds:
        y_pred = (y_prob >= threshold).astype(int)
        tn, fp, fn, tp = confusion_matrix(y_true, y_pred).ravel()
        
        # –û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å
        cost = (tn * cost_matrix[0][0] + 
                fp * cost_matrix[0][1] +
                fn * cost_matrix[1][0] +
                tp * cost_matrix[1][1])
        costs.append(cost)
    
    optimal_idx = np.argmin(costs)
    optimal_threshold = thresholds[optimal_idx]
    
    return optimal_threshold, costs[optimal_idx]

# –ü—Ä–∏–º–µ—Ä: –¥–µ—Ç–µ–∫—Ü–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞
# –°—Ç–æ–∏–º–æ—Å—Ç–∏: [TN=0, FP=10, FN=1000, TP=0]
cost_matrix = [[0, 10], [1000, 0]]

optimal_threshold, min_cost = find_optimal_threshold(
    y_true, y_prob, cost_matrix
)
print(f"Optimal threshold: {optimal_threshold:.3f}, min cost: {min_cost}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Sequential Decision Making</h2>
    <pre><code># –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π
class SequentialDecisionMaker:
    def __init__(self, n_stages):
        self.n_stages = n_stages
        self.decisions = []
        self.outcomes = []
    
    def dynamic_programming(self, states, actions, rewards, transitions):
        """
        –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏
        
        V[s] = max_{a} (R(s, a) + Œ≥ * ‚àë P(s'|s,a) * V[s'])
        """
        n_states = len(states)
        V = np.zeros(n_states)  # value function
        policy = np.zeros(n_states, dtype=int)
        
        # Backward induction
        for stage in range(self.n_stages - 1, -1, -1):
            V_new = np.zeros(n_states)
            
            for s in range(n_states):
                best_value = -np.inf
                best_action = 0
                
                for a in range(len(actions)):
                    # Expected value
                    value = rewards[s, a]
                    for s_next in range(n_states):
                        value += transitions[s, a, s_next] * V[s_next]
                    
                    if value > best_value:
                        best_value = value
                        best_action = a
                
                V_new[s] = best_value
                policy[s] = best_action
            
            V = V_new
        
        return policy, V

# –ü—Ä–∏–º–µ—Ä: –∑–∞–¥–∞—á–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
def optimal_stopping(values, costs):
    """
    –û–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞: –∫–æ–≥–¥–∞ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å –ø–æ–∏—Å–∫
    """
    n = len(values)
    V = np.zeros(n + 1)
    
    # Backward induction
    for i in range(n - 1, -1, -1):
        # –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏–ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        stop_value = values[i]
        continue_value = V[i + 1] - costs[i]
        V[i] = max(stop_value, continue_value)
    
    return V[0]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Multi-armed Bandit (–∫—Ä–∞—Ç–∫–æ–µ)</h2>
    <pre><code># Exploration vs Exploitation
class EpsilonGreedy:
    def __init__(self, n_arms, epsilon=0.1):
        self.n_arms = n_arms
        self.epsilon = epsilon
        self.counts = np.zeros(n_arms)
        self.values = np.zeros(n_arms)
    
    def select_arm(self):
        if np.random.random() < self.epsilon:
            # Explore: —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä
            return np.random.randint(self.n_arms)
        else:
            # Exploit: –ª—É—á—à–∞—è —Ç–µ–∫—É—â–∞—è –æ—Ü–µ–Ω–∫–∞
            return np.argmax(self.values)
    
    def update(self, arm, reward):
        self.counts[arm] += 1
        n = self.counts[arm]
        # –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ
        self.values[arm] += (reward - self.values[arm]) / n

# UCB (Upper Confidence Bound)
class UCB:
    def __init__(self, n_arms, c=2):
        self.n_arms = n_arms
        self.c = c
        self.counts = np.zeros(n_arms)
        self.values = np.zeros(n_arms)
        self.t = 0
    
    def select_arm(self):
        self.t += 1
        # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º –≤—Å–µ —Ä—É–∫–∏
        if self.t <= self.n_arms:
            return self.t - 1
        
        # UCB formula
        ucb_values = self.values + self.c * np.sqrt(
            np.log(self.t) / (self.counts + 1e-5)
        )
        return np.argmax(ucb_values)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. –§—É–Ω–∫—Ü–∏—è –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏</h2>
    <pre><code># –¢–µ–æ—Ä–∏—è –æ–∂–∏–¥–∞–µ–º–æ–π –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ (Expected Utility Theory)
def expected_utility(outcomes, probabilities, utility_function):
    """
    EU = ‚àë P(outcome) * U(outcome)
    """
    return sum(p * utility_function(o) 
               for o, p in zip(outcomes, probabilities))

# –ü—Ä–∏–º–µ—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏
def risk_averse_utility(x, gamma=0.5):
    """–ù–µ–ø—Ä–∏—è—Ç–∏–µ —Ä–∏—Å–∫–∞ (concave)"""
    return x ** gamma

def risk_seeking_utility(x, gamma=2):
    """–°–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ —Ä–∏—Å–∫—É (convex)"""
    return x ** gamma

def risk_neutral_utility(x):
    """–ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ—Å—Ç—å –∫ —Ä–∏—Å–∫—É (linear)"""
    return x

# –ü—Ä–∏–º–µ—Ä: –≤—ã–±–æ—Ä –º–µ–∂–¥—É –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—É–º–º–æ–π –∏ –ª–æ—Ç–µ—Ä–µ–µ–π
guaranteed = 50
lottery_outcomes = [0, 100]
lottery_probs = [0.5, 0.5]

# –î–ª—è –∏–∑–±–µ–≥–∞—é—â–µ–≥–æ —Ä–∏—Å–∫
utility_guaranteed = risk_averse_utility(guaranteed)
utility_lottery = expected_utility(
    lottery_outcomes, lottery_probs, risk_averse_utility
)

if utility_guaranteed > utility_lottery:
    print("Risk-averse: Choose guaranteed option")
else:
    print("Risk-averse: Choose lottery")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ ML</h2>
    <ul>
      <li><strong>–í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏</strong>: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –æ–∂–∏–¥–∞–µ–º—ã—Ö –ø–æ—Ç–µ—Ä—å</li>
      <li><strong>–ü–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</strong>: —É—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫</li>
      <li><strong>Active Learning</strong>: –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å–∏—Ç—å</li>
      <li><strong>Bandits</strong>: A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</li>
      <li><strong>RL</strong>: –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π</li>
      <li><strong>Feature selection</strong>: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 13. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –•–æ—Ä–æ—à–æ</h3>
        <ul>
          <li>–ù–µ—Ä–∞–≤–Ω—ã–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—à–∏–±–æ–∫</li>
          <li>–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã</li>
          <li>–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ—à–µ–Ω–∏—è (–º–µ–¥–∏—Ü–∏–Ω–∞, —Ñ–∏–Ω–∞–Ω—Å—ã)</li>
          <li>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫</li>
          <li>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –ü–ª–æ—Ö–æ</h3>
        <ul>
          <li>–†–∞–≤–Ω—ã–µ —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫</li>
          <li>–¢–æ—á–Ω–æ—Å—Ç—å - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞</li>
          <li>–ù–µ—Ç –±–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞</li>
          <li>–ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 14. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</li>
      <li>[ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è</li>
      <li>[ ] –ó–∞–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å/–ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏</li>
      <li>[ ] –û—Ü–µ–Ω–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã)</li>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å –∫—Ä–∏—Ç–µ—Ä–∏–π —Ä–µ—à–µ–Ω–∏—è</li>
      <li>[ ] –£—á–µ—Å—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—à–∏–±–æ–∫ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤</li>
      <li>[ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ—à–µ–Ω–∏–π</li>
      <li>[ ] –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´–¢–µ–æ—Ä–∏—è —Ä–µ—à–µ–Ω–∏–π ‚Äî —ç—Ç–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞. –í–º–µ—Å—Ç–æ —Ç–æ–≥–æ —á—Ç–æ–±—ã –ø—Ä–æ—Å—Ç–æ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏, –º—ã —É—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è: –Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é (–ø–æ—Ç–µ—Ä—è $1000) —Ö—É–∂–µ, —á–µ–º –ª–æ–∂–Ω–∞—è —Ç—Ä–µ–≤–æ–≥–∞ (–ø–æ—Ç–µ—Ä—è $10). –¢–µ–æ—Ä–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–π—Ç–∏ –±–∞–ª–∞–Ω—Å¬ª.
    </blockquote>
  </div>

</div>

</div>
</body>
</html>
