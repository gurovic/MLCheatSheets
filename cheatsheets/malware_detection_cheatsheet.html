<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Malware Detection Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      
        min-width: 900px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88em;
      margin: 6px 0;
    }

    th, td {
      padding: 6px 8px;
      text-align: left;
      border: 1px solid #e0e7ff;
    }

    th {
      background-color: #1a5fb4;
      color: white;
      font-weight: 700;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üìö Malware Detection</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å malware detection</h2>
    <p><strong>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—è–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</strong></p>
    <ul>
            <li><strong>–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ</strong>:  –≤—ã—è–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è</li>
      <li><strong>–¢–∏–ø—ã malware</strong>:  –≤–∏—Ä—É—Å—ã, —á–µ—Ä–≤–∏, —Ç—Ä–æ—è–Ω—ã, ransomware, spyware</li>
      <li><strong>ML —Ä–æ–ª—å</strong>:  –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö malware –±–µ–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä</li>
      <li><strong>–í–∞–∂–Ω–æ—Å—Ç—å</strong>:  –∑–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ—Ç–µ—Ä—å, –∫—Ä–∞–∂–∏ –¥–∞–Ω–Ω—ã—Ö</li>
      <li><strong>–í—ã–∑–æ–≤</strong>:  malware –±—ã—Å—Ç—Ä–æ —ç–≤–æ–ª—é—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç –∏ –æ–±—Ñ—É—Å—Ü–∏—Ä—É–µ—Ç—Å—è</li>
      <li><strong>Automation</strong>:  ML –ø–æ–∑–≤–æ–ª—è–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∞–ª–∏–∑</li>

    </ul>
    <blockquote>
      üí° ML –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è zero-day –∏ polymorphic malware
    </blockquote>

    </div>
<div class="block">
    <h2>üî∑ 2. –¢–∏–ø—ã malware</h2>
    <p><strong>Viruses, Worms, Trojans, Ransomware, Spyware, Adware</strong></p>
    <ul>
            <li><strong>Virus</strong>:  —Å–∞–º–æ—Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—é—â–∏–π—Å—è –∫–æ–¥, –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã</li>
      <li><strong>Worm</strong>:  –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ —Å–µ—Ç–∏</li>
      <li><strong>Trojan</strong>:  –º–∞—Å–∫–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –ª–µ–≥–∏—Ç–∏–º–Ω–æ–µ –ü–û</li>
      <li><strong>Ransomware</strong>:  —à–∏—Ñ—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ, —Ç—Ä–µ–±—É–µ—Ç –≤—ã–∫—É–ø</li>
      <li><strong>Spyware</strong>:  —Å–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –±–µ–∑ –≤–µ–¥–æ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</li>
      <li><strong>Rootkit</strong>:  —Å–∫—Ä—ã—Ç—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–∏—Å—Ç–µ–º–µ</li>

    </ul>
    <blockquote>
      üí° Ransomware ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ —Ä–∞–∑—Ä—É—à–∏—Ç–µ–ª—å–Ω—ã–π —Ç–∏–ø malware —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è —É—â–µ—Ä–±–∞
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 3. –ü–æ–¥—Ö–æ–¥—ã</h2>
    <p><strong>Signature-based, Heuristic-based, Behavior-based, ML-based</strong></p>
    <ul>
            <li><strong>Signature-based</strong>:  –ø–æ–∏—Å–∫ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö —Å–∏–≥–Ω–∞—Ç—É—Ä (antivirus)</li>
      <li><strong>Heuristic</strong>:  –ø—Ä–∞–≤–∏–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è</li>
      <li><strong>Behavioral</strong>:  –∞–Ω–∞–ª–∏–∑ –¥–µ–π—Å—Ç–≤–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã</li>
      <li><strong>ML-based</strong>:  –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
      <li><strong>Sandboxing</strong>:  –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞</li>
      <li><strong>Hybrid</strong>:  –∫–æ–º–±–∏–Ω–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤</li>

    </ul>
    <blockquote>
      üí° Signature-based –±—ã—Å—Ç—Ä, –Ω–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω –ø—Ä–æ—Ç–∏–≤ –Ω–æ–≤—ã—Ö malware
    </blockquote>
    <pre><code>import pefile
import numpy as np
from sklearn.ensemble import RandomForestClassifier

# Static analysis features from PE file
def extract_pe_features(pe_path):
    pe = pefile.PE(pe_path)
    features = {
        'size': len(open(pe_path, 'rb').read()),
        'n_sections': len(pe.sections),
        'n_imports': len(pe.DIRECTORY_ENTRY_IMPORT),
        'has_debug': hasattr(pe, 'DIRECTORY_ENTRY_DEBUG'),
        'has_resources': hasattr(pe, 'DIRECTORY_ENTRY_RESOURCE'),
        'entropy': pe.sections[0].get_entropy()
    }
    return list(features.values())

# Extract features from dataset
X_train = np.array([extract_pe_features(f) for f in train_files])
y_train = train_labels  # 0=benign, 1=malware

# Train classifier
rf = RandomForestClassifier(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)

# Predict
new_sample_features = extract_pe_features('suspicious.exe')
prediction = rf.predict([new_sample_features])[0]
proba = rf.predict_proba([new_sample_features])[0]
print(f"Malware probability: {proba[1]:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h2>
    <p><strong>PE headers, opcodes, strings, API calls, control flow</strong></p>
    <ul>
            <li><strong>–ë–µ–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è</strong>:  –∞–Ω–∞–ª–∏–∑ —Ñ–∞–π–ª–∞ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞</li>
      <li><strong>PE headers</strong>:  –∞–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–≥–æ —Ñ–∞–π–ª–∞</li>
      <li><strong>String extraction</strong>:  –ø–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Å—Ç—Ä–æ–∫, URLs</li>
      <li><strong>Opcodes</strong>:  –∞–Ω–∞–ª–∏–∑ –º–∞—à–∏–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</li>
      <li><strong>Control Flow Graph</strong>:  –≥—Ä–∞—Ñ –ø–æ—Ç–æ–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</li>
      <li><strong>N-grams</strong>:  –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–∞–π—Ç–æ–≤/opcodes</li>

    </ul>
    <blockquote>
      üí° –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –±–µ–∑–æ–ø–∞—Å–µ–Ω, –Ω–æ obfuscation –º–æ–∂–µ—Ç –µ–≥–æ –æ–±–æ–π—Ç–∏
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 5. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑</h2>
    <p><strong>Runtime behavior, system calls, network traffic</strong></p>
    <ul>
            <li><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤ sandbox</strong>:  –∑–∞–ø—É—Å–∫ –≤ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ä–µ–¥–µ</li>
      <li><strong>API calls</strong>:  –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–∑–æ–≤–æ–≤ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π</li>
      <li><strong>File operations</strong>:  —Å–æ–∑–¥–∞–Ω–∏–µ/–º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è/—É–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤</li>
      <li><strong>Network activity</strong>:  connections, DNS queries</li>
      <li><strong>Registry changes</strong>:  –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–µ—Å—Ç—Ä–∞ Windows</li>
      <li><strong>Process behavior</strong>:  —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, injection</li>

    </ul>
    <blockquote>
      üí° –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤—ã—è–≤–ª—è–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 6. –ü—Ä–∏–∑–Ω–∞–∫–∏ (features)</h2>
    <p><strong>N-grams, API sequences, opcode frequency, entropy</strong></p>
    <ul>
            <li><strong>Static</strong>:  —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞, entropy, PE features, strings</li>
      <li><strong>Opcode sequences</strong>:  n-grams –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π</li>
      <li><strong>API calls</strong>:  —á–∞—Å—Ç–æ—Ç–∞ –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–∑–æ–≤–æ–≤</li>
      <li><strong>System calls</strong>:  –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –û–°</li>
      <li><strong>Network features</strong>:  IP, ports, protocols</li>
      <li><strong>Behavioral</strong>:  file/registry operations</li>

    </ul>
    <blockquote>
      üí° Entropy —Ñ–∞–π–ª–∞ ‚Äî –ø—Ä–æ—Å—Ç–æ–π, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏–∑–Ω–∞–∫ —É–ø–∞–∫–æ–≤—â–∏–∫–æ–≤
    </blockquote>
    <pre><code>from sklearn.feature_extraction.text import CountVectorizer
from sklearn.ensemble import GradientBoostingClassifier

# Opcode n-grams for malware detection
def extract_opcodes(asm_file):
    # Parse disassembled file
    with open(asm_file, 'r') as f:
        opcodes = []
        for line in f:
            parts = line.strip().split()
            if len(parts) > 0:
                opcodes.append(parts[0])  # first token is opcode
    return ' '.join(opcodes)

# Extract opcode sequences
opcode_sequences = [extract_opcodes(f) for f in asm_files]

# N-gram features
vectorizer = CountVectorizer(ngram_range=(2, 3), max_features=5000)
X_opcodes = vectorizer.fit_transform(opcode_sequences)

# Train
model = GradientBoostingClassifier(n_estimators=100)
model.fit(X_opcodes, y)

# Predict
new_opcodes = extract_opcodes('new_sample.asm')
X_new = vectorizer.transform([new_opcodes])
is_malware = model.predict(X_new)[0]
print(f"Malware: {is_malware}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. ML –∞–ª–≥–æ—Ä–∏—Ç–º—ã</h2>
    <p><strong>Random Forest, SVM, Neural Networks, Gradient Boosting</strong></p>
    <ul>
            <li><strong>Random Forest</strong>:  –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å, —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</li>
      <li><strong>SVM</strong>:  —Ö–æ—Ä–æ—à –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
      <li><strong>Decision Trees</strong>:  –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</li>
      <li><strong>Gradient Boosting</strong>:  XGBoost, LightGBM –¥–ª—è —Ç–∞–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
      <li><strong>k-NN</strong>:  –ø—Ä–æ—Å—Ç–æ–π baseline</li>
      <li><strong>Naive Bayes</strong>:  –±—ã—Å—Ç—Ä—ã–π, –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>

    </ul>
    <blockquote>
      üí° Random Forest –∏ XGBoost ‚Äî –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–ª—è malware detection
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 8. Deep Learning</h2>
    <p><strong>CNN –Ω–∞ –±–∏–Ω–∞—Ä–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö, RNN –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è—Ö API</strong></p>
    <ul>
            <li><strong>CNN</strong>:  –∞–Ω–∞–ª–∏–∑ opcodes –∫–∞–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li>
      <li><strong>RNN/LSTM</strong>:  –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API calls</li>
      <li><strong>Autoencoder</strong>:  anomaly detection</li>
      <li><strong>MalConv</strong>:  1D CNN –Ω–∞ raw bytes</li>
      <li><strong>Graph Neural Networks</strong>:  –∞–Ω–∞–ª–∏–∑ call graphs</li>
      <li><strong>Transfer learning</strong>:  –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏</li>

    </ul>
    <blockquote>
      üí° Deep Learning –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å raw bytes –±–µ–∑ feature engineering
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 9. –î–∞—Ç–∞—Å–µ—Ç—ã</h2>
    <p><strong>VirusShare, EMBER, Malicia, Android malware datasets</strong></p>
    <ul>
            <li><strong>VirusShare</strong>:  –º–∏–ª–ª–∏–æ–Ω—ã malware samples</li>
      <li><strong>Malware Bazaar</strong>:  —Å–≤–µ–∂–∏–µ samples</li>
      <li><strong>EMBER</strong>:  1M PE files —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏</li>
      <li><strong>SOREL-20M</strong>:  20M samples –æ—Ç Sophos</li>
      <li><strong>Microsoft Malware Classification</strong>:  Kaggle competition</li>
      <li><strong>–ü—Ä–æ–±–ª–µ–º–∞</strong>:  –∑–∞–∫—Ä—ã—Ç–æ—Å—Ç—å –∏–∑-–∑–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</li>

    </ul>
    <blockquote>
      üí° EMBER –∏ SOREL-20M ‚Äî –ª—É—á—à–∏–µ –ø—É–±–ª–∏—á–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
    </blockquote>
    <pre><code>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv1D, MaxPooling1D, Flatten, Dense

# MalConv-style 1D CNN on raw bytes
# X_train shape: (samples, max_len) - raw bytes

max_len = 2**20  # 1MB
vocab_size = 256  # byte values

model = Sequential([
    # Embedding layer for bytes
    tf.keras.layers.Embedding(vocab_size, 8, input_length=max_len),
    
    # 1D convolutions
    Conv1D(128, kernel_size=500, strides=500, activation='relu'),
    Conv1D(128, kernel_size=500, strides=500, activation='relu'),
    
    # Global max pooling
    tf.keras.layers.GlobalMaxPooling1D(),
    
    # FC layers
    Dense(128, activation='relu'),
    Dense(1, activation='sigmoid')  # binary classification
])

model.compile(
    optimizer='adam',
    loss='binary_crossentropy',
    metrics=['accuracy', 'AUC']
)

# Training
history = model.fit(
    X_train_bytes, y_train,
    epochs=10,
    batch_size=32,
    validation_split=0.2
)

# Prediction
malware_prob = model.predict(X_test_bytes)
print(f"Detection rate: {(malware_prob > 0.5).sum() / len(malware_prob):.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Adversarial ML</h2>
    <p><strong>Evasion attacks, robustness</strong></p>
    <ul>
            <li><strong>Evasion attacks</strong>:  –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ –¥–µ—Ç–µ–∫—Ç–æ—Ä–∞</li>
      <li><strong>Adversarial examples</strong>:  –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –¥–ª—è misclassification</li>
      <li><strong>Mimicry attacks</strong>:  –º–∞—Å–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥ benign</li>
      <li><strong>Robustness</strong>:  —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</li>
      <li><strong>Adversarial training</strong>:  –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ adversarial examples</li>
      <li><strong>Defensive distillation</strong>:  –∑–∞—â–∏—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º</li>

    </ul>
    <blockquote>
      üí° Adversarial ML ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –¥–ª—è production malware detectors
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 11. Android malware</h2>
    <p><strong>Permissions, intents, API calls, static vs dynamic</strong></p>
    <ul>
            <li><strong>APK analysis</strong>:  –∞–Ω–∞–ª–∏–∑ Android Package</li>
      <li><strong>Permissions</strong>:  —Ç—Ä–µ–±—É–µ–º—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</li>
      <li><strong>API calls</strong>:  –≤—ã–∑–æ–≤—ã Android API</li>
      <li><strong>Network behavior</strong>:  —Å–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</li>
      <li><strong>Drebin</strong>:  –ø–æ–ø—É–ª—è—Ä–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç Android malware</li>
      <li><strong>Static + Dynamic</strong>:  –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑</li>

    </ul>
    <blockquote>
      üí° Android malware —Ä–∞—Å—Ç–µ—Ç –±—ã—Å—Ç—Ä–µ–µ, —á–µ–º –¥–ª—è –¥—Ä—É–≥–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</h2>
    <p><strong>Feature extraction –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</strong></p>
    <ul>
            <li><strong>–°–±–æ—Ä samples</strong>:  VirusTotal API, Malware Bazaar</li>
      <li><strong>Feature extraction</strong>:  pefile –¥–ª—è PE, androguard –¥–ª—è APK</li>
      <li><strong>Preprocessing</strong>:  encoding, normalization</li>
      <li><strong>Training</strong>:  ensemble models –¥–ª—è –ª—É—á—à–µ–π —Ç–æ—á–Ω–æ—Å—Ç–∏</li>
      <li><strong>Validation</strong>:  cross-validation, holdout set</li>
      <li><strong>Deployment</strong>:  –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å antivirus/EDR</li>

    </ul>
    <blockquote>
      üí° Production malware detector —Ç—Ä–µ–±—É–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤—ã—Ö samples
    </blockquote>
    <pre><code># –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
data = pd.read_csv('data.csv')
X = data.drop('target', axis=1)
y = data['target']

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
from sklearn.ensemble import RandomForestClassifier

model = RandomForestClassifier(n_estimators=100, random_state=42)
model.fit(X_train, y_train)

# –û—Ü–µ–Ω–∫–∞
from sklearn.metrics import accuracy_score, classification_report

y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"Accuracy: {accuracy:.3f}")
print(classification_report(y_test, y_pred))</code></pre>
  </div>



</div>
</body>
</html>
