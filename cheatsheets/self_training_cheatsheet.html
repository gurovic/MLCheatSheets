<!DOCTYPE html>
<html lang="ru">
<head><meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Self-Training Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
<style>
@media screen {body {font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;color: #333;background: #fafcff;padding: 10px;
        min-width: 900px;
      }}
@media print {body {background: white;padding: 0;}@page {size: A4 landscape;margin: 10mm;}}
    .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
.block {break-inside: avoid;margin-bottom: 1.2em;padding: 12px;background: white;border-radius: 6px;box-shadow: 0 1px 3px rgba(0,0,0,0.05);}
h1 {font-size: 1.6em;font-weight: 700;color: #1a5fb4;text-align: center;margin: 0 0 8px;column-span: all;}
.subtitle {text-align: center;color: #666;font-size: 0.9em;margin-bottom: 12px;column-span: all;}
h2 {font-size: 1.15em;font-weight: 700;color: #1a5fb4;margin: 0 0 8px;padding-bottom: 4px;border-bottom: 1px solid #e0e7ff;}
p, ul, ol {font-size: 0.92em;margin: 0.6em 0;}
ul, ol {padding-left: 18px;}
li {margin-bottom: 4px;}
code {font-family: 'Consolas', 'Courier New', monospace;background-color: #f0f4ff;padding: 1px 4px;border-radius: 3px;font-size: 0.88em;}
pre {background-color: #f0f4ff;padding: 8px;border-radius: 4px;overflow-x: auto;font-size: 0.84em;margin: 6px 0;}
pre code {padding: 0;background: none;white-space: pre-wrap;}
table {width: 100%;border-collapse: collapse;font-size: 0.82em;margin: 6px 0;}
th {background-color: #e6f0ff;text-align: left;padding: 4px 6px;font-weight: 600;}
td {padding: 4px 6px;border-bottom: 1px solid #f0f4ff;}
tr:nth-child(even) {background-color: #f8fbff;}
blockquote {font-style: italic;margin: 8px 0;padding: 6px 10px;background: #f8fbff;border-left: 2px solid #1a5fb4;font-size: 0.88em;}
@media print {.container {column-gap: 12px;}.block {box-shadow: none;}code, pre, table {font-size: 0.78em;}h1 {font-size: 1.4em;}h2 {font-size: 1em;}}
</style>
</head>
<body>
<div class="container">
  <h1>üîÅ Self-Training</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>
  
  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å</h2>
    <ul>
      <li><strong>–ü–æ–¥—Ö–æ–¥</strong>: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –∫–∞–∫ –º–µ—Ç–∫–∏</li>
      <li><strong>–ò—Ç–µ—Ä–∞—Ü–∏–∏</strong>: –æ–±—É—á–∏—Ç—å ‚Üí –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å ‚Üí –¥–æ–±–∞–≤–∏—Ç—å ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å</li>
      <li><strong>–ü—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏</strong>: —É–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º–µ—Ç–∫–∞–º–∏</li>
      <li><strong>–†–∏—Å–∫</strong>: –º–æ–∂–µ—Ç —É—Å–∏–ª–∏—Ç—å –æ—à–∏–±–∫–∏</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: –ª—é–±–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä</li>
    </ul>
    <blockquote>Self-training - –ø—Ä–æ—Å—Ç–æ–π –º–µ—Ç–æ–¥ –ø–æ–ª—É–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–æ–¥–µ–ª–∏</blockquote>

    </div>
<div class="block">
    <h2>üî∑ 2. –ê–ª–≥–æ—Ä–∏—Ç–º</h2>
    <pre><code># –ü—Å–µ–≤–¥–æ–∫–æ–¥:
1. –û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ L (labeled data)
2. –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –Ω–∞ U (unlabeled data)
3. –í—ã–±—Ä–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
4. –î–æ–±–∞–≤–∏—Ç—å –∫ L –∫–∞–∫ –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏
5. –ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å
6. –£–¥–∞–ª–∏—Ç—å –∏–∑ U
7. –ü–æ–≤—Ç–æ—Ä—è—Ç—å –¥–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏</code></pre>
    
    <p><strong>–ö—Ä–∏—Ç–µ—Ä–∏–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏:</strong></p>
    <pre><code>P(y|x) > threshold  # –æ–±—ã—á–Ω–æ 0.75-0.95</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Sklearn —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</h2>
    <pre><code>from sklearn.semi_supervised import SelfTrainingClassifier
from sklearn.ensemble import RandomForestClassifier
import numpy as np

# –î–∞–Ω–Ω—ã–µ: -1 –¥–ª—è –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö
X_train = np.array([[1, 2], [2, 3], [3, 4], [4, 5], [5, 6]])
y_train = np.array([0, 1, 0, -1, -1])  # -1 = unlabeled

# –ë–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä
base_clf = RandomForestClassifier(n_estimators=100, random_state=42)

# Self-training wrapper
st_clf = SelfTrainingClassifier(
    base_clf,
    threshold=0.75,      # –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
    criterion='threshold',
    k_best=10,           # –¢–æ–ø-K –ø—Ä–∏–º–µ—Ä–æ–≤
    max_iter=10,         # –ú–∞–∫—Å –∏—Ç–µ—Ä–∞—Ü–∏–π
    verbose=True
)

# –û–±—É—á–µ–Ω–∏–µ
st_clf.fit(X_train, y_train)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
X_test = np.array([[1.5, 2.5], [4.5, 5.5]])
y_pred = st_clf.predict(X_test)
print(f"Predictions: {y_pred}")

# Labeled samples (–∏–Ω–¥–µ–∫—Å—ã –ø–æ–º–µ—á–µ–Ω–Ω—ã—Ö –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏)
print(f"Labeled samples: {st_clf.labeled_iter_}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ç–±–æ—Ä–∞</h2>
    <table>
      <tr>
        <th>–ö—Ä–∏—Ç–µ—Ä–∏–π</th>
        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
        <th>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</th>
      </tr>
      <tr>
        <td>threshold</td>
        <td>P(y|x) > Œ∏</td>
        <td>–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –æ—Ç–±–æ—Ä</td>
      </tr>
      <tr>
        <td>k_best</td>
        <td>–¢–æ–ø-K –ø–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</td>
        <td>–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ä–∞–∑–º–µ—Ä</td>
      </tr>
      <tr>
        <td>combination</td>
        <td>threshold AND k_best</td>
        <td>–û–±–∞ —É—Å–ª–æ–≤–∏—è</td>
      </tr>
    </table>
    
    <pre><code># –ü—Ä–∏–º–µ—Ä —Å k_best
st_clf = SelfTrainingClassifier(
    base_clf,
    criterion='k_best',
    k_best=5  # –î–æ–±–∞–≤–ª—è—Ç—å –ø–æ 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –∑–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –†—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è</h2>
    <pre><code>def self_training(clf, X_labeled, y_labeled, 
                  X_unlabeled, threshold=0.9, max_iter=10):
    """
    –†—É—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è self-training
    """
    for iteration in range(max_iter):
        print(f"Iteration {iteration + 1}")
        
        # 1. –û–±—É—á–µ–Ω–∏–µ –Ω–∞ labeled
        clf.fit(X_labeled, y_labeled)
        
        # 2. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ unlabeled
        probs = clf.predict_proba(X_unlabeled)
        preds = clf.predict(X_unlabeled)
        
        # 3. –û—Ç–±–æ—Ä —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
        max_probs = probs.max(axis=1)
        confident_mask = max_probs > threshold
        
        if not confident_mask.any():
            print("No confident predictions")
            break
        
        # 4. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫ labeled
        X_confident = X_unlabeled[confident_mask]
        y_confident = preds[confident_mask]
        
        X_labeled = np.vstack([X_labeled, X_confident])
        y_labeled = np.hstack([y_labeled, y_confident])
        
        # 5. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ unlabeled
        X_unlabeled = X_unlabeled[~confident_mask]
        
        print(f"Added {confident_mask.sum()} samples")
        print(f"Remaining unlabeled: {len(X_unlabeled)}")
        
        if len(X_unlabeled) == 0:
            break
    
    return clf, X_labeled, y_labeled

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
clf_trained, X_final, y_final = self_training(
    RandomForestClassifier(),
    X_labeled, y_labeled, X_unlabeled,
    threshold=0.85, max_iter=5
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. –£–ª—É—á—à–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞</h2>
    <ul>
      <li><strong>Co-training</strong>: –¥–≤–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö
        <pre><code># –ú–æ–¥–µ–ª—å 1 –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö A
# –ú–æ–¥–µ–ª—å 2 –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö B
# –í–∑–∞–∏–º–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ</code></pre>
      </li>
      <li><strong>Tri-training</strong>: —Ç—Ä–∏ –º–æ–¥–µ–ª–∏ –≥–æ–ª–æ—Å—É—é—Ç
        <pre><code># 3 –º–æ–¥–µ–ª–∏ –æ–±—É—á–∞—é—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
# –°–æ–≥–ª–∞—à–µ–Ω–∏–µ 2 –∏–∑ 3 ‚Üí –º–µ—Ç–∫–∞</code></pre>
      </li>
      <li><strong>Mixup</strong>: —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤
        <pre><code>x_mix = Œªx‚ÇÅ + (1-Œª)x‚ÇÇ
y_mix = Œªy‚ÇÅ + (1-Œª)y‚ÇÇ</code></pre>
      </li>
      <li><strong>Data Augmentation</strong>: –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è + —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 7. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>
    <ul>
      <li><strong>–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤</strong>
        <ul><li>Sentiment analysis —Å –º–∞–ª–æ —Ä–∞–∑–º–µ—Ç–∫–∏</li></ul>
      </li>
      <li><strong>Computer Vision</strong>
        <ul><li>–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</li></ul>
      </li>
      <li><strong>NLP –∑–∞–¥–∞—á–∏</strong>
        <ul><li>Named Entity Recognition</li><li>Text categorization</li></ul>
      </li>
      <li><strong>–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</strong>
        <ul><li>–î–æ—Ä–æ–≥–∞—è —Ä–∞–∑–º–µ—Ç–∫–∞ —ç–∫—Å–ø–µ—Ä—Ç–æ–≤</li></ul>
      </li>
      <li><strong>–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏</strong>
        <ul><li>–¢—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏</li></ul>
      </li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 8. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
    <ul>
      <li><code>threshold</code>: 0.7-0.95
        <ul><li>–í—ã—à–µ ‚Üí –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–µ–µ, –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫</li><li>–ù–∏–∂–µ ‚Üí –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö, –±–æ–ª—å—à–µ —à—É–º–∞</li></ul>
      </li>
      <li><code>k_best</code>: 5-50
        <ul><li>–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ unlabeled</li></ul>
      </li>
      <li><code>max_iter</code>: 5-20
        <ul><li>–û–±—ã—á–Ω–æ —Ö–≤–∞—Ç–∞–µ—Ç 5-10</li></ul>
      </li>
      <li><code>verbose</code>: True
        <ul><li>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</li></ul>
      </li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 9. –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è</h2>
    <table>
      <tr>
        <th>–ü—Ä–æ–±–ª–µ–º–∞</th>
        <th>–†–µ—à–µ–Ω–∏–µ</th>
      </tr>
      <tr>
        <td>–£—Å–∏–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</td>
        <td>–í—ã—Å–æ–∫–∏–π threshold</td>
      </tr>
      <tr>
        <td>–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Å—Ö–æ–¥–∏–º–æ—Å—Ç—å</td>
        <td>–£–≤–µ–ª–∏—á–∏—Ç—å k_best</td>
      </tr>
      <tr>
        <td>–î–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤</td>
        <td>Class weights</td>
      </tr>
      <tr>
        <td>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</td>
        <td>–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –±–∞–∑–æ–≤–æ–≥–æ clf</td>
      </tr>
      <tr>
        <td>–ü–ª–æ—Ö–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞</td>
        <td>CalibratedClassifierCV</td>
      </tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 10. –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <ul>
      <li><strong>–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</strong>: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ calibrated probabilities</li>
      <li><strong>Threshold</strong>: –Ω–∞—á–Ω–∏—Ç–µ —Å 0.8-0.9</li>
      <li><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è</strong>: hold-out –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞</li>
      <li><strong>–†–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞</strong>: –µ—Å–ª–∏ —Ç–æ—á–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç</li>
      <li><strong>–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å</strong>: –≤—ã–±–∏—Ä–∞–π—Ç–µ —Å —Ö–æ—Ä–æ—à–µ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π</li>
      <li><strong>–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è</strong>: –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ</li>
      <li><strong>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥</strong>: —Å–ª–µ–¥–∏—Ç–µ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Å–µ–≤–¥–æ-–º–µ—Ç–æ–∫</li>
    </ul>
    
    <pre><code># –ü—Ä–∏–º–µ—Ä —Å –∫–∞–ª–∏–±—Ä–æ–≤–∫–æ–π
from sklearn.calibration import CalibratedClassifierCV

base_clf = RandomForestClassifier()
calibrated_clf = CalibratedClassifierCV(base_clf, cv=5)

st_clf = SelfTrainingClassifier(
    calibrated_clf,
    threshold=0.8
)</code></pre>
  </div>


</div>
</body>
</html>
