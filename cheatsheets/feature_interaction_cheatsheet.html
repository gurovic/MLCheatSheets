<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Feature Interaction –∏ Polynomial Features Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

    .container {
      column-count: 3;
      column-gap: 20px;
      max-width: 100%;
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üîó Feature Interaction –∏ Polynomial Features</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –ß—Ç–æ —Ç–∞–∫–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
    <p><strong>–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Interaction)</strong> ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—É—Ç—ë–º –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö.</p>
    <ul>
      <li><strong>–¶–µ–ª—å</strong>: –∑–∞—Ö–≤–∞—Ç–∏—Ç—å –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏</li>
      <li><strong>–ü—Ä–∏–º–µ—Ä</strong>: —Ü–µ–Ω–∞ = –ø–ª–æ—â–∞–¥—å √ó —Ä–∞–π–æ–Ω</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: —É–ª—É—á—à–µ–Ω–∏–µ –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
      <li><strong>–†–∏—Å–∫</strong>: –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–º —á–∏—Å–ª–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
    </ul>

  <div class="block">
    <h2>üî∑ 2. –ü—Ä–æ—Å—Ç—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</h2>
    <p>–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –≤—Ä—É—á–Ω—É—é.</p>
    <pre><code>import pandas as pd
import numpy as np

# –î–∞–Ω–Ω—ã–µ
df = pd.DataFrame({
    'age': [25, 30, 35, 40],
    'income': [50000, 60000, 70000, 80000],
    'education_years': [16, 18, 20, 22]
})

# –ü—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥–≤—É—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
df['age_income'] = df['age'] * df['income']

# –û—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
df['income_per_edu'] = df['income'] / df['education_years']

# –†–∞–∑–Ω–æ—Å—Ç—å
df['income_age_diff'] = df['income'] - df['age'] * 1000

print(df.head())</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Polynomial Features</h2>
    <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>
    <pre><code>from sklearn.preprocessing import PolynomialFeatures

# –ò—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏: [x1, x2]
X = np.array([[2, 3],
              [3, 4],
              [4, 5]])

# degree=2: [1, x1, x2, x1¬≤, x1¬∑x2, x2¬≤]
poly = PolynomialFeatures(degree=2, include_bias=True)
X_poly = poly.fit_transform(X)

print("–ò—Å—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:", X.shape)
print("–ü–æ—Å–ª–µ –ø–æ–ª–∏–Ω–æ–º–∞:", X_poly.shape)
print("\n–ù–∞–∑–≤–∞–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:")
print(poly.get_feature_names_out(['x1', 'x2']))</code></pre>
    
    <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è [2, 3]:</strong></p>
    <code>[1, 2, 3, 4, 6, 9]</code>
  </div>

  <div class="block">
    <h2>üî∑ 4. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã PolynomialFeatures</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</th></tr>
      <tr><td><code>degree</code></td><td>–°—Ç–µ–ø–µ–Ω—å –ø–æ–ª–∏–Ω–æ–º–∞</td><td>2-3 (—Ä–µ–¥–∫–æ –±–æ–ª—å—à–µ)</td></tr>
      <tr><td><code>interaction_only</code></td><td>–¢–æ–ª—å–∫–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è, –±–µ–∑ —Å—Ç–µ–ø–µ–Ω–µ–π</td><td>True –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ —á–∏—Å–ª–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</td></tr>
      <tr><td><code>include_bias</code></td><td>–î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É (1)</td><td>False —Å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ–º –º–æ–¥–µ–ª–µ–π</td></tr>
    </table>

    <pre><code># –¢–æ–ª—å–∫–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (–±–µ–∑ x1¬≤, x2¬≤)
poly = PolynomialFeatures(
    degree=2, 
    interaction_only=True,
    include_bias=False
)
X_interact = poly.fit_transform(X)

# –†–µ–∑—É–ª—å—Ç–∞—Ç: [x1, x2, x1¬∑x2]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –ü—Ä–∏–º–µ—Ä: –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è</h2>
    <pre><code>from sklearn.linear_model import LinearRegression
from sklearn.preprocessing import PolynomialFeatures
from sklearn.pipeline import Pipeline
from sklearn.model_selection import train_test_split

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# –ü–∞–π–ø–ª–∞–π–Ω —Å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
model = Pipeline([
    ('poly', PolynomialFeatures(degree=2, include_bias=False)),
    ('linear', LinearRegression())
])

# –û–±—É—á–µ–Ω–∏–µ
model.fit(X_train, y_train)

# –û—Ü–µ–Ω–∫–∞
train_score = model.score(X_train, y_train)
test_score = model.score(X_test, y_test)

print(f"Train R¬≤: {train_score:.4f}")
print(f"Test R¬≤: {test_score:.4f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. –†–æ—Å—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏</h2>
    <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ä–∞—Å—Ç—ë—Ç –∫–æ–º–±–∏–Ω–∞—Ç–æ—Ä–Ω–æ!</p>
    
    <table>
      <tr><th>–ò—Å—Ö–æ–¥–Ω–æ</th><th>degree=2</th><th>degree=3</th><th>degree=4</th></tr>
      <tr><td>2</td><td>6</td><td>10</td><td>15</td></tr>
      <tr><td>5</td><td>21</td><td>56</td><td>126</td></tr>
      <tr><td>10</td><td>66</td><td>286</td><td>1001</td></tr>
      <tr><td>20</td><td>231</td><td>1771</td><td>10626</td></tr>
    </table>

    <p><strong>–§–æ—Ä–º—É–ª–∞:</strong> C(n+d, d), –≥–¥–µ n ‚Äî —á–∏—Å–ª–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, d ‚Äî —Å—Ç–µ–ø–µ–Ω—å.</p>
    
    <blockquote>
      ‚ö†Ô∏è –ü—Ä–∏ –±–æ–ª—å—à–æ–º —á–∏—Å–ª–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é (Ridge, Lasso)!
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 7. –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è —Å –ø–æ–ª–∏–Ω–æ–º–∞–º–∏</h2>
    <pre><code>from sklearn.linear_model import Ridge, Lasso

# Ridge —Ä–µ–≥—Ä–µ—Å—Å–∏—è —Å –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
model_ridge = Pipeline([
    ('poly', PolynomialFeatures(degree=3)),
    ('scaler', StandardScaler()),
    ('ridge', Ridge(alpha=1.0))
])

model_ridge.fit(X_train, y_train)

# Lasso –¥–ª—è –æ—Ç–±–æ—Ä–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
model_lasso = Pipeline([
    ('poly', PolynomialFeatures(degree=3)),
    ('scaler', StandardScaler()),
    ('lasso', Lasso(alpha=0.1))
])

model_lasso.fit(X_train, y_train)

# Lasso –æ–±–Ω—É–ª–∏—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
print("–ù–µ–Ω—É–ª–µ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:", np.sum(model_lasso.named_steps['lasso'].coef_ != 0))</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –î–æ–º–µ–Ω–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</h2>
    <p>–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–Ω–∞–Ω–∏—è –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏.</p>
    
    <h3>–ü—Ä–∏–º–µ—Ä: –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å</h3>
    <pre><code># –¶–µ–Ω–∞ –∑–∞ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –º–µ—Ç—Ä
df['price_per_sqm'] = df['price'] / df['area']

# –í–æ–∑—Ä–∞—Å—Ç –∑–¥–∞–Ω–∏—è
df['building_age'] = 2024 - df['year_built']

# –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Ä–∞–π–æ–Ω–∞ –∏ –ø–ª–æ—â–∞–¥–∏
df['location_area'] = df['location_score'] * df['area']

# –û—Ç–Ω–æ—à–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç –∫ –ø–ª–æ—â–∞–¥–∏
df['rooms_per_sqm'] = df['rooms'] / df['area']</code></pre>

    <h3>–ü—Ä–∏–º–µ—Ä: –∫–ª–∏–µ–Ω—Ç—ã –±–∞–Ω–∫–∞</h3>
    <pre><code># –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –¥–æ–ª–≥–∞ –∫ –¥–æ—Ö–æ–¥—É
df['debt_to_income'] = df['debt'] / df['income']

# –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏
df['age_credit_history'] = df['age'] * df['credit_history_years']

# –î–æ—Ö–æ–¥ –Ω–∞ —á–ª–µ–Ω–∞ —Å–µ–º—å–∏
df['income_per_family_member'] = df['income'] / df['family_size']</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. –ü–æ–∏—Å–∫ –≤–∞–∂–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</h2>
    <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ–ª–µ–∑–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.</p>
    
    <h3>–ú–µ—Ç–æ–¥ 1: –ü–µ—Ä–µ–±–æ—Ä —Å –æ—Ü–µ–Ω–∫–æ–π</h3>
    <pre><code>from sklearn.feature_selection import mutual_info_regression
from itertools import combinations

def find_best_interactions(X, y, top_n=5):
    """–ù–∞–π—Ç–∏ —Ç–æ–ø-N –ª—É—á—à–∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π"""
    interactions = {}
    
    # –í—Å–µ –ø–∞—Ä—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
    for feat1, feat2 in combinations(X.columns, 2):
        interaction = X[feat1] * X[feat2]
        score = mutual_info_regression(
            interaction.values.reshape(-1, 1), y
        )[0]
        interactions[f"{feat1}*{feat2}"] = score
    
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
    sorted_int = sorted(interactions.items(), 
                       key=lambda x: x[1], 
                       reverse=True)
    
    return sorted_int[:top_n]

top_interactions = find_best_interactions(X_train, y_train)
print("–¢–æ–ø-5 –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π:")
for name, score in top_interactions:
    print(f"{name}: {score:.4f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Feature crosses (–∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ)</h2>
    <p>–ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>
    <pre><code>import pandas as pd

df = pd.DataFrame({
    'city': ['Moscow', 'SPB', 'Moscow', 'Kazan'],
    'property_type': ['flat', 'flat', 'house', 'flat'],
    'price': [100, 80, 150, 60]
})

# –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–æ—Å—Å-–ø—Ä–∏–∑–Ω–∞–∫–∞
df['city_type'] = df['city'] + '_' + df['property_type']

# One-hot encoding
df_encoded = pd.get_dummies(df, columns=['city_type'])
print(df_encoded)</code></pre>

    <p><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç:</strong> –ø—Ä–∏–∑–Ω–∞–∫–∏ <code>Moscow_flat</code>, <code>Moscow_house</code>, <code>SPB_flat</code>, etc.</p>
  </div>

  <div class="block">
    <h2>üî∑ 11. –ë–∏–Ω–Ω–∏–Ω–≥ + –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</h2>
    <p>–î–∏—Å–∫—Ä–µ—Ç–∏–∑–∞—Ü–∏—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π.</p>
    <pre><code>from sklearn.preprocessing import KBinsDiscretizer

# –ë–∏–Ω–Ω–∏–Ω–≥ –≤–æ–∑—Ä–∞—Å—Ç–∞
discretizer = KBinsDiscretizer(
    n_bins=5, 
    encode='ordinal', 
    strategy='quantile'
)
df['age_binned'] = discretizer.fit_transform(
    df[['age']]
)

# –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ binned –≤–æ–∑—Ä–∞—Å—Ç–∞ —Å –¥–æ—Ö–æ–¥–æ–º
df['age_bin_income'] = df['age_binned'] * df['income']

# –ò–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ
df['age_bin_str'] = df['age_binned'].astype(str)
df['age_location'] = df['age_bin_str'] + '_' + df['location']</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –≤ –¥–µ—Ä–µ—å—è—Ö</h2>
    <p>–î–µ—Ä–µ–≤—å—è —Ä–µ—à–µ–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è!</p>
    <ul>
      <li>–†–∞–∑–±–∏–µ–Ω–∏—è —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
      <li>–ù–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤—Ä—É—á–Ω—É—é –¥–ª—è RF, XGBoost, etc.</li>
      <li>–ù–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è</li>
    </ul>
    
    <pre><code>from sklearn.ensemble import RandomForestRegressor

# –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å –ë–ï–ó —è–≤–Ω—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
rf = RandomForestRegressor(n_estimators=100, random_state=42)
rf.fit(X_train, y_train)
score_base = rf.score(X_test, y_test)

# –° –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
poly = PolynomialFeatures(degree=2, interaction_only=True)
X_train_poly = poly.fit_transform(X_train)
X_test_poly = poly.transform(X_test)

rf_poly = RandomForestRegressor(n_estimators=100, random_state=42)
rf_poly.fit(X_train_poly, y_train)
score_poly = rf_poly.score(X_test_poly, y_test)

print(f"–ë–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π: {score_base:.4f}")
print(f"–° –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è–º–∏: {score_poly:.4f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 13. –ü—Ä–∏–º–µ—Ä —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</h2>
    <pre><code>import pandas as pd
from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import cross_val_score

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
housing = fetch_california_housing()
X = pd.DataFrame(housing.data, columns=housing.feature_names)
y = housing.target

# –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å
lr_base = LinearRegression()
scores_base = cross_val_score(lr_base, X, y, cv=5, scoring='r2')

# –° –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏
pipeline_poly = Pipeline([
    ('poly', PolynomialFeatures(degree=2, include_bias=False)),
    ('scaler', StandardScaler()),
    ('ridge', Ridge(alpha=10.0))
])
scores_poly = cross_val_score(pipeline_poly, X, y, cv=5, scoring='r2')

print(f"–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å: {scores_base.mean():.4f} ¬± {scores_base.std():.4f}")
print(f"–° –ø–æ–ª–∏–Ω–æ–º–∞–º–∏: {scores_poly.mean():.4f} ¬± {scores_poly.std():.4f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 14. –û—Ç–±–æ—Ä –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</h2>
    <p>–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –Ω—É–∂–µ–Ω –æ—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.</p>
    
    <h3>–ú–µ—Ç–æ–¥ 1: Lasso</h3>
    <pre><code>from sklearn.linear_model import LassoCV

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
poly = PolynomialFeatures(degree=2)
X_poly = poly.fit_transform(X)

# Lasso —Å –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
lasso = LassoCV(cv=5, random_state=42)
lasso.fit(X_poly, y)

# –í–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
feature_names = poly.get_feature_names_out(X.columns)
important_features = feature_names[lasso.coef_ != 0]

print(f"–û—Ç–æ–±—Ä–∞–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤: {len(important_features)} –∏–∑ {len(feature_names)}")
print("–í–∞–∂–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:")
for feat in important_features:
    if ' ' in feat:  # –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–±–µ–ª
        print(f"  {feat}")</code></pre>

    <h3>–ú–µ—Ç–æ–¥ 2: SelectFromModel</h3>
    <pre><code>from sklearn.feature_selection import SelectFromModel
from sklearn.ensemble import RandomForestRegressor

# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
X_poly = poly.fit_transform(X)

# –û—Ç–±–æ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
rf = RandomForestRegressor(n_estimators=100, random_state=42)
selector = SelectFromModel(rf, threshold='median')
selector.fit(X_poly, y)

X_selected = selector.transform(X_poly)
print(f"–û—Ç–æ–±—Ä–∞–Ω–æ: {X_selected.shape[1]} –∏–∑ {X_poly.shape[1]}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 15. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>
        <ul>
          <li>–õ–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏ (LR, Ridge, Lasso)</li>
          <li>SVM —Å –ª–∏–Ω–µ–π–Ω—ã–º —è–¥—Ä–æ–º</li>
          <li>–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è</li>
          <li>–ú–∞–ª–æ–µ —á–∏—Å–ª–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (< 20)</li>
          <li>–ï—Å—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –û—Å—Ç–æ—Ä–æ–∂–Ω–æ</h3>
        <ul>
          <li>–î–µ—Ä–µ–≤—å—è (–º–æ–≥—É—Ç –∏ –±–µ–∑ —ç—Ç–æ–≥–æ)</li>
          <li>–ú–Ω–æ–≥–æ –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (> 50)</li>
          <li>–ú–∞–ª—ã–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö</li>
          <li>–ù–µ—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏</li>
          <li>–í—ã—Å–æ–∫–∞—è —Å—Ç–µ–ø–µ–Ω—å –ø–æ–ª–∏–Ω–æ–º–∞ (> 3)</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 16. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã</h2>
    <ul>
      <li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ</strong> –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</li>
      <li><strong>–ù–∞—á–Ω–∏—Ç–µ —Å degree=2</strong>, —Ä–µ–¥–∫–æ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ</li>
      <li><strong>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é</strong> (Ridge/Lasso)</li>
      <li><strong>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</strong>, –ª–µ–≥–∫–æ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å—Å—è</li>
      <li><strong>–î–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è –≤–∞–∂–Ω–µ–µ</strong> –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–±–æ—Ä–∞</li>
      <li><strong>–û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</strong> –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</li>
      <li><strong>–í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ</strong> –≤–∞–∂–Ω—ã–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 17. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π</h2>
    <pre><code>import matplotlib.pyplot as plt
import seaborn as sns

# –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
interactions = pd.DataFrame()
for i, col1 in enumerate(X.columns):
    for col2 in X.columns[i+1:]:
        interactions[f"{col1}*{col2}"] = X[col1] * X[col2]

# –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
corr_with_target = interactions.corrwith(y).sort_values(ascending=False)

plt.figure(figsize=(10, 6))
corr_with_target.head(20).plot(kind='barh')
plt.xlabel('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π')
plt.title('–¢–æ–ø-20 –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π')
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 18. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –ù–∞—á–∞—Ç—å —Å –ø—Ä–æ—Å—Ç—ã—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (x1 * x2)</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω–Ω—ã–µ –∑–Ω–∞–Ω–∏—è</li>
      <li>[ ] –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å PolynomialFeatures —Å degree=2</li>
      <li>[ ] –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</li>
      <li>[ ] –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—é</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
      <li>[ ] –û—Ç–æ–±—Ä–∞—Ç—å –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</li>
      <li>[ ] –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
      <li>[ ] –°—Ä–∞–≤–Ω–∏—Ç—å —Å –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª—å—é</li>
      <li>[ ] –°–ª–µ–¥–∏—Ç—å –∑–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º—ã —É—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –Ω–æ –∏ –∏—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏. –ù–∞–ø—Ä–∏–º–µ—Ä, —Ü–µ–Ω–∞ –∫–≤–∞—Ä—Ç–∏—Ä—ã –∑–∞–≤–∏—Å–∏—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –æ—Ç –ø–ª–æ—â–∞–¥–∏ –∏ —Ä–∞–π–æ–Ω–∞ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ –∏ –æ—Ç –∏—Ö —Å–æ—á–µ—Ç–∞–Ω–∏—è ‚Äî –±–æ–ª—å—à–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –≤ —Ö–æ—Ä–æ—à–µ–º —Ä–∞–π–æ–Ω–µ —Å—Ç–æ–∏—Ç –Ω–µ–ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–æ—Ä–æ–∂–µ¬ª.
    </blockquote>
  </div>

</div>

</div>
</body>
</html>
