<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CatBoost Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      
        min-width: 900px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    a {
      color: #1a5fb4;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üê± CatBoost</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å</h2>
    <ul>
      <li><strong>–ê–ª–≥–æ—Ä–∏—Ç–º</strong>: –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ –æ—Ç Yandex</li>
      <li><strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</li>
      <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</strong>: –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã</li>
    </ul>

    </div>
<div class="block">
    <h2>üî∑ 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞</h2>
    <pre><code># pip
pip install catboost

# conda
conda install -c conda-forge catboost

# –° GPU (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω CUDA)
# GPU –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. –ë–∞–∑–æ–≤—ã–π –∫–æ–¥ ‚Äî –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</h2>
    <pre><code>from catboost import CatBoostClassifier
from sklearn.model_selection import train_test_split

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

# –£–∫–∞–∑—ã–≤–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
cat_features = ['city', 'gender', 'device']

# –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = CatBoostClassifier(
    iterations=1000,
    learning_rate=0.03,
    depth=6,
    verbose=100,  # –ø–µ—á–∞—Ç—å –∫–∞–∂–¥—ã–µ 100 –∏—Ç–µ—Ä–∞—Ü–∏–π
    random_state=42
)

# –û–±—É—á–µ–Ω–∏–µ
model.fit(
    X_train, y_train,
    cat_features=cat_features,
    eval_set=(X_test, y_test),
    early_stopping_rounds=50,
    plot=True  # –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è
)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
y_pred = model.predict(X_test)
y_proba = model.predict_proba(X_test)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –†–µ–≥—Ä–µ—Å—Å–∏—è</h2>
    <pre><code>from catboost import CatBoostRegressor

model = CatBoostRegressor(
    iterations=500,
    learning_rate=0.05,
    depth=6,
    loss_function='RMSE',  # –∏–ª–∏ 'MAE', 'MAPE'
    random_state=42
)

model.fit(
    X_train, y_train,
    cat_features=cat_features,
    eval_set=(X_test, y_test),
    verbose=False
)

y_pred = model.predict(X_test)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –†–∞–±–æ—Ç–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ!</h2>
    <pre><code>import pandas as pd

# –î–∞–Ω–Ω—ã–µ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ (—Å—Ç—Ä–æ–∫–∏ ‚Äî —ç—Ç–æ OK!)
data = pd.DataFrame({
    'age': [25, 30, 35, 40],
    'city': ['Moscow', 'SPB', 'Moscow', 'Kazan'],
    'color': ['red', 'blue', 'red', 'green'],
    'price': [100, 200, 150, 250]
})

# CatBoost —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏ –Ω–∞–ø—Ä—è–º—É—é!
# –ü—Ä–æ—Å—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ–º –∏–º–µ–Ω–∞ –∏–ª–∏ –∏–Ω–¥–µ–∫—Å—ã

# –í–∞—Ä–∏–∞–Ω—Ç 1: –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
cat_features = ['city', 'color']

# –í–∞—Ä–∏–∞–Ω—Ç 2: –∏–Ω–¥–µ–∫—Å—ã
cat_features = [1, 2]

# –í–∞—Ä–∏–∞–Ω—Ç 3: –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è DataFrame)
# CatBoost —Å–∞–º –Ω–∞–π–¥–µ—Ç object/category —Ç–∏–ø—ã
model.fit(
    X_train, y_train,
    cat_features='auto'  # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–ó–Ω–∞—á–µ–Ω–∏—è</th></tr>
      <tr><td><code>iterations</code></td><td>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤</td><td>100-10000</td></tr>
      <tr><td><code>learning_rate</code></td><td>–°–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</td><td>0.01-0.3</td></tr>
      <tr><td><code>depth</code></td><td>–ì–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤—å–µ–≤</td><td>4-10</td></tr>
      <tr><td><code>l2_leaf_reg</code></td><td>L2 —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</td><td>1-10</td></tr>
      <tr><td><code>border_count</code></td><td>–†–∞–∑–±–∏–µ–Ω–∏–π –¥–ª—è —á–∏—Å–ª. –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</td><td>32-255</td></tr>
      <tr><td><code>bagging_temperature</code></td><td>–ò–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç—å bagging</td><td>0-1</td></tr>
      <tr><td><code>random_strength</code></td><td>–°–ª—É—á–∞–π–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–∑–±–∏–µ–Ω–∏–∏</td><td>0-10</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 7. Loss Functions</h2>
    <table>
      <tr><th>–ó–∞–¥–∞—á–∞</th><th>Loss Function</th></tr>
      <tr><td>–ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è</td><td><code>Logloss</code></td></tr>
      <tr><td>–ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è</td><td><code>MultiClass</code></td></tr>
      <tr><td>–†–µ–≥—Ä–µ—Å—Å–∏—è</td><td><code>RMSE</code></td></tr>
      <tr><td>–†–µ–≥—Ä–µ—Å—Å–∏—è L1</td><td><code>MAE</code></td></tr>
      <tr><td>–†–µ–≥—Ä–µ—Å—Å–∏—è %</td><td><code>MAPE</code></td></tr>
      <tr><td>Ranking</td><td><code>YetiRank</code></td></tr>
      <tr><td>–ü—É–∞—Å—Å–æ–Ω</td><td><code>Poisson</code></td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 8. –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
    <pre><code># –ü–æ–ª—É—á–∏—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å
feature_importance = model.get_feature_importance()

# –î–ª—è DataFrame —Å –∏–º–µ–Ω–∞–º–∏
feature_names = X_train.columns
importance_df = pd.DataFrame({
    'feature': feature_names,
    'importance': feature_importance
}).sort_values('importance', ascending=False)

print(importance_df.head(10))

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è
model.get_feature_importance(
    prettified=True,
    type='FeatureImportance'  # –∏–ª–∏ 'ShapValues'
)

# –¢–∏–ø—ã –≤–∞–∂–Ω–æ—Å—Ç–∏:
# - FeatureImportance (default)
# - ShapValues (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ —Ç–æ—á–Ω–µ–µ)
# - Interaction (–≤–∞–∂–Ω–æ—Å—Ç—å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π)
# - PredictionDiff</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>
    <pre><code># –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π grid search
model = CatBoostClassifier()

grid = {
    'learning_rate': [0.01, 0.05, 0.1],
    'depth': [4, 6, 8],
    'l2_leaf_reg': [1, 3, 5, 7]
}

# Grid Search
grid_search_result = model.grid_search(
    grid,
    X_train, y_train,
    cv=5,
    plot=True,
    verbose=False
)

# –õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
print(grid_search_result['params'])

# Randomized Search
randomized_search_result = model.randomized_search(
    grid,
    X_train, y_train,
    n_iter=20,
    cv=5
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Pool ‚Äî –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –¥–∞—Ç–∞—Å–µ—Ç</h2>
    <pre><code>from catboost import Pool

# –°–æ–∑–¥–∞–Ω–∏–µ Pool —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
train_pool = Pool(
    data=X_train,
    label=y_train,
    cat_features=cat_features,
    weight=sample_weights,  # –≤–µ—Å–∞ –ø—Ä–∏–º–µ—Ä–æ–≤
    baseline=baseline,  # –Ω–∞—á–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    feature_names=feature_names
)

test_pool = Pool(
    data=X_test,
    label=y_test,
    cat_features=cat_features
)

# –û–±—É—á–µ–Ω–∏–µ
model = CatBoostClassifier(iterations=500)
model.fit(train_pool, eval_set=test_pool)

# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ Pool:
# - –ë—ã—Å—Ç—Ä–µ–µ (–ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ 1 —Ä–∞–∑)
# - –£–¥–æ–±–Ω–æ –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
# - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–µ—Å–æ–≤ –∏ baseline</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. Cross-Validation</h2>
    <pre><code>from catboost import cv

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
pool = Pool(X, y, cat_features=cat_features)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–¥–µ–ª–∏
params = {
    'iterations': 1000,
    'learning_rate': 0.03,
    'depth': 6,
    'loss_function': 'Logloss'
}

# CV
cv_results = cv(
    pool=pool,
    params=params,
    fold_count=5,
    shuffle=True,
    stratified=True,
    early_stopping_rounds=50,
    verbose=100
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
print(f"Best iteration: {cv_results.shape[0]}")
print(f"Best score: {cv_results['test-Logloss-mean'].min():.4f}")

# DataFrame —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
print(cv_results.head())</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. GPU —É—Å–∫–æ—Ä–µ–Ω–∏–µ</h2>
    <pre><code># CatBoost –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç GPU –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω!
model = CatBoostClassifier(
    iterations=1000,
    task_type='GPU',  # —è–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ
    devices='0',  # –Ω–æ–º–µ—Ä GPU (–∏–ª–∏ '0:1' –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö)
)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã GPU
model = CatBoostClassifier(
    task_type='GPU',
    gpu_ram_part=0.9,  # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 90% GPU –ø–∞–º—è—Ç–∏
    pinned_memory_size=2_000_000_000,  # 2GB
)

# –î–ª—è CPU (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ)
model = CatBoostClassifier(task_type='CPU')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 13. –†–∞–±–æ—Ç–∞ —Å —Ç–µ–∫—Å—Ç–æ–º</h2>
    <pre><code># CatBoost –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–µ–∫—Å—Ç–æ–º!
from catboost import CatBoostClassifier

# –î–∞–Ω–Ω—ã–µ —Å —Ç–µ–∫—Å—Ç–æ–≤—ã–º–∏ –∫–æ–ª–æ–Ω–∫–∞–º–∏
data = pd.DataFrame({
    'text_feature': ['hello world', 'machine learning', ...],
    'category': ['A', 'B', ...],
    'target': [0, 1, ...]
})

# –£–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
model = CatBoostClassifier(
    iterations=500,
    text_features=['text_feature'],  # —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
    cat_features=['category'],  # –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ
)

model.fit(X_train, y_train)

# CatBoost –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# - –¢–æ–∫–µ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç
# - –°–æ–∑–¥–∞–µ—Ç —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
# - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö –≤ –æ–±—É—á–µ–Ω–∏–∏</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 14. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è</h2>
    <pre><code># –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
model = CatBoostClassifier(iterations=1000)

model.fit(
    X_train, y_train,
    eval_set=(X_test, y_test),
    plot=True  # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ –≤ Jupyter
)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
model.fit(
    X_train, y_train,
    eval_set=(X_test, y_test),
    use_best_model=True,
    train_dir='catboost_info'  # —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ª–æ–≥–∏
)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ TensorBoard
# catboost_info —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã –¥–ª—è TensorBoard
# tensorboard --logdir=catboost_info

# –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
evals_result = model.get_evals_result()
print(evals_result.keys())  # –º–µ—Ç—Ä–∏–∫–∏
print(evals_result['learn']['Logloss'])  # –Ω–∞ train
print(evals_result['validation']['Logloss'])  # –Ω–∞ test</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 15. SHAP values (–æ–±—ä—è—Å–Ω–∏–º–æ—Å—Ç—å)</h2>
    <pre><code># CatBoost –∏–º–µ–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π SHAP!
import shap

# –ü–æ–ª—É—á–∏—Ç—å SHAP values
shap_values = model.get_feature_importance(
    data=Pool(X_test, cat_features=cat_features),
    type='ShapValues'
)

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
shap.initjs()
shap.force_plot(
    model.get_all_params()['baseline'],
    shap_values[0, :-1],  # –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞
    X_test.iloc[0]
)

# Summary plot
shap.summary_plot(
    shap_values[:, :-1],
    X_test
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 16. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞</h2>
    <pre><code># –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
# 1. CatBoost —Ñ–æ—Ä–º–∞—Ç (–ª—É—á—à–∏–π)
model.save_model('model.cbm')
model = CatBoostClassifier()
model.load_model('model.cbm')

# 2. JSON (—á–µ–ª–æ–≤–µ–∫–æ-—á–∏—Ç–∞–µ–º—ã–π)
model.save_model('model.json', format='json')

# 3. ONNX (–¥–ª—è production)
model.save_model('model.onnx', format='onnx')

# 4. Python object (–¥–ª—è sklearn Pipeline)
import pickle
with open('model.pkl', 'wb') as f:
    pickle.dump(model, f)

# 5. C++ –∫–æ–¥ (–¥–ª—è –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è)
model.save_model('model.cpp', format='cpp')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 17. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –•–æ—Ä–æ—à–æ</h3>
        <ul>
          <li>–ú–Ω–æ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
          <li>–¢–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
          <li>–ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (SHAP)</li>
          <li>–ù—É–∂–Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</li>
          <li>–ï—Å—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –ü–ª–æ—Ö–æ</h3>
        <ul>
          <li>–û—á–µ–Ω—å –º–∞–ª—ã–µ –¥–∞–Ω–Ω—ã–µ (<500 —Å—Ç—Ä–æ–∫)</li>
          <li>–ù—É–∂–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è</li>
          <li>–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ CNN)</li>
          <li>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ RNN/Transformer)</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 18. CatBoost vs XGBoost vs LightGBM</h2>
    <table>
      <tr><th>–ö—Ä–∏—Ç–µ—Ä–∏–π</th><th>CatBoost</th><th>LightGBM</th><th>XGBoost</th></tr>
      <tr><td>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</td><td>ü•á –ù–∞—Ç–∏–≤–Ω–æ</td><td>‚úì –ù—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å</td><td>‚ùå –ö–æ–¥–∏—Ä–æ–≤–∞—Ç—å</td></tr>
      <tr><td>–°–∫–æ—Ä–æ—Å—Ç—å</td><td>–°—Ä–µ–¥–Ω—è—è</td><td>ü•á –ë—ã—Å—Ç—Ä–∞—è</td><td>–ú–µ–¥–ª–µ–Ω–Ω–∞—è</td></tr>
      <tr><td>–¢–æ—á–Ω–æ—Å—Ç—å</td><td>ü•á –í—ã—Å–æ–∫–∞—è</td><td>–í—ã—Å–æ–∫–∞—è</td><td>–í—ã—Å–æ–∫–∞—è</td></tr>
      <tr><td>–ù–∞—Å—Ç—Ä–æ–π–∫–∞</td><td>ü•á –ü—Ä–æ—Å—Ç–∞—è</td><td>–°–ª–æ–∂–Ω–∞—è</td><td>–°—Ä–µ–¥–Ω—è—è</td></tr>
      <tr><td>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</td><td>ü•á –£—Å—Ç–æ–π—á–∏–≤</td><td>–°–∫–ª–æ–Ω–µ–Ω</td><td>–°—Ä–µ–¥–Ω–µ</td></tr>
      <tr><td>–¢–µ–∫—Å—Ç</td><td>ü•á –ü–æ–¥–¥–µ—Ä–∂–∫–∞</td><td>‚ùå</td><td>‚ùå</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 19. –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏</h2>
    <div class="good-vs-bad">
      <div class="bad">
        <h3>‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ</h3>
        <ul>
          <li>–ö–æ–¥–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—Ä—É—á–Ω—É—é</li>
          <li>–ù–µ —É–∫–∞–∑—ã–≤–∞—Ç—å <code>cat_features</code></li>
          <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π <code>depth</code></li>
          <li>–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å <code>use_best_model=True</code></li>
        </ul>
      </div>
      <div class="good">
        <h3>‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ</h3>
        <ul>
          <li>–ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–∞–∫ —Å—Ç—Ä–æ–∫–∏</li>
          <li>–í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞—Ç—å <code>cat_features</code></li>
          <li>–ù–∞—á–∏–Ω–∞—Ç—å —Å <code>depth=6</code></li>
          <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å early stopping –∏ best model</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 20. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</li>
      <li>[ ] –£–∫–∞–∑–∞—Ç—å <code>cat_features</code> –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>early_stopping_rounds</code></li>
      <li>[ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å <code>use_best_model=True</code></li>
      <li>[ ] –ù–∞—á–∞—Ç—å —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</li>
      <li>[ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å <code>depth</code> –∏ <code>learning_rate</code></li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Pool –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SHAP –¥–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´CatBoost ‚Äî —ç—Ç–æ —É–º–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–º–∞–µ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–∫–∞–∫ –µ—Å—Ç—å". –ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–∏ —Ç–∏–ø–∞ "–≥–æ—Ä–æ–¥" –∏–ª–∏ "—Ü–≤–µ—Ç", –Ω–µ –Ω—É–∂–Ω–æ –∏—Ö –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å ‚Äî CatBoost —Å–∞–º —Ä–∞–∑–±–µ—Ä–µ—Ç—Å—è –∏ –Ω–∞–π–¥–µ—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏¬ª.
    </blockquote>
  </div>

  <div class="block">
    <h2>üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>
    <ul>
      <li><a href="https://catboost.ai/" target="_blank">üåê –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç</a></li>
      <li><a href="https://catboost.ai/en/docs/" target="_blank">üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li>
      <li><a href="https://github.com/catboost/catboost" target="_blank">üíª GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π</a></li>
      <li><a href="https://catboost.ai/en/docs/concepts/parameter-tuning" target="_blank">‚öôÔ∏è –ì–∞–π–¥ –ø–æ —Ç—é–Ω–∏–Ω–≥—É</a></li>
      <li><a href="https://catboost.ai/en/docs/concepts/python-reference_catboostclassifier" target="_blank">üìñ API Reference</a></li>
      <li><a href="https://github.com/catboost/tutorials" target="_blank">üìù Tutorials –∏ –ø—Ä–∏–º–µ—Ä—ã</a></li>
      <li><a href="https://arxiv.org/abs/1706.09516" target="_blank">üìÑ –ù–∞—É—á–Ω–∞—è —Å—Ç–∞—Ç—å—è</a></li>
    </ul>
  </div>



</div>
</body>
</html>
