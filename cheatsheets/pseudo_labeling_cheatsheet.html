<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Pseudo-labeling Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üè∑Ô∏è Pseudo-labeling</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å</h2>
    <ul>
      <li><strong>–ü—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏</strong>: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏ –∫–∞–∫ –∏—Å—Ç–∏–Ω–Ω—ã—Ö –º–µ—Ç–æ–∫</li>
      <li><strong>Self-training</strong>: –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
      <li><strong>–ü–æ–ª—É–∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ–µ</strong>: –º–∞–ª–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö, –º–Ω–æ–≥–æ –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö</li>
      <li><strong>Bootstrapping</strong>: –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç —Å–∞–º—É —Å–µ–±—è</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, NLP, —Ç–∞–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
    </ul>

  <div class="block">
    <h2>üî∑ 2. –ë–∞–∑–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º</h2>
    <ol>
      <li>–û–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
      <li>–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –º–µ—Ç–∫–∏ –¥–ª—è –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö</li>
      <li>–í—ã–±—Ä–∞—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (confidence threshold)</li>
      <li>–î–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É —Å –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∞–º–∏</li>
      <li>–ü–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ</li>
      <li>–ü–æ–≤—Ç–æ—Ä—è—Ç—å –¥–æ —Å—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–ª–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</li>
    </ol>
  </div>

  <div class="block">
    <h2>üî∑ 3. –ë–∞–∑–æ–≤—ã–π –∫–æ–¥</h2>
    <pre><code>from sklearn.ensemble import RandomForestClassifier
import numpy as np

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
clf = RandomForestClassifier(n_estimators=100, random_state=42)
confidence_threshold = 0.9
max_iterations = 5

X_labeled, y_labeled = X_train, y_train
X_unlabeled = X_unlabeled_pool.copy()

for iteration in range(max_iterations):
    # –û–±—É—á–µ–Ω–∏–µ –Ω–∞ —Ç–µ–∫—É—â–∏—Ö —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö
    clf.fit(X_labeled, y_labeled)
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö
    proba = clf.predict_proba(X_unlabeled)
    confidence = np.max(proba, axis=1)
    predictions = np.argmax(proba, axis=1)
    
    # –í—ã–±–æ—Ä —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö
    high_conf_mask = confidence >= confidence_threshold
    
    if high_conf_mask.sum() == 0:
        print(f"Iteration {iteration}: No confident predictions")
        break
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ-—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö
    X_labeled = np.vstack([X_labeled, X_unlabeled[high_conf_mask]])
    y_labeled = np.hstack([y_labeled, predictions[high_conf_mask]])
    
    # –£–¥–∞–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö
    X_unlabeled = X_unlabeled[~high_conf_mask]
    
    print(f"Iteration {iteration}: Added {high_conf_mask.sum()} examples")

# –§–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å
clf.fit(X_labeled, y_labeled)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</h2>
    <table>
      <tr><th>–ü–æ—Ä–æ–≥</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</th></tr>
      <tr><td>0.90-0.95</td><td>–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è</td><td>–ú–∞–ª–∞—è —Ç–µ—Ä–ø–∏–º–æ—Å—Ç—å –∫ –æ—à–∏–±–∫–∞–º</td></tr>
      <tr><td>0.80-0.90</td><td>–í—ã—Å–æ–∫–∞—è</td><td>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –≤—ã–±–æ—Ä</td></tr>
      <tr><td>0.70-0.80</td><td>–°—Ä–µ–¥–Ω—è—è</td><td>–ú–∞–ª–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</td></tr>
      <tr><td>&lt;0.70</td><td>–ù–∏–∑–∫–∞—è</td><td>–†–∏—Å–∫–æ–≤–∞–Ω–Ω–æ, –º–æ–∂–µ—Ç –Ω–∞–≤—Ä–µ–¥–∏—Ç—å</td></tr>
    </table>
    
    <p><strong>–î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –ø–æ—Ä–æ–≥:</strong></p>
    <pre><code># –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –ø–æ –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—é
percentile = 90
threshold = np.percentile(confidence, percentile)

# –ò–ª–∏ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –ø—Ä–∏–º–µ—Ä–æ–≤
k_best = 100  # –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–ø-100 –Ω–∞ –∏—Ç–µ—Ä–∞—Ü–∏—é
idx = np.argsort(confidence)[-k_best:]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏–º–µ—Ä–æ–≤</h2>
    <ul>
      <li><strong>Maximum confidence</strong>: max P(y|x) > threshold</li>
      <li><strong>Margin-based</strong>: —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É top-2 –∫–ª–∞—Å—Å–∞–º–∏</li>
      <li><strong>Entropy-based</strong>: –Ω–∏–∑–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è</li>
      <li><strong>Balanced sampling</strong>: —Ä–∞–≤–Ω–æ–µ —á–∏—Å–ª–æ –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞</li>
      <li><strong>Curriculum learning</strong>: –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –∫ —Å–ª–æ–∂–Ω—ã–º</li>
    </ul>
    
    <pre><code># Margin sampling
def select_by_margin(proba, k):
    sorted_proba = np.sort(proba, axis=1)
    margins = sorted_proba[:, -1] - sorted_proba[:, -2]
    return np.argsort(margins)[-k:]  # –±–æ–ª—å—à–æ–π margin = —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å

# Entropy sampling
def select_by_entropy(proba, k):
    entropy = -np.sum(proba * np.log(proba + 1e-10), axis=1)
    return np.argsort(entropy)[:k]  # –Ω–∏–∑–∫–∞—è —ç–Ω—Ç—Ä–æ–ø–∏—è = —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å

# Balanced sampling
def balanced_sample(proba, k_per_class):
    predictions = np.argmax(proba, axis=1)
    confidence = np.max(proba, axis=1)
    selected = []
    for cls in np.unique(predictions):
        cls_mask = predictions == cls
        cls_conf = confidence[cls_mask]
        top_k = np.argsort(cls_conf)[-k_per_class:]
        selected.extend(np.where(cls_mask)[0][top_k])
    return np.array(selected)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. –í–∞—Ä–∏–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞</h2>
    <p><strong>Hard pseudo-labeling:</strong></p>
    <ul>
      <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å (argmax)</li>
      <li>–ü—Ä–æ—Å—Ç–æ–π –∏ –±—ã—Å—Ç—Ä—ã–π</li>
      <li>–ú–æ–∂–µ—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏</li>
    </ul>
    
    <p><strong>Soft pseudo-labeling:</strong></p>
    <ul>
      <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π</li>
      <li>–ë–æ–ª–µ–µ –≥–∏–±–∫–∏–π, –º–µ–Ω—å—à–µ –æ—à–∏–±–æ–∫</li>
      <li>–¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ soft labels</li>
    </ul>
    
    <pre><code># Soft labeling —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏
model.fit(X_labeled, y_labeled_onehot, epochs=10)
soft_labels = model.predict(X_unlabeled)

# –î–æ–±–∞–≤–∏—Ç—å —Å –≤–µ—Å–æ–º —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
confidence_weights = np.max(soft_labels, axis=1)
model.fit(X_combined, y_combined, 
          sample_weight=confidence_weights)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è</h2>
    <table>
      <tr><th>–ü—Ä–æ–±–ª–µ–º–∞</th><th>–†–µ—à–µ–Ω–∏–µ</th></tr>
      <tr><td>–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫</td><td>–í—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏</td></tr>
      <tr><td>–°–º–µ—â–µ–Ω–∏–µ –∫ —á–∞—Å—Ç—ã–º –∫–ª–∞—Å—Å–∞–º</td><td>–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–º–µ—Ä–æ–≤</td></tr>
      <tr><td>–ü–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</td><td>–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è, —Ä–∞–Ω–Ω—è—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞</td></tr>
      <tr><td>–ú–∞–ª–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å</td><td>–£–ª—É—á—à–∏—Ç—å –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å, –±–æ–ª—å—à–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö</td></tr>
      <tr><td>–†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</td><td>Ensemble pseudo-labeling</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 8. Ensemble Pseudo-labeling</h2>
    <pre><code>from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.linear_model import LogisticRegression

# –ù–µ—Å–∫–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
models = [
    RandomForestClassifier(n_estimators=100),
    GradientBoostingClassifier(n_estimators=100),
    LogisticRegression(max_iter=1000)
]

# –û–±—É—á–∏—Ç—å –≤—Å–µ –º–æ–¥–µ–ª–∏
for model in models:
    model.fit(X_labeled, y_labeled)

# –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
probas = [m.predict_proba(X_unlabeled) for m in models]
avg_proba = np.mean(probas, axis=0)

# –í—ã–±–æ—Ä —Ç–æ–ª—å–∫–æ —Å –∫–æ–Ω—Å–µ–Ω—Å—É—Å–æ–º
predictions = [np.argmax(p, axis=1) for p in probas]
consensus_mask = np.all(
    [pred == predictions[0] for pred in predictions],
    axis=0
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
high_conf = np.max(avg_proba, axis=1) > threshold
final_mask = consensus_mask & high_conf</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ Deep Learning</h2>
    <pre><code>import tensorflow as tf
from tensorflow import keras

# –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å
model = keras.Sequential([
    keras.layers.Dense(128, activation='relu'),
    keras.layers.Dropout(0.3),
    keras.layers.Dense(64, activation='relu'),
    keras.layers.Dense(num_classes, activation='softmax')
])

model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Pseudo-labeling loop
for iteration in range(5):
    # –û–±—É—á–µ–Ω–∏–µ
    model.fit(X_labeled, y_labeled, 
              epochs=10, verbose=0, 
              validation_split=0.1)
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
    proba = model.predict(X_unlabeled)
    conf = np.max(proba, axis=1)
    preds = np.argmax(proba, axis=1)
    
    # –í—ã–±–æ—Ä —É–≤–µ—Ä–µ–Ω–Ω—ã—Ö
    mask = conf > 0.9
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ
    X_labeled = np.vstack([X_labeled, X_unlabeled[mask]])
    y_labeled = np.hstack([y_labeled, preds[mask]])
    X_unlabeled = X_unlabeled[~mask]
    
    print(f"Iter {iteration}: added {mask.sum()} examples")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h2>
    <pre><code>from sklearn.metrics import accuracy_score, confusion_matrix

# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –ø–æ –∏—Ç–µ—Ä–∞—Ü–∏—è–º
metrics_history = []

for iteration in range(max_iterations):
    clf.fit(X_labeled, y_labeled)
    
    # –û—Ü–µ–Ω–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
    val_pred = clf.predict(X_val)
    val_acc = accuracy_score(y_val, val_pred)
    
    # –û—Ü–µ–Ω–∫–∞ –Ω–∞ –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –µ—Å—Ç—å –∏—Å—Ç–∏–Ω–∞)
    if y_unlabeled_true is not None:
        test_pred = clf.predict(X_unlabeled)
        test_acc = accuracy_score(y_unlabeled_true, test_pred)
    
    # –ö–∞—á–µ—Å—Ç–≤–æ –ø—Å–µ–≤–¥–æ-–º–µ—Ç–æ–∫
    proba = clf.predict_proba(X_unlabeled)
    avg_conf = np.mean(np.max(proba, axis=1))
    
    metrics_history.append({
        'iteration': iteration,
        'val_acc': val_acc,
        'test_acc': test_acc,
        'avg_confidence': avg_conf,
        'labeled_size': len(X_labeled)
    })
    
    # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –µ—Å–ª–∏ –∫–∞—á–µ—Å—Ç–≤–æ –ø–∞–¥–∞–µ—Ç
    if iteration > 0 and val_acc < metrics_history[-2]['val_acc']:
        print("Validation accuracy decreased, stopping")
        break</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –•–æ—Ä–æ—à–æ</h3>
        <ul>
          <li>–ú–∞–ª–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
          <li>–ú–Ω–æ–≥–æ –Ω–µ—Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
          <li>–†–∞–∑–º–µ—Ç–∫–∞ –¥–æ—Ä–æ–≥–∞—è</li>
          <li>–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ—á–Ω–∞—è</li>
          <li>–ö–ª–∞—Å—Å—ã —Ö–æ—Ä–æ—à–æ —Ä–∞–∑–¥–µ–ª–∏–º—ã</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –ü–ª–æ—Ö–æ</h3>
        <ul>
          <li>–û—á–µ–Ω—å –º–∞–ª–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö (&lt;50 –Ω–∞ –∫–ª–∞—Å—Å)</li>
          <li>–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å –ø–ª–æ—Ö–∞—è</li>
          <li>–°–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤</li>
          <li>–ù—É–∂–Ω–∞ 100% —Ç–æ—á–Ω–æ—Å—Ç—å</li>
        </ul>
      </div>
    </div>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏</h2>
    <p><strong>Pseudo-labeling —Å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–µ–π:</strong></p>
    <ul>
      <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞—É–≥–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –¥–ª—è –±–æ–ª—å—à–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏</li>
      <li>Consistency regularization: –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –æ—Ä–∏–≥–∏–Ω–∞–ª–∞ –∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏</li>
    </ul>
    
    <p><strong>Meta Pseudo Labels:</strong></p>
    <ul>
      <li>–û–±—É—á–∞—Ç—å ¬´—É—á–∏—Ç–µ–ª—è¬ª –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–æ–≥–æ, –∫–∞–∫ –µ–≥–æ –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç ¬´—É—á–µ–Ω–∏–∫—É¬ª</li>
      <li>–ë–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥</li>
    </ul>
    
    <p><strong>Noisy Student:</strong></p>
    <ul>
      <li>–û–±—É—á–∏—Ç—å —É—á–∏—Ç–µ–ª—è –Ω–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö</li>
      <li>–ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∏</li>
      <li>–û–±—É—á–∏—Ç—å —É—á–µ–Ω–∏–∫–∞ —Å —à—É–º–æ–º (dropout, –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è)</li>
      <li>–£—á–µ–Ω–∏–∫ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–æ–≤—ã–º —É—á–∏—Ç–µ–ª–µ–º</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 13. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –û–±—É—á–∏—Ç—å —Å–∏–ª—å–Ω—É—é –±–∞–∑–æ–≤—É—é –º–æ–¥–µ–ª—å</li>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å –ø–æ—Ä–æ–≥ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –≤–∞–ª–∏–¥–∞—Ü–∏—é</li>
      <li>[ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤ –≤ –ø—Å–µ–≤–¥–æ-–º–µ—Ç–∫–∞—Ö</li>
      <li>[ ] –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —á–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π (–æ–±—ã—á–Ω–æ 3-10)</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å early stopping</li>
      <li>[ ] –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∞–Ω—Å–∞–º–±–ª—å –¥–ª—è –±–æ–ª—å—à–µ–π –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏</li>
      <li>[ ] –°—Ä–∞–≤–Ω–∏—Ç—å —Å baseline (—Ç–æ–ª—å–∫–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ)</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´Pseudo-labeling ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –º–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç —Å–∞–º—É —Å–µ–±—è. –°–Ω–∞—á–∞–ª–∞ —É—á–∏–º –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ 
      —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –∑–∞—Ç–µ–º –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ—Ç–∫–∏ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –°–∞–º—ã–µ —É–≤–µ—Ä–µ–Ω–Ω—ã–µ 
      –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –¥–æ–±–∞–≤–ª—è–µ–º –≤ –æ–±—É—á–µ–Ω–∏–µ –∫–∞–∫ "–∏—Å—Ç–∏–Ω–Ω—ã–µ". –¢–∞–∫ –º–æ–¥–µ–ª—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–∏–ª—å–Ω–µ–µ —Å –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–µ–π¬ª.
    </blockquote>
  </div>

</div>

</div>
</body>
</html>