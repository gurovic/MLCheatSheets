<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ù–æ—Ä–º–∞–ª–∏–∑—É—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ (Normalizing Flows) Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
    .container { column-count: 3; column-gap: 20px; max-width: 100%; }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
    @media print { .container { column-gap: 12px; } .block { box-shadow: none; } code, pre, table { font-size: 0.78em; } h1 { font-size: 1.4em; } h2 { font-size: 1em; } }
  </style>
</head>
<body>

<div class="container">

  <h1>üé® –ù–æ—Ä–º–∞–ª–∏–∑—É—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ (Normalizing Flows) Cheatsheet</h1>
  <div class="subtitle">–ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏ ‚Ä¢ DDPM ‚Ä¢ Stable Diffusion ‚Ä¢ Image Generation<br>üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å –¥–∏—Ñ—Ñ—É–∑–∏–∏</h2>
<ul><li><strong>–ü—Ä—è–º–æ–π –ø—Ä–æ—Ü–µ—Å—Å</strong>: –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é</li><li><strong>–û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å</strong>: –æ–±—É—á–µ–Ω–∏–µ —É–±–∏—Ä–∞—Ç—å —à—É–º</li><li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç</strong>: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ —à—É–º–∞</li><li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: Stable Diffusion, DALL-E 2, Midjourney</li></ul><blockquote>–ù–æ—Ä–º–∞–ª–∏–∑—É—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ (Normalizing Flows) –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø—Ä–µ–≤—Ä–∞—â–∞—é—Ç —à—É–º –≤ –æ—Å–º—ã—Å–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –æ–±—É—á–∏–≤—à–∏—Å—å –æ–±—Ä–∞—Ç–Ω–æ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É –∑–∞—à—É–º–ª–µ–Ω–∏—è.</blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 2. –ü—Ä—è–º–æ–π –ø—Ä–æ—Ü–µ—Å—Å (Forward)</h2>
<pre><code># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≥–∞—É—Å—Å–æ–≤—Å–∫–æ–≥–æ —à—É–º–∞
q(x_t | x_{t-1}) = N(x_t; ‚àö(1-Œ≤_t) x_{t-1}, Œ≤_t I)

Œ≤_t - —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —à—É–º–∞ (noise schedule)
T - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ (1000)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. –û–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (Reverse)</h2>
<pre><code># –£–±–∏—Ä–∞–Ω–∏–µ —à—É–º–∞ (–æ–±—É—á–∞–µ–º–æ)
p_Œ∏(x_{t-1} | x_t) = N(x_{t-1}; Œº_Œ∏(x_t, t), Œ£_Œ∏(x_t, t))

–û–±—É—á–∞–µ—Ç—Å—è –Ω–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å —à—É–º</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. DDPM (Denoising Diffusion)</h2>
<pre><code>import torch
import torch.nn as nn

class UNet(nn.Module):
    # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —à—É–º–∞
    def forward(self, x_t, t):
        # x_t: –∑–∞—à—É–º–ª–µ–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
        # t: –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∞–≥
        return predicted_noise</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –û–±—É—á–µ–Ω–∏–µ</h2>
<pre><code># –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å
L = E[||Œµ - Œµ_Œ∏(x_t, t)||¬≤]

–≥–¥–µ:
Œµ - –Ω–∞—Å—Ç–æ—è—â–∏–π —à—É–º
Œµ_Œ∏ - –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π —à—É–º</code></pre><p>–ê–ª–≥–æ—Ä–∏—Ç–º –æ–±—É—á–µ–Ω–∏—è:</p><ol><li>–í–∑—è—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ x‚ÇÄ</li><li>–í—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–π —à–∞–≥ t</li><li>–î–æ–±–∞–≤–∏—Ç—å —à—É–º Œµ</li><li>–ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —à—É–º</li><li>–ú–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å MSE</li></ol>
  </div>

  <div class="block">
    <h2>üî∑ 6. Sampling (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è)</h2>
<pre><code># –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑ —á–∏—Å—Ç–æ–≥–æ —à—É–º–∞
x_T ~ N(0, I)  # —Å–ª—É—á–∞–π–Ω—ã–π —à—É–º

for t in reversed(range(T)):
    z = N(0, I) if t > 1 else 0
    x_{t-1} = 1/‚àöŒ±_t * (
        x_t - (1-Œ±_t)/‚àö(1-·æ±_t) * Œµ_Œ∏(x_t, t)
    ) + œÉ_t * z</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. Stable Diffusion</h2>
<pre><code>from diffusers import StableDiffusionPipeline

pipe = StableDiffusionPipeline.from_pretrained(
    "stabilityai/stable-diffusion-2-1"
)

image = pipe(
    prompt="A cat in space",
    num_inference_steps=50
).images[0]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. Guidance</h2>
<p><strong>Classifier-free guidance</strong> –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:</p><pre><code>ŒµÃÉ = Œµ_Œ∏(x_t, t, ‚àÖ) + 
    w * (Œµ_Œ∏(x_t, t, c) - Œµ_Œ∏(x_t, t, ‚àÖ))

w - –≤–µ—Å guidance (–æ–±—ã—á–Ω–æ 7.5)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Noise Schedule</h2>
<table><tr><th>–¢–∏–ø</th><th>–§–æ—Ä–º—É–ª–∞</th></tr><tr><td>Linear</td><td>Œ≤_t = Œ≤_min + (Œ≤_max - Œ≤_min) * t/T</td></tr><tr><td>Cosine</td><td>Œ±_t = cos((t/T + s)/(1+s) * œÄ/2)¬≤</td></tr></table>
  </div>

  <div class="block">
    <h2>üî∑ 10. Latent Diffusion</h2>
<p>Stable Diffusion —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ VAE:</p><ul><li>Encoder: —Å–∂–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</li><li>Diffusion: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ª–∞—Ç–µ–Ω—Ç–∞–º–∏</li><li>Decoder: –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</li><li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</strong>: –≤ 8x –±—ã—Å—Ç—Ä–µ–µ</li></ul>
  </div>

  <div class="block">
    <h2>üî∑ 11. ControlNet</h2>
<pre><code># –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–æ–ª—è (edges, pose)
from diffusers import ControlNetModel

controlnet = ControlNetModel.from_pretrained(
    "lllyasviel/control_v11p_sd15_canny"
)

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–µ–º
image = pipe(
    prompt="...",
    image=control_image
).images[0]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>
<ul><li>Text-to-Image (Stable Diffusion, DALL-E)</li><li>Image-to-Image (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)</li><li>Inpainting (–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–±–ª–∞—Å—Ç–µ–π)</li><li>Super-resolution</li><li>Video generation (AnimateDiff)</li></ul>
  </div>

  <div class="block">
    <h2>üî∑ 13. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å GAN</h2>
<table><tr><th>–ê—Å–ø–µ–∫—Ç</th><th>Diffusion</th><th>GAN</th></tr><tr><td>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å</td><td>–í—ã—Å–æ–∫–∞—è</td><td>–ù–∏–∑–∫–∞—è</td></tr><tr><td>–ö–∞—á–µ—Å—Ç–≤–æ</td><td>–û—á–µ–Ω—å –≤—ã—Å–æ–∫–æ–µ</td><td>–í—ã—Å–æ–∫–æ–µ</td></tr><tr><td>–°–∫–æ—Ä–æ—Å—Ç—å</td><td>–ú–µ–¥–ª–µ–Ω–Ω–∞—è</td><td>–ë—ã—Å—Ç—Ä–∞—è</td></tr></table>
  </div>

  <div class="block">
    <h2>üî∑ 14. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h2>
<ul><li><strong>DDIM</strong>: –±—ã—Å—Ç—Ä—ã–π sampling (50 —à–∞–≥–æ–≤ –≤–º–µ—Å—Ç–æ 1000)</li><li><strong>LCM</strong>: 4-8 —à–∞–≥–æ–≤</li><li><strong>TensorRT</strong>: —É—Å–∫–æ—Ä–µ–Ω–∏–µ inference</li><li><strong>Quantization</strong>: int8/float16</li></ul>
  </div>

  <div class="block">
    <h2>üî∑ 15. Best Practices</h2>
<ul><li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cosine schedule</li><li>[ ] Guidance weight 7-7.5</li><li>[ ] 50 —à–∞–≥–æ–≤ –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞</li><li>[ ] Negative prompts –¥–ª—è –∏–∑–±–µ–≥–∞–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤</li><li>[ ] –õ–∞—Ç–µ–Ω—Ç–Ω—ã–π diffusion –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏</li></ul>
  </div>

  <div class="block">
    <h2>üî∑ 16. –ß–µ–∫-–ª–∏—Å—Ç</h2>
<ul><li>[ ] –ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞</li><li>[ ] Prompt —Å–æ—Å—Ç–∞–≤–ª–µ–Ω</li><li>[ ] Guidance –Ω–∞—Å—Ç—Ä–æ–µ–Ω</li><li>[ ] –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —à–∞–≥–æ–≤ –≤—ã–±—Ä–∞–Ω–æ</li><li>[ ] Seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏</li></ul><blockquote>¬´–ù–æ—Ä–º–∞–ª–∏–∑—É—é—â–∏–µ –ø–æ—Ç–æ–∫–∏ (Normalizing Flows) ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–∫—É–ª—å–ø—Ç–æ—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏–∑ –±–µ—Å—Ñ–æ—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–∞–º–Ω—è (—à—É–º–∞) –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –≤—ã—Ä–µ–∑–∞–µ—Ç —à–µ–¥–µ–≤—Ä, —É–±–∏—Ä–∞—è –ª–∏—à–Ω–µ–µ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ¬ª.</blockquote>
  </div>

</div>

</body>
</html>
