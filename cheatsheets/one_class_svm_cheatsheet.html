<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>One-Class SVM Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; }}
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
  </style>
</head>
<body>
<div class="container">
  <h1>üéØ One-Class SVM –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∞–Ω–æ–º–∞–ª–∏–π</h1>
  <div class="subtitle"></div>

  <div class="block">
    <h2>üî∑ –°—É—Ç—å</h2>
    <ul>
      <li><strong>–¶–µ–ª—å</strong>: –Ω–∞–π—Ç–∏ –∞–Ω–æ–º–∞–ª–∏–∏/–≤—ã–±—Ä–æ—Å—ã</li>
      <li><strong>–û–±—É—á–µ–Ω–∏–µ</strong>: —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
      <li><strong>–ú–µ—Ç–æ–¥</strong>: —Å—Ç—Ä–æ–∏—Ç –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –≤–æ–∫—Ä—É–≥ –¥–∞–Ω–Ω—ã—Ö</li>
      <li><strong>–†–µ–∑—É–ª—å—Ç–∞—Ç</strong>: +1 = –Ω–æ—Ä–º–∞, -1 = –∞–Ω–æ–º–∞–ª–∏—è</li>
    </ul>

  <div class="block">
    <h2>üî∑ –ë–∞–∑–æ–≤—ã–π –∫–æ–¥</h2>
    <pre><code>from sklearn.svm import OneClassSVM
from sklearn.preprocessing import StandardScaler

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–∂–Ω–æ!
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X_normal)

# One-Class SVM
ocsvm = OneClassSVM(
    kernel='rbf',
    gamma='auto',
    nu=0.1  # –¥–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤
)

# –û–±—É—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
ocsvm.fit(X_scaled)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
predictions = ocsvm.predict(X_test_scaled)
# +1 = –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ, -1 = –∞–Ω–æ–º–∞–ª–∏–∏

anomalies = X_test[predictions == -1]
print(f"–ù–∞–π–¥–µ–Ω–æ –∞–Ω–æ–º–∞–ª–∏–π: {len(anomalies)}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</th></tr>
      <tr><td><code>nu</code></td><td>–î–æ–ª—è –≤—ã–±—Ä–æ—Å–æ–≤</td><td>0.01-0.1</td></tr>
      <tr><td><code>kernel</code></td><td>–¢–∏–ø —è–¥—Ä–∞</td><td>'rbf' (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)</td></tr>
      <tr><td><code>gamma</code></td><td>–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç RBF</td><td>'scale' –∏–ª–∏ 'auto'</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ –ü–æ–¥–±–æ—Ä nu</h2>
    <pre><code># –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è nu
nu_values = [0.01, 0.05, 0.1, 0.2]

for nu in nu_values:
    ocsvm = OneClassSVM(kernel='rbf', nu=nu)
    ocsvm.fit(X_scaled)
    preds = ocsvm.predict(X_scaled)
    
    n_outliers = (preds == -1).sum()
    print(f"nu={nu}: {n_outliers} –≤—ã–±—Ä–æ—Å–æ–≤ ({100*n_outliers/len(X):.1f}%)")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ Decision Function</h2>
    <pre><code># Decision function = —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –≥—Ä–∞–Ω–∏—Ü—ã
scores = ocsvm.decision_function(X_test_scaled)

# –ß–µ–º –º–µ–Ω—å—à–µ (–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–µ–µ), —Ç–µ–º –±–æ–ª–µ–µ –∞–Ω–æ–º–∞–ª—å–Ω—ã–π
# –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —Å—Ç–µ–ø–µ–Ω–∏ –∞–Ω–æ–º–∞–ª—å–Ω–æ—Å—Ç–∏
most_anomalous_idx = np.argsort(scores)[:10]

print("–¢–æ–ø-10 –∞–Ω–æ–º–∞–ª–∏–π:")
for i, idx in enumerate(most_anomalous_idx):
    print(f"{i+1}. Index {idx}, score: {scores[idx]:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –†–∞–∑–Ω—ã–µ —è–¥—Ä–∞</h2>
    <pre><code>kernels = ['linear', 'poly', 'rbf', 'sigmoid']

for kernel in kernels:
    ocsvm = OneClassSVM(kernel=kernel, nu=0.1)
    ocsvm.fit(X_scaled)
    preds = ocsvm.predict(X_test_scaled)
    
    n_anomalies = (preds == -1).sum()
    print(f"{kernel}: {n_anomalies} –∞–Ω–æ–º–∞–ª–∏–π")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h2>
    <pre><code>import matplotlib.pyplot as plt

# –û–±—É—á–µ–Ω–∏–µ
ocsvm = OneClassSVM(kernel='rbf', nu=0.1)
ocsvm.fit(X_scaled[:, :2])  # —Ç–æ–ª—å–∫–æ 2D –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
xx, yy = np.meshgrid(
    np.linspace(X_scaled[:, 0].min(), X_scaled[:, 0].max(), 100),
    np.linspace(X_scaled[:, 1].min(), X_scaled[:, 1].max(), 100)
)
Z = ocsvm.decision_function(np.c_[xx.ravel(), yy.ravel()])
Z = Z.reshape(xx.shape)

# –ì—Ä–∞—Ñ–∏–∫
plt.contourf(xx, yy, Z, levels=np.linspace(Z.min(), 0, 7), cmap='Blues_r')
plt.contour(xx, yy, Z, levels=[0], linewidths=2, colors='red')
plt.scatter(X_scaled[:, 0], X_scaled[:, 1], c='white', s=20, edgecolors='black')
plt.title('One-Class SVM Decision Boundary')
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <ul>
      <li>‚úÖ –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è</li>
      <li>‚úÖ –î–∞–Ω–Ω—ã–µ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —á–∏—Å—Ç—ã–µ</li>
      <li>‚úÖ –ù–µ–ª–∏–Ω–µ–π–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã</li>
      <li>‚úÖ –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä –¥–∞—Ç–∞—Å–µ—Ç–∞ (< 10K)</li>
      <li>‚ùå –û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ (–º–µ–¥–ª–µ–Ω–Ω–æ)</li>
      <li>‚ùå –í—ã—Å–æ–∫–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –±–µ–∑ PCA</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å LOF –∏ Isolation Forest</h2>
    <pre><code>from sklearn.svm import OneClassSVM
from sklearn.neighbors import LocalOutlierFactor
from sklearn.ensemble import IsolationForest

# One-Class SVM
ocsvm = OneClassSVM(nu=0.1)
ocsvm_pred = ocsvm.fit_predict(X_scaled)

# LOF
lof = LocalOutlierFactor(novelty=False)
lof_pred = lof.fit_predict(X_scaled)

# Isolation Forest
iforest = IsolationForest(contamination=0.1)
iforest_pred = iforest.fit_predict(X_scaled)

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
print(f"OCSVM: {(ocsvm_pred == -1).sum()} –∞–Ω–æ–º–∞–ª–∏–π")
print(f"LOF: {(lof_pred == -1).sum()} –∞–Ω–æ–º–∞–ª–∏–π")
print(f"IForest: {(iforest_pred == -1).sum()} –∞–Ω–æ–º–∞–ª–∏–π")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <ul>
      <li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ StandardScaler</li>
      <li><strong>nu</strong>: –Ω–∞—á–Ω–∏—Ç–µ —Å –æ–∂–∏–¥–∞–µ–º–æ–π –¥–æ–ª–∏ –≤—ã–±—Ä–æ—Å–æ–≤</li>
      <li><strong>PCA</strong>: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –≤—ã—Å–æ–∫–æ–π —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏</li>
      <li><strong>–í–∞–ª–∏–¥–∞—Ü–∏—è</strong>: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
      <li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</strong>: —Å–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ decision_function</li>
    </ul>
  </div>

</div>
</div>
</body>
</html>
