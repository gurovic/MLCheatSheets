<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gradient Boosting –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; 
        min-width: 900px;
      }}
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
  </style>
</head>
<body>
<div class="container">
  <h1>üéØ Gradient Boosting –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏</h1>
  <div class="subtitle"></div>

  <div class="block">
    <h2>üî∑ –°—É—Ç—å</h2>
    <ul>
      <li><strong>–¢–∏–ø</strong>: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∞–Ω—Å–∞–º–±–ª—å</li>
      <li><strong>Boosting</strong>: –∫–∞–∂–¥–æ–µ –¥–µ—Ä–µ–≤–æ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö</li>
      <li><strong>–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫</strong>: –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —Ñ—É–Ω–∫—Ü–∏–π</li>
      <li><strong>Learning rate</strong>: –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –¥–µ—Ä–µ–≤–∞</li>
    </ul>

    </div>
<div class="block">
    <h2>üî∑ –ö–æ–¥ (sklearn)</h2>
    <pre><code>from sklearn.ensemble import GradientBoostingRegressor

gb = GradientBoostingRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=3,
    min_samples_split=2,
    subsample=0.8,
    random_state=42
)

gb.fit(X_train, y_train)
y_pred = gb.predict(X_test)

from sklearn.metrics import mean_squared_error, r2_score
print(f"RMSE: {np.sqrt(mean_squared_error(y_test, y_pred)):.3f}")
print(f"R¬≤: {r2_score(y_test, y_pred):.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</th></tr>
      <tr><td><code>n_estimators</code></td><td>100-1000</td></tr>
      <tr><td><code>learning_rate</code></td><td>0.01-0.1</td></tr>
      <tr><td><code>max_depth</code></td><td>3-5 (–º–µ–ª–∫–∏–µ –¥–µ—Ä–µ–≤—å—è!)</td></tr>
      <tr><td><code>subsample</code></td><td>0.8 (stochastic GB)</td></tr>
      <tr><td><code>min_samples_split</code></td><td>2-20</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ Early Stopping</h2>
    <pre><code>gb = GradientBoostingRegressor(
    n_estimators=1000,
    learning_rate=0.05,
    max_depth=3,
    validation_fraction=0.1,
    n_iter_no_change=10,
    tol=1e-4
)

gb.fit(X_train, y_train)
print(f"Stopped at iteration: {gb.n_estimators_}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ XGBoost (–ª—É—á—à–µ!)</h2>
    <pre><code>import xgboost as xgb

xgb_reg = xgb.XGBRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=5,
    subsample=0.8,
    colsample_bytree=0.8,
    gamma=0,
    reg_alpha=0,
    reg_lambda=1,
    random_state=42
)

xgb_reg.fit(X_train, y_train)
y_pred = xgb_reg.predict(X_test)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ LightGBM (–µ—â–µ –±—ã—Å—Ç—Ä–µ–µ!)</h2>
    <pre><code>import lightgbm as lgb

lgb_reg = lgb.LGBMRegressor(
    n_estimators=100,
    learning_rate=0.1,
    max_depth=-1,
    num_leaves=31,
    subsample=0.8,
    colsample_bytree=0.8
)

lgb_reg.fit(X_train, y_train)
y_pred = lgb_reg.predict(X_test)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –ü–æ–¥–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</h2>
    <pre><code>from sklearn.model_selection import GridSearchCV

param_grid = {
    'n_estimators': [100, 200, 500],
    'learning_rate': [0.01, 0.05, 0.1],
    'max_depth': [3, 5, 7],
    'subsample': [0.8, 1.0]
}

grid = GridSearchCV(
    GradientBoostingRegressor(random_state=42),
    param_grid,
    cv=5,
    scoring='neg_mean_squared_error',
    n_jobs=-1
)

grid.fit(X_train, y_train)
print(grid.best_params_)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</h2>
    <ul>
      <li>–í—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</li>
      <li>–ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</li>
      <li>–í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</li>
      <li>–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö</li>
      <li>Feature importance</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏</h2>
    <ul>
      <li>–ú–µ–¥–ª–µ–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ)</li>
      <li>–õ–µ–≥–∫–æ –ø–µ—Ä–µ–æ–±—É—á–∞–µ—Ç—Å—è</li>
      <li>–¢—Ä–µ–±—É–µ—Ç —Ç—â–∞—Ç–µ–ª—å–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
      <li>–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <ul>
      <li>–ù–∞—á–Ω–∏—Ç–µ —Å –º–µ–ª–∫–∏—Ö –¥–µ—Ä–µ–≤—å–µ–≤ (max_depth=3)</li>
      <li>–ú–∞–ª–µ–Ω—å–∫–∏–π learning_rate + –º–Ω–æ–≥–æ –¥–µ—Ä–µ–≤—å–µ–≤</li>
      <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ early stopping</li>
      <li>–ü—Ä–æ–±—É–π—Ç–µ XGBoost –∏–ª–∏ LightGBM</li>
      <li>–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–π—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è –ª—É—á—à–µ–π —Ä–∞–±–æ—Ç—ã</li>
    </ul>
  </div>


</div>
</body>
</html>
