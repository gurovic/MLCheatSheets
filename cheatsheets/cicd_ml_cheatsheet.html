<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>CI/CD –¥–ª—è ML Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
    .container { column-count: 3; column-gap: 20px; max-width: 100%; }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
    table { width: 100%; border-collapse: collapse; font-size: 0.88em; margin: 6px 0; }
    th, td { padding: 6px 8px; text-align: left; border: 1px solid #e0e7ff; }
    th { background-color: #1a5fb4; color: white; font-weight: 700; }
    tr:nth-child(even) { background-color: #f8fbff; }
    @media print { .container { column-gap: 12px; } .block { box-shadow: none; } code, pre { font-size: 0.78em; } h1 { font-size: 1.4em; } h2 { font-size: 1em; } }
  </style>
</head>
<body>
<div class="container">
  <h1>‚öôÔ∏è CI/CD –¥–ª—è ML Cheatsheet</h1>
  <div class="subtitle">CI/CD for Machine Learning ‚Ä¢ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ñ–æ–∫—É—Å<br>üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –û—Å–Ω–æ–≤—ã CI/CD –¥–ª—è ML</h2>
<p><strong>CI/CD –¥–ª—è ML</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ ML –º–æ–¥–µ–ª–µ–π</p>
<ul>
  <li><strong>Continuous Integration</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ –∏ –º–æ–¥–µ–ª–µ–π</li>
  <li><strong>Continuous Delivery</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π deploy –≤ staging</li>
  <li><strong>Continuous Deployment</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π deploy –≤ production</li>
  <li><strong>Continuous Training</strong>: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</li>
  <li><strong>Model Monitoring</strong>: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ performance</li>
</ul>
<blockquote>üí° ML CI/CD –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ–≥–æ CI/CD –Ω–∞–ª–∏—á–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∏ –º–æ–¥–µ–ª–µ–π</blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 2. GitHub Actions –¥–ª—è ML</h2>
<pre><code># .github/workflows/ml-pipeline.yml
name: ML Pipeline

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.9
      
      - name: Install dependencies
        run: |
          pip install -r requirements.txt
      
      - name: Run tests
        run: |
          pytest tests/
      
      - name: Data validation
        run: |
          python scripts/validate_data.py
      
      - name: Train model
        run: |
          python train.py
      
      - name: Evaluate model
        run: |
          python evaluate.py
      
      - name: Check model metrics
        run: |
          python scripts/check_metrics.py
      
      - name: Register model
        if: github.ref == 'refs/heads/main'
        run: |
          python scripts/register_model.py</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. DVC –¥–ª—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</h2>
<pre><code># –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DVC
dvc init

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª—å DVC
dvc add data/raw/train.csv
dvc add models/model.pkl

# Git commit
git add data/raw/train.csv.dvc models/model.pkl.dvc
git commit -m "Add data and model"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ remote storage
dvc remote add -d myremote s3://mybucket/dvcstore
dvc push

# Pipeline —Å DVC
# dvc.yaml
stages:
  prepare:
    cmd: python prepare.py
    deps:
      - data/raw/train.csv
    outs:
      - data/processed/train.csv
  
  train:
    cmd: python train.py
    deps:
      - data/processed/train.csv
      - train.py
    params:
      - train.learning_rate
      - train.epochs
    metrics:
      - metrics.json:
          cache: false
    outs:
      - models/model.pkl

# –ó–∞–ø—É—Å–∫ pipeline
dvc repro

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
dvc metrics show
dvc plots show</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. MLflow –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞</h2>
<pre><code># mlflow_project/MLproject
name: my_ml_project

conda_env: conda.yaml

entry_points:
  main:
    parameters:
      learning_rate: {type: float, default: 0.01}
      epochs: {type: int, default: 100}
    command: "python train.py {learning_rate} {epochs}"

# –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ MLflow
mlflow run . -P learning_rate=0.001 -P epochs=200

# CI/CD integration
# .github/workflows/mlflow.yml
- name: Run MLflow project
  run: |
    mlflow run . --experiment-name ci-cd-experiment
    
    # Get best run
    BEST_RUN=$(mlflow runs list --experiment-name ci-cd-experiment \
      --order-by "metrics.accuracy DESC" --max-results 1 \
      --format json | jq -r '.[0].run_id')
    
    # Register if metrics are good
    python register_if_good.py $BEST_RUN</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. Automated Testing –¥–ª—è ML</h2>
<pre><code># tests/test_model.py
import pytest
from model import MyModel

def test_model_training():
    """–¢–µ—Å—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏"""
    model = MyModel()
    model.train(X_train, y_train)
    assert model.is_fitted()

def test_model_inference():
    """–¢–µ—Å—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π"""
    model = MyModel.load("model.pkl")
    predictions = model.predict(X_test)
    assert len(predictions) == len(X_test)
    assert all(0 <= p <= 1 for p in predictions)

def test_model_performance():
    """–¢–µ—Å—Ç –º–µ—Ç—Ä–∏–∫"""
    model = MyModel.load("model.pkl")
    accuracy = model.evaluate(X_test, y_test)
    assert accuracy >= 0.85, f"Accuracy {accuracy} below threshold"

def test_data_schema():
    """–¢–µ—Å—Ç —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö"""
    import pandas as pd
    df = pd.read_csv("data/train.csv")
    
    required_columns = ["feature1", "feature2", "target"]
    assert all(col in df.columns for col in required_columns)
    assert df["target"].isin([0, 1]).all()

def test_inference_time():
    """–¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞"""
    import time
    model = MyModel.load("model.pkl")
    
    start = time.time()
    model.predict(X_test[:1000])
    duration = time.time() - start
    
    assert duration < 1.0, f"Inference too slow: {duration}s"</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. Model Deployment</h2>
<pre><code># Deploy —Å GitHub Actions
- name: Deploy to production
  if: github.ref == 'refs/heads/main'
  run: |
    # Build Docker image
    docker build -t mymodel:${{ github.sha }} .
    
    # Push to registry
    docker push myregistry/mymodel:${{ github.sha }}
    
    # Deploy to Kubernetes
    kubectl set image deployment/mymodel \
      mymodel=myregistry/mymodel:${{ github.sha }}
    
    # Wait for rollout
    kubectl rollout status deployment/mymodel

# Dockerfile –¥–ª—è –º–æ–¥–µ–ª–∏
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY model.pkl .
COPY serve.py .

EXPOSE 8000

CMD ["python", "serve.py"]</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. Continuous Training</h2>
<pre><code># –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ
# .github/workflows/retrain.yml
name: Retrain Model

on:
  schedule:
    - cron: '0 0 * * 0'  # Weekly
  workflow_dispatch:      # Manual trigger

jobs:
  retrain:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Fetch latest data
        run: python scripts/fetch_data.py
      
      - name: Validate data
        run: python scripts/validate_data.py
      
      - name: Train model
        run: python train.py
      
      - name: Evaluate model
        run: python evaluate.py
      
      - name: Compare with production
        run: |
          python scripts/compare_models.py \
            --new-model models/model.pkl \
            --prod-model production/model.pkl \
            --test-data data/test.csv
      
      - name: Deploy if better
        if: success()
        run: python scripts/deploy_if_better.py</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. Model Monitoring –≤ CI/CD</h2>
<pre><code># –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ deploy
# .github/workflows/monitor.yml
name: Monitor Deployed Model

on:
  schedule:
    - cron: '*/30 * * * *'  # Every 30 min

jobs:
  monitor:
    runs-on: ubuntu-latest
    steps:
      - name: Check model health
        run: |
          curl -f http://model-api/health || exit 1
      
      - name: Check metrics
        run: |
          python scripts/check_production_metrics.py
      
      - name: Check for drift
        run: |
          python scripts/detect_drift.py
      
      - name: Alert if issues
        if: failure()
        run: |
          python scripts/send_alert.py</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Infrastructure as Code</h2>
<pre><code># Terraform –¥–ª—è ML infrastructure
# main.tf
resource "aws_sagemaker_model" "my_model" {
  name               = "my-model"
  execution_role_arn = aws_iam_role.sagemaker.arn

  primary_container {
    image          = var.model_image
    model_data_url = var.model_artifact_url
  }
}

resource "aws_sagemaker_endpoint_configuration" "config" {
  name = "my-model-config"

  production_variants {
    variant_name           = "variant-1"
    model_name             = aws_sagemaker_model.my_model.name
    initial_instance_count = 1
    instance_type          = "ml.m5.large"
  }
}

resource "aws_sagemaker_endpoint" "endpoint" {
  name                 = "my-model-endpoint"
  endpoint_config_name = aws_sagemaker_endpoint_configuration.config.name
}

# Apply —Å GitHub Actions
- name: Deploy infrastructure
  run: |
    terraform init
    terraform plan
    terraform apply -auto-approve</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Best Practices</h2>
<ul>
  <li>‚úÖ <strong>Version everything</strong>: code, data, models, config</li>
  <li>‚úÖ <strong>Automated testing</strong>: unit, integration, performance</li>
  <li>‚úÖ <strong>Gradual rollout</strong>: canary –∏–ª–∏ blue-green deployment</li>
  <li>‚úÖ <strong>Monitoring</strong>: –º–µ—Ç—Ä–∏–∫–∏, drift, errors</li>
  <li>‚úÖ <strong>Rollback plan</strong>: –±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö</li>
  <li>‚úÖ <strong>Documentation</strong>: –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ pipeline</li>
  <li>‚úÖ <strong>Reproducibility</strong>: —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ</li>
  <li>‚úÖ <strong>Security</strong>: —Å–∫–∞–Ω–∏—Ä—É–π—Ç–µ –Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–∏</li>
</ul>
  </div>

  <div class="block">
    <h2>üî∑ 11. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</h2>
<table>
  <tr><th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th><th>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</th></tr>
  <tr><td>CI/CD</td><td>GitHub Actions, GitLab CI, Jenkins</td></tr>
  <tr><td>Data versioning</td><td>DVC, Pachyderm</td></tr>
  <tr><td>Experiment tracking</td><td>MLflow, Weights & Biases</td></tr>
  <tr><td>Model registry</td><td>MLflow, Neptune.ai</td></tr>
  <tr><td>Orchestration</td><td>Airflow, Kubeflow, Prefect</td></tr>
  <tr><td>Deployment</td><td>Docker, Kubernetes, SageMaker</td></tr>
  <tr><td>Monitoring</td><td>Prometheus, Grafana, Evidently</td></tr>
</table>
  </div>

</div>
</body>
</html>