<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Few-Shot Learning Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    code { font-family: 'Consolas', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
  </style>
</head>
<body>
<div class="container">
  <h1>üéØ Few-Shot Learning</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –ü—Ä–æ–±–ª–µ–º–∞</h2>
    <p><strong>Few-shot</strong> ‚Äî –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–æ–≤.</p>
    <table>
      <tr><th>–¢–∏–ø</th><th>–î–∞–Ω–Ω—ã—Ö/–∫–ª–∞—Å—Å</th></tr>
      <tr><td>Standard</td><td>1000+</td></tr>
      <tr><td>Few-shot</td><td>1-10</td></tr>
      <tr><td>Zero-shot</td><td>0</td></tr>
    </table>
    <p><strong>–°—Ü–µ–Ω–∞—Ä–∏–∏:</strong></p>
    <ul>
      <li>1-shot: 1 –ø—Ä–∏–º–µ—Ä/–∫–ª–∞—Å—Å</li>
      <li>5-shot: 5 –ø—Ä–∏–º–µ—Ä–æ–≤/–∫–ª–∞—Å—Å</li>
      <li>N-way K-shot</li>
    </ul>

  <div class="block">
    <h2>üî∑ 2. Siamese Networks</h2>
    <pre><code>class SiameseNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv = nn.Sequential(
            nn.Conv2d(1, 64, 10),
            nn.ReLU(),
            nn.MaxPool2d(2),
            nn.Conv2d(64, 128, 7),
            nn.ReLU()
        )
        self.fc = nn.Linear(128*6*6, 4096)
    
    def forward_once(self, x):
        x = self.conv(x)
        x = x.view(x.size(0), -1)
        return self.fc(x)
    
    def forward(self, x1, x2):
        out1 = self.forward_once(x1)
        out2 = self.forward_once(x2)
        return out1, out2</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Contrastive Loss</h2>
    <pre><code>class ContrastiveLoss(nn.Module):
    def __init__(self, margin=2.0):
        super().__init__()
        self.margin = margin
    
    def forward(self, out1, out2, label):
        dist = F.pairwise_distance(out1, out2)
        loss = (1-label) * dist.pow(2) + 
               label * F.relu(self.margin - dist).pow(2)
        return loss.mean()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. Triplet Loss</h2>
    <pre><code>class TripletLoss(nn.Module):
    def __init__(self, margin=1.0):
        super().__init__()
        self.margin = margin
    
    def forward(self, anchor, pos, neg):
        dist_pos = (anchor - pos).pow(2).sum(1)
        dist_neg = (anchor - neg).pow(2).sum(1)
        
        loss = F.relu(dist_pos - dist_neg + self.margin)
        return loss.mean()

# anchor, positive, negative
loss = criterion(emb_a, emb_p, emb_n)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. Prototypical Networks</h2>
    <pre><code># –ü—Ä–æ—Ç–æ—ÇÔøΩÔøΩ–ø = —Å—Ä–µ–¥–Ω–µ–µ –∫–ª–∞—Å—Å–∞
def compute_prototypes(embeddings, labels, n_way):
    prototypes = []
    for c in range(n_way):
        mask = (labels == c)
        proto = embeddings[mask].mean(0)
        prototypes.append(proto)
    return torch.stack(prototypes)

# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é
distances = torch.cdist(query_emb, prototypes)
predictions = (-distances).softmax(dim=1)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. MAML</h2>
    <p><strong>Model-Agnostic Meta-Learning</strong></p>
    <pre><code>import learn2learn as l2l

maml = l2l.algorithms.MAML(model, lr=0.01)

for task in tasks:
    # Clone model
    learner = maml.clone()
    
    # Inner loop: adapt to task
    for _ in range(5):
        loss = compute_loss(learner, support)
        learner.adapt(loss)
    
    # Outer loop: meta-loss
    loss = compute_loss(learner, query)
    loss.backward()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. Zero-Shot —Å CLIP</h2>
    <pre><code>import clip

model, preprocess = clip.load("ViT-B/32")

# –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤
classes = ["cat", "dog", "bird"]
text = clip.tokenize([f"a photo of a {c}" for c in classes])

with torch.no_grad():
    text_features = model.encode_text(text)
    image_features = model.encode_image(image)
    
    # Cosine similarity
    similarity = (image_features @ text_features.T)
    pred = similarity.argmax()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –î–∞—Ç–∞—Å–µ—Ç—ã</h2>
    <table>
      <tr><th>–î–∞—Ç–∞—Å–µ—Ç</th><th>–ö–ª–∞—Å—Å–æ–≤</th></tr>
      <tr><td>Omniglot</td><td>1623</td></tr>
      <tr><td>Mini-ImageNet</td><td>100</td></tr>
      <tr><td>CUB-200</td><td>200</td></tr>
      <tr><td>CIFAR-FS</td><td>100</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 9. Evaluation Protocol</h2>
    <pre><code># N-way K-shot
N = 5  # –∫–ª–∞—Å—Å–æ–≤
K = 1  # –ø—Ä–∏–º–µ—Ä–æ–≤ –Ω–∞ –∫–ª–∞—Å—Å
Q = 15 # query –ø—Ä–∏–º–µ—Ä–æ–≤

# Sample task
support, query = sample_task(dataset, N, K, Q)

# Evaluate
accuracies = []
for _ in range(600):  # 600 tasks
    acc = eval_task(model, support, query)
    accuracies.append(acc)

print(f"Accuracy: {np.mean(accuracies)}¬±{np.std(accuracies)}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Best Practices</h2>
    <ul>
      <li>Metric learning –¥–ª—è –Ω–∞—á–∞–ª–∞</li>
      <li>Prototypical Networks ‚Äî –ø—Ä–æ—Å—Ç—ã–µ</li>
      <li>MAML ‚Äî –ª—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</li>
      <li>CLIP –¥–ª—è zero-shot</li>
      <li>Augmentation –∫—Ä–∏—Ç–∏—á–Ω–∞</li>
      <li>Pre-training –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω</li>
    </ul>
    <blockquote>
¬´Few-shot ‚Äî —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —É—á–∏—Ç—å—Å—è –Ω–∞ –º–∞–ª–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–æ–≤, –∫–∞–∫ —á–µ–ª–æ–≤–µ–∫ —É–∑–Ω–∞—ë—Ç –Ω–æ–≤–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ –ø–æ—Å–ª–µ –æ–¥–Ω–æ–≥–æ-–¥–≤—É—Ö –ø–æ–∫–∞–∑–æ–≤¬ª.
    </blockquote>
  </div>

</div>
</div>
</body>
</html>
