<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Surrogate Models Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
  </style>
</head>
<body>
<div class="container">
  <h1>üîç Surrogate Models</h1>
  <div class="subtitle"></div>
  
  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å</h2>
    <ul>
      <li><strong>–¶–µ–ª—å</strong>: –æ–±—ä—è—Å–Ω–∏—Ç—å —Å–ª–æ–∂–Ω—É—é –º–æ–¥–µ–ª—å —á–µ—Ä–µ–∑ –ø—Ä–æ—Å—Ç—É—é</li>
      <li><strong>–ò–¥–µ—è</strong>: –æ–±—É—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—É—é –º–æ–¥–µ–ª—å –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö —Å–ª–æ–∂–Ω–æ–π</li>
      <li><strong>Black-box ‚Üí White-box</strong></li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: —Ä–µ–≥—É–ª—è—Ç–æ—Ä, debugging, feature insights</li>
    </ul>

  <div class="block">
    <h2>üî∑ 2. –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Å—É—Ä—Ä–æ–≥–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å</h2>
    <pre><code>from sklearn.ensemble import RandomForestClassifier
from sklearn.linear_model import LogisticRegression

# Complex model
complex_model = RandomForestClassifier(n_estimators=100)
complex_model.fit(X_train, y_train)

# Predictions
y_pred_train = complex_model.predict(X_train)

# Surrogate model (interpretable)
surrogate = LogisticRegression()
surrogate.fit(X_train, y_pred_train)

# Interpretation
print("Coefficients:", surrogate.coef_)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Decision Tree Surrogate</h2>
    <pre><code>from sklearn.tree import DecisionTreeClassifier, export_text

# Shallow tree as surrogate
surrogate_tree = DecisionTreeClassifier(max_depth=4)
surrogate_tree.fit(X_train, complex_model.predict(X_train))

# Extract rules
rules = export_text(surrogate_tree, feature_names=feature_names)
print(rules)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. Fidelity Score</h2>
    <pre><code>from sklearn.metrics import accuracy_score

y_complex = complex_model.predict(X_test)
y_surrogate = surrogate.predict(X_test)

fidelity = accuracy_score(y_complex, y_surrogate)
print(f"Fidelity: {fidelity:.3f}")
# > 0.9 —Ö–æ—Ä–æ—à–æ, < 0.7 –ø–ª–æ—Ö–æ</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. Local vs Global</h2>
    <table>
      <tr><th>–¢–∏–ø</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th></tr>
      <tr><td>Global</td><td>–í–µ—Å—å –¥–∞—Ç–∞—Å–µ—Ç</td></tr>
      <tr><td>Local</td><td>–í–æ–∫—Ä—É–≥ –æ–¥–Ω–æ–π —Ç–æ—á–∫–∏ (LIME)</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 6. Model Distillation</h2>
    <pre><code># Teacher-student approach
teacher = RandomForestClassifier(n_estimators=200)
teacher.fit(X_train, y_train)

# Student learns from teacher
student = DecisionTreeClassifier(max_depth=5)
student.fit(X_train, teacher.predict(X_train))</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. Rule Extraction</h2>
    <pre><code>def extract_rules(tree, feature_names):
    tree_ = tree.tree_
    rules = []
    
    def recurse(node, rule):
        if tree_.feature[node] != -2:
            name = feature_names[tree_.feature[node]]
            threshold = tree_.threshold[node]
            recurse(tree_.children_left[node], 
                   rule + [f"{name} <= {threshold:.2f}"])
            recurse(tree_.children_right[node],
                   rule + [f"{name} > {threshold:.2f}"])
        else:
            rules.append(" AND ".join(rule))
    
    recurse(0, [])
    return rules</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h2>
    <pre><code>from sklearn.tree import plot_tree
import matplotlib.pyplot as plt

plt.figure(figsize=(20,10))
plot_tree(surrogate_tree, 
          feature_names=feature_names,
          filled=True, rounded=True)
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏</h2>
    <ul>
      <li>–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ fidelity (>0.85)</li>
      <li>–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Å–ª–æ–∂–Ω–æ—Å—Ç—å surrogate</li>
      <li>–°—Ä–∞–≤–Ω–∏–≤–∞–π—Ç–µ feature importance</li>
      <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è debugging</li>
      <li>–ö–æ–º–±–∏–Ω–∏—Ä—É–π—Ç–µ —Å SHAP/LIME</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 10. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø surrogate (linear/tree)</li>
      <li>[ ] –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è black-box</li>
      <li>[ ] –û–±—É—á–∏—Ç—å surrogate</li>
      <li>[ ] –ò–∑–º–µ—Ä–∏—Ç—å fidelity</li>
      <li>[ ] –ò–∑–≤–ª–µ—á—å interpretations</li>
      <li>[ ] –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å</li>
      <li>[ ] –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ hold-out</li>
      <li>[ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</li>
    </ul>
    <blockquote>
      ¬´Surrogate model ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞, –∏–º–∏—Ç–∏—Ä—É—é—â–∏–µ —Å–ª–æ–∂–Ω—É—é –º–æ–¥–µ–ª—å. –ú—ã –ø–æ–ª—É—á–∞–µ–º –ø–æ–Ω—è—Ç–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —ç–∫—Å–ø–µ—Ä—Ç–∞¬ª.
    </blockquote>
  </div>

</div>
</div>
</body>
</html>
