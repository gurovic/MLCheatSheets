<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Graph Neural Networks Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
    .container { column-count: 3; column-gap: 20px; }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    code { font-family: 'Consolas', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
  </style>
</head>
<body>
<div class="container">
  <h1>üï∏Ô∏è Graph Neural Networks Cheatsheet</h1>
  <div class="subtitle">GCN ‚Ä¢ GAT ‚Ä¢ GraphSAGE ‚Ä¢ Message Passing<br>üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –ß—Ç–æ —Ç–∞–∫–æ–µ GNN?</h2>
    <p><strong>Graph Neural Networks</strong> ‚Äî –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –¥–ª—è –≥—Ä–∞—Ñ–æ–≤.</p>
    <ul>
      <li>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</li>
      <li>–ú–æ–ª–µ–∫—É–ª—ã (–∞—Ç–æ–º—ã –∏ —Å–≤—è–∑–∏)</li>
      <li>–î–æ—Ä–æ–∂–Ω—ã–µ —Å–µ—Ç–∏</li>
      <li>Knowledge graphs</li>
    </ul>
    <table>
      <tr><th>–ó–∞–¥–∞—á–∞</th><th>–ü—Ä–∏–º–µ—Ä</th></tr>
      <tr><td>Node classification</td><td>–ö–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</td></tr>
      <tr><td>Link prediction</td><td>–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –¥—Ä—É–∑–µ–π</td></tr>
      <tr><td>Graph classification</td><td>–°–≤–æ–π—Å—Ç–≤–∞ –º–æ–ª–µ–∫—É–ª—ã</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 2. –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞</h2>
    <pre><code>import torch
from torch_geometric.data import Data

# –ì—Ä–∞—Ñ: —É–∑–ª—ã + —Ä–µ–±—Ä–∞
edge_index = torch.tensor([
    [0, 1, 1, 2],
    [1, 0, 2, 1]
], dtype=torch.long)

# –ü—Ä–∏–∑–Ω–∞–∫–∏ —É–∑–ª–æ–≤
x = torch.tensor([
    [1.0, 0.0],
    [0.0, 1.0],
    [0.5, 0.5]
], dtype=torch.float)

data = Data(x=x, edge_index=edge_index)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Message Passing</h2>
    <p><strong>–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è</strong> ‚Äî –æ–±–º–µ–Ω –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:</p>
    <pre><code>h_v^(k+1) = UPDATE(
    h_v^(k), 
    AGGREGATE({h_u^(k) : u ‚àà N(v)})
)</code></pre>
    <p><strong>–®–∞–≥–∏:</strong></p>
    <ol>
      <li>–°–æ–±—Ä–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç —Å–æ—Å–µ–¥–µ–π</li>
      <li>–ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å (sum/mean/max)</li>
      <li>–û–±–Ω–æ–≤–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ</li>
      <li>–ü–æ–≤—Ç–æ—Ä–∏—Ç—å K —Ä–∞–∑</li>
    </ol>
  </div>

  <div class="block">
    <h2>üî∑ 4. GCN Layer</h2>
    <pre><code>from torch_geometric.nn import GCNConv

class GCN(torch.nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = GCNConv(16, 32)
        self.conv2 = GCNConv(32, 7)
    
    def forward(self, x, edge_index):
        x = self.conv1(x, edge_index)
        x = F.relu(x)
        x = F.dropout(x, training=self.training)
        x = self.conv2(x, edge_index)
        return x</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. GAT (Attention)</h2>
    <pre><code>from torch_geometric.nn import GATConv

self.conv = GATConv(
    in_channels=16,
    out_channels=8,
    heads=8,
    dropout=0.6
)

# Multi-head attention
x = self.conv(x, edge_index)</code></pre>
    <p>Attention: —Ä–∞–∑–Ω—ã–µ —Å–æ—Å–µ–¥–∏ = —Ä–∞–∑–Ω—ã–π –≤–µ—Å</p>
  </div>

  <div class="block">
    <h2>üî∑ 6. GraphSAGE</h2>
    <pre><code>from torch_geometric.nn import SAGEConv

self.conv = SAGEConv(in_ch, out_ch)

# Sampling —Å–æ—Å–µ–¥–µ–π
# –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –±–æ–ª—å—à–∏–µ –≥—Ä–∞—Ñ—ã
# Inductive learning</code></pre>
  </div>

  <div class="block">
    <h2>ÔøΩÔøΩ 7. –û–±—É—á–µ–Ω–∏–µ</h2>
    <pre><code>model = GCN()
optimizer = optim.Adam(model.parameters(), lr=0.01)

for epoch in range(200):
    model.train()
    optimizer.zero_grad()
    out = model(data.x, data.edge_index)
    loss = F.cross_entropy(
        out[data.train_mask],
        data.y[data.train_mask]
    )
    loss.backward()
    optimizer.step()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –î–∞—Ç–∞—Å–µ—Ç—ã</h2>
    <table>
      <tr><th>–î–∞—Ç–∞—Å–µ—Ç</th><th>–£–∑–ª—ã</th><th>–ó–∞–¥–∞—á–∞</th></tr>
      <tr><td>Cora</td><td>2,708</td><td>Node class</td></tr>
      <tr><td>PubMed</td><td>19,717</td><td>Citation</td></tr>
      <tr><td>QM9</td><td>134k</td><td>Molecules</td></tr>
    </table>
    <pre><code>from torch_geometric.datasets import Planetoid

dataset = Planetoid(root='/tmp/Cora', name='Cora')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Best Practices</h2>
    <ul>
      <li>BatchNorm/LayerNorm</li>
      <li>Dropout 0.5-0.6</li>
      <li>Residual connections</li>
      <li>GAT –¥–ª—è attention</li>
      <li>GraphSAGE –¥–ª—è –±–æ–ª—å—à–∏—Ö –≥—Ä–∞—Ñ–æ–≤</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 10. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>
    <ul>
      <li>Drug discovery (–º–æ–ª–µ–∫—É–ª—ã)</li>
      <li>Social networks (—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)</li>
      <li>Traffic prediction</li>
      <li>Knowledge graphs</li>
      <li>Protein structure</li>
    </ul>
    <blockquote>
¬´GNN ‚Äî –∫–∞–∫ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≥—Ä–∞—Ñ—É: –∫–∞–∂–¥—ã–π —É–∑–µ–ª —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç —Å–æ—Å–µ–¥–µ–π –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –¥–∞–ª—å—à–µ¬ª.
    </blockquote>
  </div>

</div>
</body>
</html>
