<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      
        min-width: 900px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.82em;
      margin: 6px 0;
    }

    th {
      background-color: #e6f0ff;
      text-align: left;
      padding: 4px 6px;
      font-weight: 600;
    }

    td {
      padding: 4px 6px;
      border-bottom: 1px solid #f0f4ff;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    .good-vs-bad {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .good-vs-bad div {
      flex: 1;
      padding: 6px 8px;
      border-radius: 4px;
    }

    .good {
      background-color: #f0f9f4;
      border-left: 3px solid #2e8b57;
    }

    .bad {
      background-color: #fdf0f2;
      border-left: 3px solid #d32f2f;
    }

    .good h3, .bad h3 {
      margin: 0 0 4px;
      font-size: 1em;
      font-weight: 700;
    }

    .good ul, .bad ul {
      padding-left: 20px;
      margin: 0;
    }

    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre, table { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>‚öñÔ∏è –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –ü—Ä–æ–±–ª–µ–º–∞</h2>
    <p><strong>–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</strong> ‚Äî –∫–æ–≥–¥–∞ –æ–¥–∏–Ω –∫–ª–∞—Å—Å –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ —á–∞—â–µ –¥—Ä—É–≥–æ–≥–æ.</p>
    <ul>
      <li><strong>–ü—Ä–∏–º–µ—Ä</strong>: –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ (0.1% —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π), –±–æ–ª–µ–∑–Ω–∏ (5% –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤)</li>
      <li><strong>–ü—Ä–æ–±–ª–µ–º–∞ accuracy</strong>: –º–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å</li>
      <li><strong>Accuracy = 99%</strong> –º–æ–∂–µ—Ç –æ–∑–Ω–∞—á–∞—Ç—å –ø–æ–ª–Ω—É—é –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏</li>
      <li><strong>–ù—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏</strong> –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ—Ü–µ–Ω–∫–∏</li>
    </ul>
    <blockquote>
      –ï—Å–ª–∏ 1% —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π ‚Äî –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ, –º–æ–¥–µ–ª—å –≤—Å–µ–≥–¥–∞ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∞—è "–Ω–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ" –¥–∞—Å—Ç accuracy 99%, –Ω–æ –±—É–¥–µ—Ç –±–µ—Å–ø–æ–ª–µ–∑–Ω–æ–π!
    </blockquote>

    </div>
<div class="block">
    <h2>üî∑ 2. –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫</h2>
    <p>–û—Å–Ω–æ–≤–∞ –≤—Å–µ—Ö –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:</p>
    <table>
      <tr><th></th><th>Pred: Negative</th><th>Pred: Positive</th></tr>
      <tr><td><strong>True: Negative</strong></td><td><strong>TN</strong> (True Negative)</td><td><strong>FP</strong> (False Positive)</td></tr>
      <tr><td><strong>True: Positive</strong></td><td><strong>FN</strong> (False Negative)</td><td><strong>TP</strong> (True Positive)</td></tr>
    </table>
    <pre><code>from sklearn.metrics import confusion_matrix

y_true = [0, 1, 0, 1, 0, 1, 1, 0, 1, 0]
y_pred = [0, 1, 0, 0, 0, 1, 1, 0, 1, 0]

cm = confusion_matrix(y_true, y_pred)
print(cm)
# [[TN, FP],
#  [FN, TP]]

tn, fp, fn, tp = cm.ravel()
print(f"TP={tp}, TN={tn}, FP={fp}, FN={fn}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Precision (–¢–æ—á–Ω–æ—Å—Ç—å)</h2>
    <p><strong>Precision = TP / (TP + FP)</strong></p>
    <p><strong>–í–æ–ø—Ä–æ—Å</strong>: –∏–∑ –≤—Å–µ—Ö, –∫–æ–≥–æ –º—ã –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∏ –∫–∞–∫ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π, —Å–∫–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ?</p>
    <ul>
      <li>–í–∞–∂–Ω–æ, –∫–æ–≥–¥–∞ <strong>False Positive</strong> –¥–æ—Ä–æ–≥–æ —Å—Ç–æ—è—Ç</li>
      <li><strong>–ü—Ä–∏–º–µ—Ä</strong>: —Å–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä (–Ω–µ —Ö–æ—Ç–∏–º —É–¥–∞–ª—è—Ç—å –≤–∞–∂–Ω—ã–µ –ø–∏—Å—å–º–∞)</li>
      <li><strong>–í—ã—Å–æ–∫–∞—è precision</strong> = –º–∞–ª–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π</li>
    </ul>
    <pre><code>from sklearn.metrics import precision_score

precision = precision_score(y_true, y_pred)
print(f"Precision: {precision:.3f}")

# –î–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–∞
precision_macro = precision_score(y_true, y_pred, average='macro')
precision_weighted = precision_score(y_true, y_pred, average='weighted')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. Recall (–ü–æ–ª–Ω–æ—Ç–∞, Sensitivity)</h2>
    <p><strong>Recall = TP / (TP + FN)</strong></p>
    <p><strong>–í–æ–ø—Ä–æ—Å</strong>: –∏–∑ –≤—Å–µ—Ö –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö, —Å–∫–æ–ª—å–∫–æ –º—ã –Ω–∞—à–ª–∏?</p>
    <ul>
      <li>–í–∞–∂–Ω–æ, –∫–æ–≥–¥–∞ <strong>False Negative</strong> –¥–æ—Ä–æ–≥–æ —Å—Ç–æ—è—Ç</li>
      <li><strong>–ü—Ä–∏–º–µ—Ä</strong>: –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ä–∞–∫–∞ (–Ω–µ–ª—å–∑—è –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –±–æ–ª—å–Ω—ã—Ö)</li>
      <li><strong>–í—ã—Å–æ–∫–∏–π recall</strong> = –º–∞–ª–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤</li>
    </ul>
    <pre><code>from sklearn.metrics import recall_score

recall = recall_score(y_true, y_pred)
print(f"Recall: {recall:.3f}")

# –î–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–∞
recall_macro = recall_score(y_true, y_pred, average='macro')
recall_weighted = recall_score(y_true, y_pred, average='weighted')</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. F1-Score</h2>
    <p><strong>F1 = 2 √ó (Precision √ó Recall) / (Precision + Recall)</strong></p>
    <p>–ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–æ–µ —Å—Ä–µ–¥–Ω–µ–µ precision –∏ recall</p>
    <ul>
      <li>–ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É precision –∏ recall</li>
      <li>–£—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±–∞ —Ç–∏–ø–∞ –æ—à–∏–±–æ–∫</li>
      <li><strong>–ò–¥–µ–∞–ª–µ–Ω –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</strong></li>
      <li>F1 = 1 ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ, F1 = 0 ‚Äî –ø–ª–æ—Ö–æ</li>
    </ul>
    <pre><code>from sklearn.metrics import f1_score

f1 = f1_score(y_true, y_pred)
print(f"F1-Score: {f1:.3f}")

# –î–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–∞
f1_macro = f1_score(y_true, y_pred, average='macro')
f1_weighted = f1_score(y_true, y_pred, average='weighted')
f1_micro = f1_score(y_true, y_pred, average='micro')

print(f"F1 macro: {f1_macro:.3f}")
print(f"F1 weighted: {f1_weighted:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. F-beta Score</h2>
    <p><strong>F_Œ≤ = (1 + Œ≤¬≤) √ó (Precision √ó Recall) / (Œ≤¬≤ √ó Precision + Recall)</strong></p>
    <p>–í–∑–≤–µ—à–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è F1, –≥–¥–µ Œ≤ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å recall:</p>
    <ul>
      <li><strong>Œ≤ < 1</strong>: –±–æ–ª—å—à–∏–π –≤–µ—Å –Ω–∞ precision</li>
      <li><strong>Œ≤ = 1</strong>: F1-score (—Ä–∞–≤–Ω—ã–π –≤–µ—Å)</li>
      <li><strong>Œ≤ > 1</strong>: –±–æ–ª—å—à–∏–π –≤–µ—Å –Ω–∞ recall</li>
      <li><strong>F2-score</strong> (Œ≤=2): recall –≤ 2 —Ä–∞–∑–∞ –≤–∞–∂–Ω–µ–µ precision</li>
      <li><strong>F0.5-score</strong> (Œ≤=0.5): precision –≤ 2 —Ä–∞–∑–∞ –≤–∞–∂–Ω–µ–µ recall</li>
    </ul>
    <pre><code>from sklearn.metrics import fbeta_score

# Recall –≤–∞–∂–Ω–µ–µ (–º–µ–¥–∏—Ü–∏–Ω–∞)
f2 = fbeta_score(y_true, y_pred, beta=2)
print(f"F2-Score: {f2:.3f}")

# Precision –≤–∞–∂–Ω–µ–µ (—Å–ø–∞–º-—Ñ–∏–ª—å—Ç—Ä)
f05 = fbeta_score(y_true, y_pred, beta=0.5)
print(f"F0.5-Score: {f05:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. ROC-AUC</h2>
    <p><strong>Area Under ROC Curve</strong> ‚Äî –ø–ª–æ—â–∞–¥—å –ø–æ–¥ ROC-–∫—Ä–∏–≤–æ–π</p>
    <ul>
      <li>–ò–∑–º–µ—Ä—è–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Ä–∞–∑–ª–∏—á–∞—Ç—å –∫–ª–∞—Å—Å—ã</li>
      <li><strong>AUC = 1</strong>: –∏–¥–µ–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å</li>
      <li><strong>AUC = 0.5</strong>: —Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ</li>
      <li><strong>AUC < 0.5</strong>: –º–æ–¥–µ–ª—å —Ö—É–∂–µ —Å–ª—É—á–∞–π–Ω–æ–π</li>
      <li>–£—Å—Ç–æ–π—á–∏–≤–∞ –∫ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏</li>
      <li>–¢—Ä–µ–±—É–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π, –Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π</li>
    </ul>
    <pre><code>from sklearn.metrics import roc_auc_score, roc_curve
import matplotlib.pyplot as plt

# –ù—É–∂–Ω—ã –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, –Ω–µ labels
y_proba = model.predict_proba(X_test)[:, 1]

auc = roc_auc_score(y_true, y_proba)
print(f"ROC-AUC: {auc:.3f}")

# ROC-–∫—Ä–∏–≤–∞—è
fpr, tpr, thresholds = roc_curve(y_true, y_proba)
plt.plot(fpr, tpr, label=f'AUC = {auc:.3f}')
plt.plot([0, 1], [0, 1], 'k--', label='Random')
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('ROC Curve')
plt.legend()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. PR-AUC (Precision-Recall AUC)</h2>
    <p><strong>Area Under Precision-Recall Curve</strong></p>
    <ul>
      <li><strong>–õ—É—á—à–µ ROC-AUC</strong> –¥–ª—è —Å–∏–ª—å–Ω–æ –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
      <li>–§–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ</li>
      <li>–ë–æ–ª–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞ –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º</li>
      <li><strong>Baseline</strong>: –¥–æ–ª—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞</li>
    </ul>
    <pre><code>from sklearn.metrics import precision_recall_curve, auc, average_precision_score

y_proba = model.predict_proba(X_test)[:, 1]

# Average Precision Score (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞)
ap = average_precision_score(y_true, y_proba)
print(f"Average Precision: {ap:.3f}")

# PR-AUC –≤—Ä—É—á–Ω—É—é
precision, recall, thresholds = precision_recall_curve(y_true, y_proba)
pr_auc = auc(recall, precision)
print(f"PR-AUC: {pr_auc:.3f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
plt.plot(recall, precision, label=f'AP = {ap:.3f}')
plt.xlabel('Recall')
plt.ylabel('Precision')
plt.title('Precision-Recall Curve')
plt.legend()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Balanced Accuracy</h2>
    <p><strong>Balanced Accuracy = (TPR + TNR) / 2</strong></p>
    <p>–°—Ä–µ–¥–Ω–µ–µ –º–µ–∂–¥—É sensitivity –∏ specificity</p>
    <ul>
      <li>–£—á–∏—Ç—ã–≤–∞–µ—Ç –æ–±–∞ –∫–ª–∞—Å—Å–∞ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ</li>
      <li>–ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ –∫–ª–∞—Å—Å–æ–≤</li>
      <li>–î–∏–∞–ø–∞–∑–æ–Ω [0, 1]</li>
      <li><strong>0.5</strong> = —Å–ª—É—á–∞–π–Ω–æ–µ —É–≥–∞–¥—ã–≤–∞–Ω–∏–µ</li>
    </ul>
    <pre><code>from sklearn.metrics import balanced_accuracy_score

ba = balanced_accuracy_score(y_true, y_pred)
print(f"Balanced Accuracy: {ba:.3f}")

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –æ–±—ã—á–Ω–æ–π accuracy
from sklearn.metrics import accuracy_score
acc = accuracy_score(y_true, y_pred)
print(f"Regular Accuracy: {acc:.3f}")
print(f"Balanced Accuracy: {ba:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Cohen's Kappa</h2>
    <p>–ò–∑–º–µ—Ä—è–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, —É—á–∏—Ç—ã–≤–∞—è —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ</p>
    <ul>
      <li><strong>Œ∫ = 1</strong>: –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ</li>
      <li><strong>Œ∫ = 0</strong>: —Å–ª—É—á–∞–π–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ</li>
      <li><strong>Œ∫ < 0</strong>: —Ö—É–∂–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ</li>
      <li>–£—á–∏—Ç—ã–≤–∞–µ—Ç –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤</li>
      <li>–ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –º–µ—Ç—Ä–∏–∫–∞ —á–µ–º accuracy</li>
    </ul>
    <pre><code>from sklearn.metrics import cohen_kappa_score

kappa = cohen_kappa_score(y_true, y_pred)
print(f"Cohen's Kappa: {kappa:.3f}")

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
if kappa < 0:
    print("–•—É–∂–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ")
elif kappa < 0.2:
    print("–û—á–µ–Ω—å —Å–ª–∞–±–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ")
elif kappa < 0.4:
    print("–°–ª–∞–±–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ")
elif kappa < 0.6:
    print("–£–º–µ—Ä–µ–Ω–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ")
elif kappa < 0.8:
    print("–°–∏–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ")
else:
    print("–ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. Matthews Correlation Coefficient (MCC)</h2>
    <p><strong>MCC</strong> = –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –∏ –∏—Å—Ç–∏–Ω–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏</p>
    <ul>
      <li>–î–∏–∞–ø–∞–∑–æ–Ω [-1, 1]</li>
      <li><strong>+1</strong>: –∏–¥–µ–∞–ª—å–Ω–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ</li>
      <li><strong>0</strong>: —Å–ª—É—á–∞–π–Ω–æ–µ</li>
      <li><strong>-1</strong>: –ø–æ–ª–Ω–∞—è –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–æ—Å—Ç—å</li>
      <li>–£—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ 4 –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ confusion matrix</li>
      <li><strong>–û–¥–Ω–∞ –∏–∑ –ª—É—á—à–∏—Ö –º–µ—Ç—Ä–∏–∫</strong> –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
    </ul>
    <pre><code>from sklearn.metrics import matthews_corrcoef

mcc = matthews_corrcoef(y_true, y_pred)
print(f"Matthews Correlation Coefficient: {mcc:.3f}")

# MCC –º–æ–∂–Ω–æ –≤—ã—á–∏—Å–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é:
# MCC = (TP*TN - FP*FN) / sqrt((TP+FP)*(TP+FN)*(TN+FP)*(TN+FN))
tn, fp, fn, tp = confusion_matrix(y_true, y_pred).ravel()
mcc_manual = (tp*tn - fp*fn) / np.sqrt((tp+fp)*(tp+fn)*(tn+fp)*(tn+fn))
print(f"MCC (manual): {mcc_manual:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. Specificity –∏ Sensitivity</h2>
    <p><strong>Sensitivity (Recall, TPR)</strong> = TP / (TP + FN)</p>
    <p><strong>Specificity (TNR)</strong> = TN / (TN + FP)</p>
    <ul>
      <li><strong>Sensitivity</strong>: –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –Ω–∞—Ö–æ–¥–∏–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ</li>
      <li><strong>Specificity</strong>: –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –Ω–∞—Ö–æ–¥–∏–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ</li>
      <li>–û–±–µ –≤–∞–∂–Ω—ã –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
    </ul>
    <pre><code>from sklearn.metrics import confusion_matrix

tn, fp, fn, tp = confusion_matrix(y_true, y_pred).ravel()

sensitivity = tp / (tp + fn)  # = recall
specificity = tn / (tn + fp)

print(f"Sensitivity (TPR): {sensitivity:.3f}")
print(f"Specificity (TNR): {specificity:.3f}")
print(f"False Positive Rate: {1 - specificity:.3f}")
print(f"False Negative Rate: {1 - sensitivity:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 13. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫</h2>
    <table>
      <tr><th>–ú–µ—Ç—Ä–∏–∫–∞</th><th>–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</th><th>–î–∏–∞–ø–∞–∑–æ–Ω</th></tr>
      <tr><td><strong>Accuracy</strong></td><td>‚ùå –ù–ï –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö</td><td>[0, 1]</td></tr>
      <tr><td><strong>Precision</strong></td><td>FP –¥–æ—Ä–æ–≥–æ (—Å–ø–∞–º)</td><td>[0, 1]</td></tr>
      <tr><td><strong>Recall</strong></td><td>FN –¥–æ—Ä–æ–≥–æ (–±–æ–ª–µ–∑–Ω–∏)</td><td>[0, 1]</td></tr>
      <tr><td><strong>F1</strong></td><td>‚úÖ –ë–∞–ª–∞–Ω—Å precision/recall</td><td>[0, 1]</td></tr>
      <tr><td><strong>ROC-AUC</strong></td><td>–°—Ä–µ–¥–Ω–∏–π –¥–∏—Å–±–∞–ª–∞–Ω—Å</td><td>[0, 1]</td></tr>
      <tr><td><strong>PR-AUC</strong></td><td>‚úÖ –°–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å</td><td>[0, 1]</td></tr>
      <tr><td><strong>MCC</strong></td><td>‚úÖ –õ—é–±–æ–π –¥–∏—Å–±–∞–ª–∞–Ω—Å</td><td>[-1, 1]</td></tr>
      <tr><td><strong>Balanced Accuracy</strong></td><td>‚úÖ –ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ</td><td>[0, 1]</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 14. –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç</h2>
    <pre><code>from sklearn.metrics import classification_report

# –ü–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º
report = classification_report(y_true, y_pred)
print(report)

# –í—ã–≤–æ–¥:
#               precision    recall  f1-score   support
#
#            0       0.88      0.94      0.91       100
#            1       0.75      0.60      0.67        30
#
#     accuracy                           0.85       130
#    macro avg       0.82      0.77      0.79       130
# weighted avg       0.85      0.85      0.84       130

# –í –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è
report_dict = classification_report(y_true, y_pred, output_dict=True)
print(f"Class 1 F1: {report_dict['1']['f1-score']:.3f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 15. –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞</h2>
    <p>–î–ª—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:</p>
    <pre><code>from sklearn.metrics import precision_recall_curve

y_proba = model.predict_proba(X_test)[:, 1]
precision, recall, thresholds = precision_recall_curve(y_true, y_proba)

# –ù–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥
# –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ F1
f1_scores = 2 * (precision * recall) / (precision + recall)
optimal_idx = np.argmax(f1_scores)
optimal_threshold = thresholds[optimal_idx]

print(f"Optimal threshold: {optimal_threshold:.3f}")
print(f"Precision: {precision[optimal_idx]:.3f}")
print(f"Recall: {recall[optimal_idx]:.3f}")
print(f"F1: {f1_scores[optimal_idx]:.3f}")

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–æ—Ä–æ–≥
y_pred_custom = (y_proba >= optimal_threshold).astype(int)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 16. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä</h2>
    <pre><code>import numpy as np
from sklearn.metrics import *

def evaluate_imbalanced(y_true, y_pred, y_proba=None):
    """–ü–æ–ª–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö"""
    
    print("=" * 50)
    print("–û–¶–ï–ù–ö–ê –ú–û–î–ï–õ–ò –ù–ê –ù–ï–°–ë–ê–õ–ê–ù–°–ò–†–û–í–ê–ù–ù–´–• –î–ê–ù–ù–´–•")
    print("=" * 50)
    
    # –ë–∞–∑–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
    print(f"
Accuracy: {accuracy_score(y_true, y_pred):.3f}")
    print(f"Balanced Accuracy: {balanced_accuracy_score(y_true, y_pred):.3f}")
    
    # Precision, Recall, F1
    print(f"
Precision: {precision_score(y_true, y_pred):.3f}")
    print(f"Recall: {recall_score(y_true, y_pred):.3f}")
    print(f"F1-Score: {f1_score(y_true, y_pred):.3f}")
    
    # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ
    print(f"
MCC: {matthews_corrcoef(y_true, y_pred):.3f}")
    print(f"Cohen's Kappa: {cohen_kappa_score(y_true, y_pred):.3f}")
    
    # AUC –º–µ—Ç—Ä–∏–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏)
    if y_proba is not None:
        print(f"
ROC-AUC: {roc_auc_score(y_true, y_proba):.3f}")
        print(f"PR-AUC: {average_precision_score(y_true, y_proba):.3f}")
    
    # Confusion matrix
    print("
Confusion Matrix:")
    print(confusion_matrix(y_true, y_pred))
    
    # –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
    print("
" + classification_report(y_true, y_pred))

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
evaluate_imbalanced(y_test, y_pred, y_proba)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 17. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] <strong>–ù–ï</strong> –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å accuracy –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—É—é –º–µ—Ç—Ä–∏–∫—É</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∏—Å–±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å F1, PR-AUC –∏–ª–∏ MCC</li>
      <li>[ ] –°–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ Precision –∏ Recall –æ—Ç–¥–µ–ª—å–Ω–æ</li>
      <li>[ ] –ü–æ—Å—Ç—Ä–æ–∏—Ç—å ROC –∏ PR –∫—Ä–∏–≤—ã–µ</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Confusion Matrix</li>
      <li>[ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Balanced Accuracy</li>
      <li>[ ] –°—Ä–∞–≤–Ω–∏—Ç—å —Å baseline (–≤—Å–µ–≥–¥–∞ –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å)</li>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å –º–µ—Ç—Ä–∏–∫—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∏</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´–ö–æ–≥–¥–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ 1 —Å–ª—É—á–∞–µ –∏–∑ 100, –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç "–Ω–µ—Ç –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞", –±—É–¥–µ—Ç –ø—Ä–∞–≤–∞ –≤ 99% —Å–ª—É—á–∞–µ–≤. –ù–æ –æ–Ω–∞ –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞! –ù–∞–º –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —É—á–∏—Ç—ã–≤–∞—é—Ç —Ä–µ–¥–∫–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è –∏ —à—Ç—Ä–∞—Ñ—É—é—Ç –∑–∞ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏¬ª.
    </blockquote>
  </div>



</div>
</body>
</html>
