<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Isolation Forest Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
<style>@media screen{body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Helvetica,Arial,sans-serif;color:#333;background:#fafcff;padding:10px
        min-width: 900px;
      }}@media print{body{background:white;padding:0}@page{size:A4 landscape;margin:10mm}}    .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }.block{break-inside:avoid;margin-bottom:1.2em;padding:12px;background:white;border-radius:6px;box-shadow:0 1px 3px rgba(0,0,0,0.05)}h1{font-size:1.6em;font-weight:700;color:#1a5fb4;text-align:center;margin:0 0 8px;column-span:all}.subtitle{text-align:center;color:#666;font-size:0.9em;margin-bottom:12px;column-span:all}h2{font-size:1.15em;font-weight:700;color:#1a5fb4;margin:0 0 8px;padding-bottom:4px;border-bottom:1px solid #e0e7ff}p,ul,ol{font-size:0.92em;margin:0.6em 0}ul,ol{padding-left:18px}li{margin-bottom:4px}code{font-family:'Consolas','Courier New',monospace;background-color:#f0f4ff;padding:1px 4px;border-radius:3px;font-size:0.88em}pre{background-color:#f0f4ff;padding:8px;border-radius:4px;overflow-x:auto;font-size:0.84em;margin:6px 0}pre code{padding:0;background:none;white-space:pre-wrap}table{width:100%;border-collapse:collapse;font-size:0.82em;margin:6px 0}th{background-color:#e6f0ff;text-align:left;padding:4px 6px;font-weight:600}td{padding:4px 6px;border-bottom:1px solid #f0f4ff}tr:nth-child(even){background-color:#f8fbff}.good-vs-bad{display:flex;flex-direction:column;gap:8px}.good-vs-bad div{flex:1;padding:6px 8px;border-radius:4px}.good{background-color:#f0f9f4;border-left:3px solid #2e8b57}.bad{background-color:#fdf0f2;border-left:3px solid #d32f2f}.good h3,.bad h3{margin:0 0 4px;font-size:1em;font-weight:700}.good ul,.bad ul{padding-left:20px;margin:0}.good li::before{content:"‚úÖ ";font-weight:bold}.bad li::before{content:"‚ùå ";font-weight:bold}blockquote{font-style:italic;margin:8px 0;padding:6px 10px;background:#f8fbff;border-left:2px solid #1a5fb4;font-size:0.88em}a{color:#1a5fb4;text-decoration:none}a:hover{text-decoration:underline}@media print{.container{column-gap:12px}.block{box-shadow:none}code,pre,table{font-size:0.78em}h1{font-size:1.4em}h2{font-size:1em}}</style>
</head>
<body>
<div class="container">
<h1>üå≤ Isolation Forest</h1>
<div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>
<div class="block">
<h2>üî∑ 1. –°—É—Ç—å</h2>
<ul>
<li><strong>–ê–ª–≥–æ—Ä–∏—Ç–º</strong>: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π —á–µ—Ä–µ–∑ –∏–∑–æ–ª—è—Ü–∏—é</li>
<li><strong>–ü—Ä–∏–Ω—Ü–∏–ø</strong>: –∞–Ω–æ–º–∞–ª–∏–∏ –ª–µ–≥—á–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å –æ—Ç –Ω–æ—Ä–º—ã</li>
<li><strong>–ú–µ—Ç–æ–¥</strong>: —Å–ª—É—á–∞–π–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è —Ä–∞–∑–±–∏–µ–Ω–∏—è</li>
<li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: fraud detection, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º</li>
</ul>
  </div>
<div class="block">
<h2>üî∑ 2. –ë–∞–∑–æ–≤—ã–π –∫–æ–¥</h2>
<pre><code>from sklearn.ensemble import IsolationForest
import numpy as np

# –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
iso = IsolationForest(
    n_estimators=100,
    contamination=0.1,  # % –∞–Ω–æ–º–∞–ª–∏–π
    random_state=42
)

# –û–±—É—á–µ–Ω–∏–µ
iso.fit(X)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
predictions = iso.predict(X)
# 1 = normal, -1 = anomaly

# Scores (—á–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –∞–Ω–æ–º–∞–ª—å–Ω–µ–µ)
scores = iso.score_samples(X)

# –ù–∞–π—Ç–∏ –∞–Ω–æ–º–∞–ª–∏–∏
anomalies = X[predictions == -1]
print(f"–ù–∞–π–¥–µ–Ω–æ –∞–Ω–æ–º–∞–ª–∏–π: {len(anomalies)}")</code></pre>
</div>
<div class="block">
<h2>üî∑ 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
<table>
<tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–ó–Ω–∞—á–µ–Ω–∏—è</th></tr>
<tr><td><code>n_estimators</code></td><td>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ—Ä–µ–≤—å–µ–≤</td><td>100-500</td></tr>
<tr><td><code>contamination</code></td><td>–î–æ–ª—è –∞–Ω–æ–º–∞–ª–∏–π</td><td>0.01-0.5</td></tr>
<tr><td><code>max_samples</code></td><td>–†–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏</td><td>'auto'/int</td></tr>
<tr><td><code>max_features</code></td><td>–ü—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ –¥–µ—Ä–µ–≤–æ</td><td>1.0/int</td></tr>
<tr><td><code>bootstrap</code></td><td>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å bootstrap</td><td>False</td></tr>
</table>
</div>
<div class="block">
<h2>üî∑ 4. –í—ã–±–æ—Ä contamination</h2>
<pre><code># –ï—Å–ª–∏ –∑–Ω–∞–µ–º –ø—Ä–∏–º–µ—Ä–Ω—É—é –¥–æ–ª—é –∞–Ω–æ–º–∞–ª–∏–π
iso = IsolationForest(contamination=0.05)  # 5%

# –ê–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
iso = IsolationForest(contamination='auto')

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
contaminations = [0.01, 0.05, 0.1, 0.2]
for cont in contaminations:
    iso = IsolationForest(contamination=cont)
    predictions = iso.fit_predict(X)
    n_anomalies = (predictions == -1).sum()
    print(f"contamination={cont}: {n_anomalies} –∞–Ω–æ–º–∞–ª–∏–π")</code></pre>
</div>
<div class="block">
<h2>üî∑ 5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è</h2>
<pre><code>import matplotlib.pyplot as plt

# –ü–æ–ª—É—á–∏—Ç—å scores
scores = iso.score_samples(X)
predictions = iso.predict(X)

# –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ scores
plt.figure(figsize=(10, 6))
plt.hist(scores[predictions == 1], bins=50, 
         alpha=0.6, label='Normal')
plt.hist(scores[predictions == -1], bins=50, 
         alpha=0.6, label='Anomaly')
plt.xlabel('Anomaly Score')
plt.ylabel('Count')
plt.legend()
plt.title('Isolation Forest Scores')
plt.show()

# 2D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
if X.shape[1] == 2:
    plt.scatter(X[:, 0], X[:, 1], 
                c=predictions, cmap='coolwarm')
    plt.title('Anomaly Detection')
    plt.show()</code></pre>
</div>
<div class="block">
<h2>üî∑ 6. –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</h2>
<pre><code># –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
iso = IsolationForest(
    n_estimators=100,
    max_samples=256,  # –≤–º–µ—Å—Ç–æ 'auto'
    random_state=42
)

# max_samples –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä –≤—ã–±–æ—Ä–∫–∏
# –ú–µ–Ω—å—à–µ = –±—ã—Å—Ç—Ä–µ–µ, –Ω–æ –º–µ–Ω–µ–µ —Ç–æ—á–Ω–æ
# 256 - —Ö–æ—Ä–æ—à–∏–π –±–∞–ª–∞–Ω—Å

# –î–ª—è –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
iso = IsolationForest(
    n_estimators=100,
    max_samples=100,
    n_jobs=-1  # –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —è–¥—Ä–∞
)
iso.fit(X)</code></pre>
</div>
<div class="block">
<h2>üî∑ 7. –û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h2>
<pre><code># –ï—Å–ª–∏ –µ—Å—Ç—å –º–µ—Ç–∫–∏ (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix

# –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –º–µ—Ç–∫–∏: -1 -> 0, 1 -> 1
y_pred = (predictions == 1).astype(int)

# –û—Ç—á–µ—Ç
print(classification_report(y_true, y_pred))

# Confusion matrix
cm = confusion_matrix(y_true, y_pred)
print(cm)

# Precision/Recall –¥–ª—è –∞–Ω–æ–º–∞–ª–∏–π
from sklearn.metrics import precision_recall_curve
precision, recall, _ = precision_recall_curve(y_true, -scores)

plt.plot(recall, precision)
plt.xlabel('Recall')
plt.ylabel('Precision')
plt.title('Precision-Recall Curve')
plt.show()</code></pre>
</div>
<div class="block">
<h2>üî∑ 8. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö</h2>
<pre><code>from sklearn.preprocessing import StandardScaler

# –í–ê–ñ–ù–û: –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ!
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)

# –ó–∞—Ç–µ–º Isolation Forest
iso = IsolationForest(random_state=42)
predictions = iso.fit_predict(X_scaled)

# –ü–æ—á–µ–º—É –≤–∞–∂–Ω–æ:
# IF —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –º–∞—Å—à—Ç–∞–±—É –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# –ü—Ä–∏–∑–Ω–∞–∫–∏ —Å –±–æ–ª—å—à–∏–º –¥–∏–∞–ø–∞–∑–æ–Ω–æ–º –¥–æ–º–∏–Ω–∏—Ä—É—é—Ç</code></pre>
</div>
<div class="block">
<h2>üî∑ 9. Online detection</h2>
<pre><code># –û–±—É—á–∏—Ç—å –Ω–∞ "–Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö" –¥–∞–Ω–Ω—ã—Ö
iso = IsolationForest(contamination=0.1)
iso.fit(X_train)

# –ü—Ä–∏–º–µ–Ω—è—Ç—å –∫ –Ω–æ–≤—ã–º –¥–∞–Ω–Ω—ã–º
def check_new_data(new_samples):
    predictions = iso.predict(new_samples)
    scores = iso.score_samples(new_samples)
    
    anomalies = new_samples[predictions == -1]
    
    if len(anomalies) > 0:
        print(f"‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ {len(anomalies)} –∞–Ω–æ–º–∞–ª–∏–π!")
        print(f"Scores: {scores[predictions == -1]}")
    
    return predictions, scores

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
new_data = np.array([[...]])
predictions, scores = check_new_data(new_data)</code></pre>
</div>
<div class="block">
<h2>üî∑ 10. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
<div class="good-vs-bad">
<div class="good">
<h3>‚úÖ –•–æ—Ä–æ—à–æ</h3>
<ul>
<li>–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∞–Ω–æ–º–∞–ª–∏–π</li>
<li>Fraud detection</li>
<li>–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–∏—Å—Ç–µ–º</li>
<li>Outlier detection</li>
<li>Unsupervised –∑–∞–¥–∞—á–∏</li>
</ul>
</div>
<div class="bad">
<h3>‚ùå –ü–ª–æ—Ö–æ</h3>
<ul>
<li>–ú–∞–ª—ã–µ –¥–∞–Ω–Ω—ã–µ (<100)</li>
<li>–í—Å–µ –¥–∞–Ω–Ω—ã–µ - –∞–Ω–æ–º–∞–ª–∏–∏</li>
<li>–ù—É–∂–Ω–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</li>
<li>–°–∏–ª—å–Ω–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</li>
</ul>
</div>
</div>
<div class="block">
<h2>üî∑ 11. –ß–µ–∫-–ª–∏—Å—Ç</h2>
<ul>
<li>[ ] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (StandardScaler)</li>
<li>[ ] –í—ã–±—Ä–∞—Ç—å contamination (–µ—Å–ª–∏ –∏–∑–≤–µ—Å—Ç–Ω–æ)</li>
<li>[ ] –û–±—É—á–∏—Ç—å –Ω–∞ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö</li>
<li>[ ] –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å scores</li>
<li>[ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å n_estimators –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
<li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å n_jobs –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è</li>
</ul>
<blockquote>
¬´Isolation Forest –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–æ–º–∞–ª–∏–∏, –∏–∑–æ–ª–∏—Ä—É—è –Ω–µ–æ–±—ã—á–Ω—ã–µ —Ç–æ—á–∫–∏. –ö–∞–∫ –Ω–∞–π—Ç–∏ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —è–±–ª–æ–∫–æ —Å—Ä–µ–¥–∏ –∞–ø–µ–ª—å—Å–∏–Ω–æ–≤ ‚Äî –µ–≥–æ –ª–µ–≥—á–µ –æ—Ç–¥–µ–ª–∏—Ç—å, —á–µ–º –æ–±—ã—á–Ω—ã–π –∞–ø–µ–ª—å—Å–∏–Ω –æ—Ç –¥—Ä—É–≥–∏—Ö –∞–ø–µ–ª—å—Å–∏–Ω–æ–≤¬ª.
</blockquote>
</div>
<div class="block">
<h2>üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏</h2>
<ul>
<li><a href="https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html" target="_blank">üìö Sklearn –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a></li>
<li><a href="https://cs.nju.edu.cn/zhouzh/zhouzh.files/publication/icdm08b.pdf" target="_blank">üìÑ –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç—å—è</a></li>
<li><a href="https://towardsdatascience.com/outlier-detection-with-isolation-forest-3d190448d45e" target="_blank">üìñ Towards Data Science tutorial</a></li>
<li><a href="https://www.youtube.com/watch?v=5p8B2Ikcw-k" target="_blank">üé• Isolation Forest explained</a></li>
<li><a href="https://github.com/topics/isolation-forest" target="_blank">üíª GitHub –ø—Ä–∏–º–µ—Ä—ã</a></li>
</ul>
</div>
</div>
</div>
</body>
</html>