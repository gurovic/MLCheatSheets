<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>üîç HDBSCAN Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
    .container { column-count: 3; column-gap: 20px; max-width: 100%; }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
    .good-vs-bad { display: flex; flex-direction: column; gap: 8px; }
    .good-vs-bad div { flex: 1; padding: 6px 8px; border-radius: 4px; }
    .good { background-color: #f0f9f4; border-left: 3px solid #2e8b57; }
    .bad { background-color: #fdf0f2; border-left: 3px solid #d32f2f; }
    .good h3, .bad h3 { margin: 0 0 4px; font-size: 1em; font-weight: 700; }
    .good ul, .bad ul { padding-left: 20px; margin: 0; }
    .good li::before { content: "‚úÖ "; font-weight: bold; }
    .bad li::before { content: "‚ùå "; font-weight: bold; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
    @media print { .container { column-gap: 12px; } .block { box-shadow: none; } code, pre, table { font-size: 0.78em; } h1 { font-size: 1.4em; } h2 { font-size: 1em; } }
  </style>
</head>
<body>
<div class="container">
  <h1>üîç HDBSCAN</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>
  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å –º–µ—Ç–æ–¥–∞</h2>
    <ul>
      <li><strong>–£–ª—É—á—à–µ–Ω–∏–µ DBSCAN</strong>: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ —Ä–∞–∑–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏</li>
      <li><strong>–ò–µ—Ä–∞—Ä—Ö–∏—è</strong>: —Å—Ç—Ä–æ–∏—Ç –¥–µ—Ä–µ–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏</li>
      <li><strong>–ê–≤—Ç–æ –≤—ã–±–æ—Ä –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</strong>: —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã</li>
      <li><strong>–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å</strong>: –æ–¥–∏–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä (min_cluster_size) –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö (eps, min_samples)</li>
      <li><strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ —à—É–º–∞</strong>: —Ç–æ—á–∫–∏ —Å –Ω–∏–∑–∫–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç—å—é –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ –≤—ã–±—Ä–æ—Å—ã (-1)</li>
    </ul>  </div>

  <div class="block">
    <h2>üî∑ 2. –ë–∞–∑–æ–≤—ã–π –∫–æ–¥</h2>
    <pre><code>import hdbscan
import numpy as np

# –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
clusterer = hdbscan.HDBSCAN(
    min_cluster_size=5,
    min_samples=None,
    metric='euclidean'
)
labels = clusterer.fit_predict(X)

# –ü–æ–ª—É—á–∏—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
probs = clusterer.probabilities_

# –ò–µ—Ä–∞—Ä—Ö–∏—è
condensed_tree = clusterer.condensed_tree_
single_linkage_tree = clusterer.single_linkage_tree_

print(f"–ö–ª–∞—Å—Ç–µ—Ä–æ–≤: {len(set(labels)) - (1 if -1 in labels else 0)}")
print(f"–®—É–º: {list(labels).count(-1)} —Ç–æ—á–µ–∫")</code></pre>  </div>

  <div class="block">
    <h2>üî∑ 3. –ö–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–°–æ–≤–µ—Ç</th></tr>
      <tr><td><code>min_cluster_size</code></td><td>–ú–∏–Ω —Ä–∞–∑–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞</td><td>5-15 –æ–±—ã—á–Ω–æ</td></tr>
      <tr><td><code>min_samples</code></td><td>–ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ—Å—Ç—å</td><td>None = min_cluster_size</td></tr>
      <tr><td><code>metric</code></td><td>–ú–µ—Ç—Ä–∏–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</td><td>'euclidean', 'manhattan', 'cosine'</td></tr>
      <tr><td><code>cluster_selection_epsilon</code></td><td>–ü–æ—Ä–æ–≥ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</td><td>0.0 (–∞–≤—Ç–æ) –∏–ª–∏ > 0</td></tr>
      <tr><td><code>cluster_selection_method</code></td><td>–ú–µ—Ç–æ–¥ –≤—ã–±–æ—Ä–∞</td><td>'eom' (excess of mass) –∏–ª–∏ 'leaf'</td></tr>
    </table>  </div>

  <div class="block">
    <h2>üî∑ 4. –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã</h2>
    <ol>
      <li><strong>Mutual reachability distance</strong>: d_mreach(a,b) = max(core_k(a), core_k(b), d(a,b))</li>
      <li><strong>MST</strong>: –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –æ—Å—Ç–æ–≤–Ω–æ–µ –¥–µ—Ä–µ–≤–æ</li>
      <li><strong>Single linkage tree</strong>: –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –∏–∑ MST</li>
      <li><strong>Condensed tree</strong>: —É–±—Ä–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã —Ä–∞–∑–º–µ—Ä–æ–º < min_cluster_size</li>
      <li><strong>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</strong>: –≤—ã–±—Ä–∞—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã (–ø–æ persistence)</li>
    </ol>
    <p><strong>–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–∞</strong>: Œ£(Œª_death - Œª_birth) –¥–ª—è –≤—Å–µ—Ö —Ç–æ—á–µ–∫</p>  </div>

  <div class="block">
    <h2>üî∑ 5. –í—ã–±–æ—Ä min_cluster_size</h2>
    <pre><code># –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏
from sklearn.metrics import silhouette_score

sizes = [5, 10, 15, 20, 30]
results = []

for size in sizes:
    clusterer = hdbscan.HDBSCAN(min_cluster_size=size)
    labels = clusterer.fit_predict(X)
    
    # –£–±—Ä–∞—Ç—å —à—É–º –¥–ª—è –º–µ—Ç—Ä–∏–∫–∏
    mask = labels != -1
    if len(set(labels[mask])) > 1:
        score = silhouette_score(X[mask], labels[mask])
        results.append((size, score, len(set(labels)) - 1))
        print(f"Size={size}: clusters={len(set(labels))-1}, score={score:.3f}")

# –í—ã–±—Ä–∞—Ç—å –ª—É—á—à–∏–π
best = max(results, key=lambda x: x[1])</code></pre>  </div>

  <div class="block">
    <h2>üî∑ 6. –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</h2>
    <div class="good-vs-bad">
      <div class="good">
        <h3>‚úÖ –•–æ—Ä–æ—à–æ</h3>
        <ul>
          <li>–ö–ª–∞—Å—Ç–µ—Ä—ã —Ä–∞–∑–Ω–æ–π –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏</li>
          <li>–ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–µ —Ñ–æ—Ä–º—ã</li>
          <li>–ú–Ω–æ–≥–æ —à—É–º–∞ –∏ –≤—ã–±—Ä–æ—Å–æ–≤</li>
          <li>–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</li>
          <li>–ù—É–∂–Ω–∞ –∏–µ—Ä–∞—Ä—Ö–∏—è</li>
        </ul>
      </div>
      <div class="bad">
        <h3>‚ùå –ü–ª–æ—Ö–æ</h3>
        <ul>
          <li>–û—á–µ–Ω—å –±–æ–ª—å—à–∏–µ –¥–∞–Ω–Ω—ã–µ (&gt;1M)</li>
          <li>–í—ã—Å–æ–∫–∞—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å (&gt;50)</li>
          <li>–í—Å–µ —Ç–æ—á–∫–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ (–Ω–µ—Ç —à—É–º–∞)</li>
          <li>–ù—É–∂–Ω–∞ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞</li>
        </ul>
      </div>
    </div>  </div>

  <div class="block">
    <h2>üî∑ 7. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞</h2>
    <p>‚úÖ <strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ</strong></p>
    <pre><code>from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
X_scaled = scaler.fit_transform(X)</code></pre>
    <p>‚úÖ <strong>–°–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏</strong>: UMAP –∏–ª–∏ PCA –¥–ª—è &gt;20 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</p>
    <p>‚úÖ <strong>–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–±—Ä–æ—Å–æ–≤ –Ω–µ –Ω—É–∂–Ω–∞</strong>: HDBSCAN —Å–∞–º –∏—Ö –Ω–∞—Ö–æ–¥–∏—Ç</p>  </div>

  <div class="block">
    <h2>üî∑ 8. –ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è</h2>
    <table>
      <tr><th>–ü—Ä–æ–±–ª–µ–º–∞</th><th>–†–µ—à–µ–Ω–∏–µ</th></tr>
      <tr><td>–í—Å–µ —Ç–æ—á–∫–∏ ‚Äî —à—É–º</td><td>–£–º–µ–Ω—å—à–∏—Ç—å min_cluster_size, —É–≤–µ–ª–∏—á–∏—Ç—å min_samples</td></tr>
      <tr><td>–û–¥–∏–Ω –±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Ç–µ—Ä</td><td>–£–º–µ–Ω—å—à–∏—Ç—å min_cluster_size</td></tr>
      <tr><td>–ú–µ–¥–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞</td><td>Approx nearest neighbors, PCA, –ø–æ–¥–≤—ã–±–æ—Ä–∫–∞</td></tr>
      <tr><td>–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤</td><td>–£–≤–µ–ª–∏—á–∏—Ç—å min_cluster_size, cluster_selection_epsilon</td></tr>
    </table>  </div>

  <div class="block">
    <h2>üî∑ 9. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏</h2>
    <pre><code>import matplotlib.pyplot as plt

# Condensed tree
clusterer.condensed_tree_.plot(
    select_clusters=True,
    selection_palette=sns.color_palette('deep', 8)
)
plt.title('Condensed Tree')
plt.show()

# Single linkage tree (dendrogram)
clusterer.single_linkage_tree_.plot()
plt.title('Single Linkage Dendrogram')
plt.show()

# Minimum spanning tree
clusterer.minimum_spanning_tree_.plot(
    edge_cmap='viridis',
    edge_alpha=0.6,
    node_size=80
)
plt.title('Minimum Spanning Tree')
plt.show()</code></pre>  </div>

  <div class="block">
    <h2>üî∑ 10. –ß–µ–∫-–ª–∏—Å—Ç</h2>
    <ul>
      <li>[ ] –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å hdbscan: pip install hdbscan</li>
      <li>[ ] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ</li>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å min_cluster_size (5-15)</li>
      <li>[ ] –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø–æ–¥–æ–±—Ä–∞—Ç—å min_samples</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∏—Å–ª–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∏ —à—É–º–∞</li>
      <li>[ ] –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–µ—Ä–∞—Ä—Ö–∏—é</li>
      <li>[ ] –û—Ü–µ–Ω–∏—Ç—å stability scores</li>
      <li>[ ] –°—Ä–∞–≤–Ω–∏—Ç—å —Å DBSCAN</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´HDBSCAN –Ω–∞—Ö–æ–¥–∏—Ç –≥—Ä—É–ø–ø—ã –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –ø–ª–æ—Ç–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤–º–µ—Å—Ç–µ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—è –æ–±–ª–∞—Å—Ç–∏ —Å —Ä–∞–∑–Ω–æ–π –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–µ–π –¥–∞–Ω–Ω—ã—Ö. –ú–µ—Ç–æ–¥ —Å–∞–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏, –Ω–µ —Ç—Ä–µ–±—É—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤¬ª.
    </blockquote>  </div>

</div>
</body>
</html>