<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Feature Stores Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; 
        min-width: 900px;
      } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
    table { width: 100%; border-collapse: collapse; font-size: 0.88em; margin: 6px 0; }
    th, td { padding: 6px 8px; text-align: left; border: 1px solid #e0e7ff; }
    th { background-color: #1a5fb4; color: white; font-weight: 700; }
    tr:nth-child(even) { background-color: #f8fbff; }
    @media print { .container { column-gap: 12px; } .block { box-shadow: none; } code, pre { font-size: 0.78em; } h1 { font-size: 1.4em; } h2 { font-size: 1em; } }
  </style>
</head>
<body>
<div class="container">
  <h1>üóÑÔ∏è Feature Stores</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –û—Å–Ω–æ–≤—ã Feature Stores</h2>
<p><strong>Feature Store</strong>: —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è ML –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</p>
<ul>
  <li><strong>Offline store</strong>: –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (batch)</li>
  <li><strong>Online store</strong>: –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ (real-time)</li>
  <li><strong>Feature registry</strong>: –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
  <li><strong>Time travel</strong>: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è</li>
  <li><strong>Consistency</strong>: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Ñ–∏—á–∏ –≤ training –∏ serving</li>
</ul>
<blockquote>üí° Feature Store —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É training-serving skew</blockquote>

  <div class="block">
    <h2>üî∑ 2. Feast Framework</h2>
<pre><code>from feast import FeatureStore, Entity, Feature, FeatureView
from feast.types import Float32, Int64
from datetime import timedelta

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ entity
driver = Entity(
    name="driver_id",
    value_type=ValueType.INT64,
    description="Driver identifier"
)

# Feature view
driver_stats = FeatureView(
    name="driver_hourly_stats",
    entities=["driver_id"],
    ttl=timedelta(hours=1),
    schema=[
        Feature(name="conv_rate", dtype=Float32),
        Feature(name="acc_rate", dtype=Float32),
    ],
    source=batch_source
)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è store
store = FeatureStore(repo_path=".")

# –ü–æ–ª—É—á–µ–Ω–∏–µ online features
features = store.get_online_features(
    features=[
        "driver_hourly_stats:conv_rate",
        "driver_hourly_stats:acc_rate",
    ],
    entity_rows=[{"driver_id": 1001}]
).to_dict()

# –ü–æ–ª—É—á–µ–Ω–∏–µ historical features
training_df = store.get_historical_features(
    entity_df=entity_df,
    features=[
        "driver_hourly_stats:conv_rate",
        "driver_hourly_stats:acc_rate",
    ]
).to_df()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Feature Transformations</h2>
<pre><code># On-demand features
from feast import on_demand_feature_view

@on_demand_feature_view(
    sources=["driver_hourly_stats"],
    schema=[
        Feature(name="conv_rate_plus_acc", dtype=Float32),
    ],
)
def conv_rate_plus_acc(features_df):
    df = pd.DataFrame()
    df["conv_rate_plus_acc"] = (
        features_df["conv_rate"] + features_df["acc_rate"]
    )
    return df

# Stream features (Kafka)
from feast import StreamFeatureView

stream_view = StreamFeatureView(
    name="driver_streaming_stats",
    entities=["driver_id"],
    ttl=timedelta(minutes=5),
    schema=[Feature(name="current_speed", dtype=Float32)],
    source=kafka_source
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. Tecton Feature Platform</h2>
<pre><code>from tecton import Entity, BatchFeatureView, batch_feature_view
from datetime import timedelta

@entity
class User:
    user_id = String(primary=True)

@batch_feature_view(
    sources=[user_events],
    entities=[User],
    mode="pandas",
    online=True,
    offline=True,
    feature_start_time=datetime(2020, 1, 1),
    batch_schedule=timedelta(hours=1),
    ttl=timedelta(days=1),
)
def user_transaction_counts(user_events):
    return user_events.groupby("user_id").count()

# –ü–æ–ª—É—á–µ–Ω–∏–µ features
from tecton import get_workspace

ws = get_workspace("prod")
features = ws.get_online_features(
    feature_service="fraud_detection",
    join_keys={"user_id": "user_123"}
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. AWS SageMaker Feature Store</h2>
<pre><code>import sagemaker
from sagemaker.feature_store.feature_group import FeatureGroup

feature_group = FeatureGroup(
    name="driver-features",
    sagemaker_session=sagemaker_session
)

# –°–æ–∑–¥–∞–Ω–∏–µ feature group
feature_group.create(
    s3_uri=f"s3://{bucket}/feature-store",
    record_identifier_name="driver_id",
    event_time_feature_name="event_time",
    role_arn=role,
    enable_online_store=True
)

# Ingestion
feature_group.ingest(
    data_frame=driver_df,
    max_workers=3,
    wait=True
)

# Online query
record = feature_group.get_record(
    record_identifier_value_as_string="driver_1001"
)

# Offline query (Athena)
query = feature_group.athena_query()
query.run(
    query_string="""
        SELECT * FROM "driver-features"
        WHERE driver_id = 'driver_1001'
    """,
    output_location=f"s3://{bucket}/query-results"
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. Feature Versioning</h2>
<pre><code># Feast versioning
driver_stats_v2 = FeatureView(
    name="driver_hourly_stats_v2",
    entities=["driver_id"],
    ttl=timedelta(hours=2),
    schema=[
        Feature(name="conv_rate", dtype=Float32),
        Feature(name="acc_rate", dtype=Float32),
        Feature(name="new_metric", dtype=Float32),  # New!
    ],
    source=batch_source_v2
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π
features_v1 = store.get_online_features(
    features=["driver_hourly_stats:conv_rate"],
    entity_rows=[{"driver_id": 1001}]
)

features_v2 = store.get_online_features(
    features=["driver_hourly_stats_v2:conv_rate"],
    entity_rows=[{"driver_id": 1001}]
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. Feature Monitoring</h2>
<pre><code># –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ drift
from evidently import ColumnDriftMetric
from evidently.report import Report

# –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã—Ö –∏ production features
report = Report(metrics=[
    ColumnDriftMetric(column_name="conv_rate"),
    ColumnDriftMetric(column_name="acc_rate"),
])

report.run(
    reference_data=training_features,
    current_data=production_features
)

# Alerting
if report.as_dict()["metrics"][0]["result"]["drift_detected"]:
    send_alert("Feature drift detected in conv_rate")

# Feast monitoring
from feast import FeatureStore

store = FeatureStore(repo_path=".")

# Get feature statistics
stats = store.get_feature_statistics(
    feature_view_name="driver_hourly_stats",
    start_date=datetime(2024, 1, 1),
    end_date=datetime(2024, 1, 31)
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. Feature Discovery</h2>
<pre><code># Feast feature registry
feature_views = store.list_feature_views()

for fv in feature_views:
    print(f"Name: {fv.name}")
    print(f"Entities: {fv.entities}")
    print(f"Features: {[f.name for f in fv.features]}")

# –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–≥–∞–º
from feast import FeatureView

driver_stats = FeatureView(
    name="driver_hourly_stats",
    tags={"team": "drivers", "version": "v2"},
    # ... rest of config
)

# Search features
relevant_features = search_features(
    tags={"team": "drivers"},
    contains="rate"
)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. Best Practices</h2>
<ul>
  <li>‚úÖ <strong>–£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è</strong>: –æ–¥–Ω–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–ª—è train –∏ serve</li>
  <li>‚úÖ <strong>–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</strong>: –æ–ø–∏—Å—ã–≤–∞–π—Ç–µ –∫–∞–∂–¥—ã–π –ø—Ä–∏–∑–Ω–∞–∫</li>
  <li>‚úÖ <strong>–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è</li>
  <li>‚úÖ <strong>Monitoring</strong>: —Å–ª–µ–¥–∏—Ç–µ –∑–∞ drift</li>
  <li>‚úÖ <strong>Lineage</strong>: –æ—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ</li>
  <li>‚úÖ <strong>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</strong>: –≤–∞–ª–∏–¥–∏—Ä—É–π—Ç–µ –ø—Ä–∏–∑–Ω–∞–∫–∏</li>
  <li>‚úÖ <strong>Performance</strong>: –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ online serving</li>
  <li>‚úÖ <strong>Ownership</strong>: –Ω–∞–∑–Ω–∞—á–∞–π—Ç–µ –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ —Ñ–∏—á–∞–º</li>
</ul>
<blockquote>üí° Feature Store - –∫–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç scalable ML infrastructure</blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 10. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</h2>
<ul>
  <li>üéØ <strong>Recommendation systems</strong>: user –∏ item features</li>
  <li>üéØ <strong>Fraud detection</strong>: transaction features</li>
  <li>üéØ <strong>Ad tech</strong>: user behavior features</li>
  <li>üéØ <strong>Search ranking</strong>: query –∏ document features</li>
  <li>ÔøΩÔøΩ <strong>Risk models</strong>: financial features</li>
  <li>üéØ <strong>Personalization</strong>: user preference features</li>
</ul>
  </div>

</div>
</div>
</body>
</html>