<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Metric-Based Learning: Siamese –∏ Matching Networks ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen { body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif; color: #333; background: #fafcff; padding: 10px; 
        min-width: 900px;
      } }
    @media print { body { background: white; padding: 0; } @page { size: A4 landscape; margin: 10mm; } }
        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }
    .block { break-inside: avoid; margin-bottom: 1.2em; padding: 12px; background: white; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    h1 { font-size: 1.6em; font-weight: 700; color: #1a5fb4; text-align: center; margin: 0 0 8px; column-span: all; }
    .subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 12px; column-span: all; }
    h2 { font-size: 1.15em; font-weight: 700; color: #1a5fb4; margin: 0 0 8px; padding-bottom: 4px; border-bottom: 1px solid #e0e7ff; }
    p, ul, ol { font-size: 0.92em; margin: 0.6em 0; }
    ul, ol { padding-left: 18px; }
    li { margin-bottom: 4px; }
    code { font-family: 'Consolas', 'Courier New', monospace; background-color: #f0f4ff; padding: 1px 4px; border-radius: 3px; font-size: 0.88em; }
    pre { background-color: #f0f4ff; padding: 8px; border-radius: 4px; overflow-x: auto; font-size: 0.84em; margin: 6px 0; }
    pre code { padding: 0; background: none; white-space: pre-wrap; }
    table { width: 100%; border-collapse: collapse; font-size: 0.82em; margin: 6px 0; }
    th { background-color: #e6f0ff; text-align: left; padding: 4px 6px; font-weight: 600; }
    td { padding: 4px 6px; border-bottom: 1px solid #f0f4ff; }
    tr:nth-child(even) { background-color: #f8fbff; }
    blockquote { font-style: italic; margin: 8px 0; padding: 6px 10px; background: #f8fbff; border-left: 2px solid #1a5fb4; font-size: 0.88em; }
  </style>
</head>
<body>
<div class="container">
  <h1>üìè Metric-Based Learning: Siamese –∏ Matching Networks</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –û—Å–Ω–æ–≤—ã Metric Learning</h2>
    <p><strong>–ò–¥–µ—è</strong>: –æ–±—É—á–∏—Ç—å embedding space, –≥–¥–µ –ø–æ—Ö–æ–∂–∏–µ –æ–±—ä–µ–∫—Ç—ã –±–ª–∏–∑–∫–æ, —Ä–∞–∑–Ω—ã–µ ‚Äî –¥–∞–ª–µ–∫–æ</p>
    <ul>
      <li><strong>–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π ML</strong>: —É—á–∏—Ç –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª–∞—Å—Å—ã</li>
      <li><strong>Metric Learning</strong>: —É—á–∏—Ç –∏–∑–º–µ—Ä—è—Ç—å –ø–æ—Ö–æ–∂–µ—Å—Ç—å</li>
      <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</strong>: –æ–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong>: few-shot learning, face recognition, verification</li>
    </ul>
    <p><strong>–§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞</strong>: d(f(x‚ÇÅ), f(x‚ÇÇ)) –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∞–ª–æ –¥–ª—è –ø–æ—Ö–æ–∂–∏—Ö –∏ –≤–µ–ª–∏–∫–æ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö</p>

  <div class="block">
    <h2>üî∑ 2. Siamese Networks</h2>
    <p><strong>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</strong>: –¥–≤–µ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ —Å–µ—Ç–∏ —Å —Ä–∞–∑–¥–µ–ª—è–µ–º—ã–º–∏ –≤–µ—Å–∞–º–∏</p>
    <ul>
      <li><strong>Input</strong>: –ø–∞—Ä–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (x‚ÇÅ, x‚ÇÇ)</li>
      <li><strong>Encoding</strong>: f(x‚ÇÅ), f(x‚ÇÇ) —á–µ—Ä–µ–∑ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å–µ—Ç—å</li>
      <li><strong>Distance</strong>: d = ||f(x‚ÇÅ) - f(x‚ÇÇ)||</li>
      <li><strong>Output</strong>: similar (1) –∏–ª–∏ different (0)</li>
    </ul>
    <p><strong>Contrastive Loss</strong>:</p>
    <pre><code>L = y * d¬≤ + (1-y) * max(margin - d, 0)¬≤
–≥–¥–µ y=1 –¥–ª—è –ø–æ—Ö–æ–∂–∏—Ö, y=0 –¥–ª—è —Ä–∞–∑–Ω—ã—Ö</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. Triplet Loss –∏ Triplet Networks</h2>
    <p><strong>–ò–¥–µ—è</strong>: anchor, positive, negative</p>
    <ul>
      <li><strong>Anchor</strong>: –±–∞–∑–æ–≤—ã–π –ø—Ä–∏–º–µ—Ä</li>
      <li><strong>Positive</strong>: –ø–æ—Ö–æ–∂–∏–π –ø—Ä–∏–º–µ—Ä (—Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å)</li>
      <li><strong>Negative</strong>: –Ω–µ–ø–æ—Ö–æ–∂–∏–π –ø—Ä–∏–º–µ—Ä (–¥—Ä—É–≥–æ–π –∫–ª–∞—Å—Å)</li>
    </ul>
    <p><strong>Triplet Loss</strong>:</p>
    <pre><code>L = max(d(a,p) - d(a,n) + margin, 0)
—Ü–µ–ª—å: d(a,p) < d(a,n) - margin</code></pre>
    <p><strong>Hard negative mining</strong>: –≤—ã–±–æ—Ä —Å–ª–æ–∂–Ω—ã—Ö –Ω–µ–≥–∞—Ç–∏–≤–æ–≤ –¥–ª—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è</p>
  </div>

  <div class="block">
    <h2>üî∑ 4. Prototypical Networks</h2>
    <p><strong>Idea</strong>: –∫–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω prototype (—Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–º)</p>
    <ul>
      <li><strong>Support set</strong>: –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è prototypes</li>
      <li><strong>Prototype</strong>: c_k = mean(f(x_i)) –¥–ª—è –∫–ª–∞—Å—Å–∞ k</li>
      <li><strong>Classification</strong>: –±–ª–∏–∂–∞–π—à–∏–π prototype</li>
    </ul>
    <p><strong>Distance metric</strong>: –æ–±—ã—á–Ω–æ Euclidean –∏–ª–∏ cosine</p>
    <p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</strong>:</p>
    <ul>
      <li>–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</li>
      <li>–•–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è few-shot</li>
      <li>–ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–±–æ–±—â–µ–Ω–∏–µ k-NN</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 5. Matching Networks</h2>
    <p><strong>Vinyals et al., 2016</strong></p>
    <p><strong>–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞</strong>:</p>
    <ul>
      <li><strong>Embedding</strong>: g(x) –¥–ª—è query, f(x) –¥–ª—è support</li>
      <li><strong>Attention</strong>: a(x, x_i) = softmax(cosine(g(x), f(x_i)))</li>
      <li><strong>Prediction</strong>: –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å—É–º–º–∞ –º–µ—Ç–æ–∫ support set</li>
    </ul>
    <pre><code>≈∑ = Œ£·µ¢ a(x, x·µ¢) y·µ¢</code></pre>
    <p><strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏</strong>:</p>
    <ul>
      <li>Episodic training: –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –∑–∞–¥–∞—á–∞—Ö</li>
      <li>Full Context Embeddings (FCE): bidirectional LSTM</li>
      <li>Attention Kernel</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 6. Relation Networks</h2>
    <p><strong>–û–±—É—á–∞–µ–º–∞—è –º–µ—Ç—Ä–∏–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</strong></p>
    <ul>
      <li><strong>Embedding module</strong>: f(x)</li>
      <li><strong>Relation module</strong>: g(f(x‚ÇÅ), f(x‚ÇÇ)) ‚Üí similarity score</li>
      <li><strong>–û–±—É—á–µ–Ω–∏–µ end-to-end</strong>: –æ–±–µ —á–∞—Å—Ç–∏ –æ–±—É—á–∞—é—Ç—Å—è –≤–º–µ—Å—Ç–µ</li>
    </ul>
    <p><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</strong>:</p>
    <ul>
      <li>–ì–∏–±–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞ (–Ω–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è Euclidean)</li>
      <li>–õ—É—á—à–µ–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö</li>
      <li>–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 7. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (PyTorch)</h2>
    <pre><code># Siamese Network
class SiameseNet(nn.Module):
    def __init__(self):
        super().__init__()
        self.encoder = nn.Sequential(
            nn.Conv2d(1, 64, 10),
            nn.ReLU(),
            nn.MaxPool2d(2),
            nn.Conv2d(64, 128, 7),
            nn.ReLU(),
            nn.MaxPool2d(2),
            nn.Flatten(),
            nn.Linear(128*3*3, 128)
        )
    
    def forward(self, x1, x2):
        h1 = self.encoder(x1)
        h2 = self.encoder(x2)
        return torch.norm(h1 - h2, dim=1)

# Contrastive Loss
def contrastive_loss(d, y, margin=1.0):
    return torch.mean(
        y * d**2 + 
        (1-y) * torch.clamp(margin - d, min=0)**2
    )</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. Face Recognition</h2>
    <p><strong>–ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ metric learning</strong></p>
    <p><strong>FaceNet</strong> (Google, 2015):</p>
    <ul>
      <li>Triplet loss –¥–ª—è face embeddings</li>
      <li>128-–º–µ—Ä–Ω—ã–µ embeddings</li>
      <li>Accuracy 99.63% –Ω–∞ LFW</li>
    </ul>
    <p><strong>ArcFace, CosFace</strong>:</p>
    <ul>
      <li>Angular margin –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤</li>
      <li>State-of-the-art –Ω–∞ face recognition</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 9. Few-Shot Learning Benchmarks</h2>
    <table>
      <tr><th>Dataset</th><th>Classes</th><th>Images</th><th>Resolution</th></tr>
      <tr><td><strong>Omniglot</strong></td><td>1623</td><td>32,460</td><td>28√ó28</td></tr>
      <tr><td><strong>Mini-ImageNet</strong></td><td>100</td><td>60,000</td><td>84√ó84</td></tr>
      <tr><td><strong>Tiered-ImageNet</strong></td><td>608</td><td>779,165</td><td>84√ó84</td></tr>
      <tr><td><strong>CUB-200</strong></td><td>200</td><td>11,788</td><td>84√ó84</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 10. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤</h2>
    <table>
      <tr><th>–ú–µ—Ç–æ–¥</th><th>–ü–ª—é—Å—ã</th><th>–ú–∏–Ω—É—Å—ã</th></tr>
      <tr><td><strong>Siamese</strong></td><td>–ü—Ä–æ—Å—Ç–æ—Ç–∞, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è</td><td>–ü–∞—Ä–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ</td></tr>
      <tr><td><strong>Triplet</strong></td><td>–•–æ—Ä–æ—à–∏–µ embeddings</td><td>–°–ª–æ–∂–Ω—ã–π sampling</td></tr>
      <tr><td><strong>Prototypical</strong></td><td>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</td><td>–ü—Ä–æ—Å—Ç–∞—è –º–µ—Ç—Ä–∏–∫–∞</td></tr>
      <tr><td><strong>Matching</strong></td><td>Attention, –≥–∏–±–∫–æ—Å—Ç—å</td><td>–°–ª–æ–∂–Ω–µ–µ</td></tr>
      <tr><td><strong>Relation</strong></td><td>–û–±—É—á–∞–µ–º–∞—è –º–µ—Ç—Ä–∏–∫–∞</td><td>–ë–æ–ª—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤</td></tr>
    </table>
  </div>

  <div class="block">
    <h2>üî∑ 11. Data Augmentation –¥–ª—è Few-Shot</h2>
    <ul>
      <li><strong>Standard augmentations</strong>: flip, crop, rotate, color jitter</li>
      <li><strong>Mixup</strong>: —Å–º–µ—à–∏–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–æ–≤</li>
      <li><strong>Cutout</strong>: –º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–µ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</li>
      <li><strong>MetaAugment</strong>: –æ–±—É—á–∞–µ–º—ã–µ augmentations</li>
      <li><strong>Hallucination</strong>: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 12. Transductive Few-Shot Learning</h2>
    <p><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ unlabeled query examples</strong></p>
    <ul>
      <li>Semi-supervised –ø–æ–¥—Ö–æ–¥</li>
      <li>Label propagation –Ω–∞ query set</li>
      <li>–£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ—Çoty –ø–æ–≤ —Å query –¥–∞–Ω–Ω—ã–º–∏</li>
      <li>Graph-based methods</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 13. Cross-Domain Few-Shot Learning</h2>
    <p><strong>Transfer –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏</strong></p>
    <ul>
      <li><strong>–ü—Ä–æ–±–ª–µ–º–∞</strong>: train –Ω–∞ ImageNet, test –Ω–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö</li>
      <li><strong>Domain shift</strong>: —Ä–∞–∑–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</li>
      <li><strong>–†–µ—à–µ–Ω–∏—è</strong>:
        <ul>
          <li>Domain adaptation techniques</li>
          <li>Meta-learning across domains</li>
          <li>Self-supervised pre-training</li>
        </ul>
      </li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 14. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</h2>
    <p><strong>Computer Vision</strong>:</p>
    <ul>
      <li>Face verification/recognition</li>
      <li>Person re-identification</li>
      <li>Object detection —Å –º–∞–ª—ã–º —á–∏—Å–ª–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤</li>
      <li>Medical image analysis</li>
    </ul>
    <p><strong>NLP</strong>:</p>
    <ul>
      <li>Few-shot text classification</li>
      <li>Semantic similarity</li>
      <li>Entity linking</li>
    </ul>
    <p><strong>Other</strong>:</p>
    <ul>
      <li>Drug discovery</li>
      <li>Recommendation systems</li>
      <li>Anomaly detection</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 15. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã</h2>
    <ul>
      <li><strong>Embedding size</strong>: 128-512 –æ–±—ã—á–Ω–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ</li>
      <li><strong>Backbone</strong>: ResNet, Conv-4 –¥–ª—è few-shot</li>
      <li><strong>Normalization</strong>: L2 normalize embeddings</li>
      <li><strong>Distance metric</strong>: –Ω–∞—á–Ω–∏—Ç–µ —Å Euclidean, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ cosine</li>
      <li><strong>Hard negative mining</strong>: –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è triplet loss</li>
      <li><strong>Episodic training</strong>: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è meta-learning</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 16. –í—ã–≤–æ–¥—ã</h2>
    <ul>
      <li><strong>Metric learning</strong>: –æ–±—É—á–µ–Ω–∏–µ similarity –≤–º–µ—Å—Ç–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏</li>
      <li><strong>Few-shot friendly</strong>: –æ–±–æ–±—â–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã</li>
      <li><strong>Siamese/Triplet</strong>: –∫–ª–∞—Å—Å–∏–∫–∞ –¥–ª—è embeddings</li>
      <li><strong>Prototypical/Matching</strong>: —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è few-shot</li>
      <li><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏—è</strong>: face recognition, few-shot learning, verification</li>
      <li><strong>–ê–∫—Ç–∏–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π</strong>: –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è</li>
    </ul>
    <blockquote>
      ¬´Metric learning —É—á–∏—Ç –º–æ–¥–µ–ª—å –ø–æ–Ω–∏–º–∞—Ç—å "–ø–æ—Ö–æ–∂–µ—Å—Ç—å", –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∫–ª–∞—Å—Å—ã ‚Äî —ç—Ç–æ –∫–ª—é—á –∫ –æ–±–æ–±—â–µ–Ω–∏—é –Ω–∞ –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ —Å –º–∞–ª—ã–º —á–∏—Å–ª–æ–º –ø—Ä–∏–º–µ—Ä–æ–≤¬ª.
    </blockquote>
  </div>

</div>
</div>
</body>
</html>
