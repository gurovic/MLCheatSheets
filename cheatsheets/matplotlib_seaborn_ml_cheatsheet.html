<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Matplotlib/Seaborn –¥–ª—è ML –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Äî Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      
        min-width: 900px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      font-size: 0.9em;
      color: #666;
      text-align: center;
      margin-bottom: 20px;
      column-span: all;
    }

    h2 {
      font-size: 1.1em;
      font-weight: 700;
      margin-top: 0;
      color: #1a5fb4;
      border-bottom: 2px solid #e0e8f5;
      padding-bottom: 4px;
    }

    h3 {
      font-size: 0.95em;
      font-weight: 600;
      margin: 8px 0 4px;
      color: #26a269;
    }

    p, ul, ol {
      margin: 6px 0;
      font-size: 0.88em;
      line-height: 1.5;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 3px;
    }

    code {
      background: #f6f8fa;
      padding: 1px 4px;
      border-radius: 3px;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 0.9em;
      color: #c7254e;
    }

    pre {
      background: #282c34;
      color: #abb2bf;
      padding: 10px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 0.8em;
      line-height: 1.4;
      margin: 8px 0;
    }

    pre code {
      background: transparent;
      color: inherit;
      padding: 0;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 8px 0;
      font-size: 0.85em;
    }

    th, td {
      border: 1px solid #ddd;
      padding: 6px 8px;
      text-align: left;
    }

    th {
      background: #e0e8f5;
      font-weight: 600;
      color: #1a5fb4;
    }

    tr:nth-child(even) {
      background: #f9fbff;
    }

    blockquote {
      background: #fff9e6;
      border-left: 4px solid #f6d32d;
      padding: 8px 12px;
      margin: 8px 0;
      font-size: 0.88em;
      font-style: italic;
    }

    .formula {
      background: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      margin: 8px 0;
      font-family: 'Cambria', 'Times New Roman', serif;
      font-size: 0.9em;
      text-align: center;
    }
  </style>
</head>
<body>

<h1>üìä Matplotlib/Seaborn –¥–ª—è ML –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</h1>
<div class="subtitle"></div>

<div class="container">

  <div class="block">
    <h2>üî∑ 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç–∏–ª—è</h2>
    <h3>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥:</h3>
    <pre><code>import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∏–ª—å seaborn
sns.set_style("whitegrid")
sns.set_context("notebook", font_scale=1.2)

# –ü–∞–ª–∏—Ç—Ä–∞ —Ü–≤–µ—Ç–æ–≤
sns.set_palette("husl")

# –†–∞–∑–º–µ—Ä —Ñ–∏–≥—É—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
plt.rcParams['figure.figsize'] = (10, 6)
plt.rcParams['figure.dpi'] = 100

# –®—Ä–∏—Ñ—Ç—ã
plt.rcParams['font.family'] = 'sans-serif'
plt.rcParams['font.sans-serif'] = ['Arial']

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
plt.rcParams['savefig.dpi'] = 300
plt.rcParams['savefig.bbox'] = 'tight'</code></pre>

    </div>
<div class="block">
    <h2>üî∑ 2. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö</h2>
    <h3>–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π:</h3>
    <pre><code>import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_csv('data.csv')

# –ö—Ä–∞—Å–∏–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
plt.figure(figsize=(12, 10))
corr = df.corr()

# –ú–∞—Å–∫–∞ –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–≥–æ —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–∞
mask = np.triu(np.ones_like(corr, dtype=bool))

sns.heatmap(
    corr, 
    mask=mask,
    cmap='coolwarm',
    center=0,
    square=True,
    linewidths=0.5,
    annot=True,
    fmt='.2f',
    cbar_kws={"shrink": 0.8}
)
plt.title('–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤')
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
    <h3>–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π:</h3>
    <pre><code># –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º—ã —Å KDE –¥–ª—è –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
numeric_features = df.select_dtypes(include=[np.number]).columns

fig, axes = plt.subplots(
    nrows=(len(numeric_features) + 2) // 3,
    ncols=3,
    figsize=(15, 4 * ((len(numeric_features) + 2) // 3))
)

axes = axes.flatten()

for i, col in enumerate(numeric_features):
    sns.histplot(
        data=df,
        x=col,
        kde=True,
        ax=axes[i],
        bins=30,
        color='steelblue'
    )
    axes[i].set_title(f'–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ {col}')
    axes[i].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')

# –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ subplots
for j in range(i+1, len(axes)):
    fig.delaxes(axes[j])

plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
    <h3>–ö—Ä–∞—Å–∏–≤—ã–µ —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã:</h3>
    <pre><code># Countplot —Å –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
fig, ax = plt.subplots(figsize=(10, 6))

# –ü–æ–¥—Å—á—ë—Ç –∑–Ω–∞—á–µ–Ω–∏–π
counts = df['category'].value_counts()

sns.barplot(
    x=counts.index,
    y=counts.values,
    palette='viridis',
    ax=ax
)

# –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã
total = len(df)
for i, v in enumerate(counts.values):
    ax.text(
        i, v + 50, 
        f'{v}\n({100*v/total:.1f}%)',
        ha='center',
        va='bottom',
        fontsize=10
    )

ax.set_xlabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
ax.set_ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
ax.set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±—Ä–æ—Å–æ–≤</h2>
    <h3>Boxplot —Å —Ç–æ—á–∫–∞–º–∏:</h3>
    <pre><code>fig, ax = plt.subplots(figsize=(12, 6))

# Boxplot
sns.boxplot(
    data=df[numeric_features],
    orient='h',
    palette='Set2',
    ax=ax
)

# –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏ (swarm plot)
sns.swarmplot(
    data=df[numeric_features],
    orient='h',
    color='black',
    alpha=0.3,
    size=2,
    ax=ax
)

ax.set_xlabel('–ó–Ω–∞—á–µ–Ω–∏–µ')
ax.set_title('–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤')
plt.tight_layout()
plt.show()</code></pre>

    <h3>Violin plot:</h3>
    <pre><code>plt.figure(figsize=(12, 6))

sns.violinplot(
    data=df,
    x='target',
    y='feature',
    palette='muted',
    inner='box'  # –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–≤–∞—Ä—Ç–∏–ª–∏
)

plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø–æ –∫–ª–∞—Å—Å–∞–º')
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. Pairplot –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</h2>
    <pre><code># –ú–∞—Ç—Ä–∏—Ü–∞ –¥–∏–∞–≥—Ä–∞–º–º —Ä–∞—Å—Å–µ—è–Ω–∏—è
sns.pairplot(
    df,
    hue='target',  # —Ü–≤–µ—Ç –ø–æ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
    diag_kind='kde',  # KDE –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª–∏
    plot_kws={'alpha': 0.6, 's': 30},
    palette='husl',
    corner=True  # –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∏–∂–Ω–∏–π —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫
)
plt.suptitle('–ü–∞—Ä–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤', y=1.02)
plt.show()</code></pre>

    <h3>–í—ã–±–æ—Ä –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:</h3>
    <pre><code># –í—ã–±–∏—Ä–∞–µ–º —Ç–æ–ø-5 –∫–æ—Ä—Ä–µ–ª–∏—Ä—É—é—â–∏—Ö —Å —Ü–µ–ª–µ–≤–æ–π
target_corr = df.corr()['target'].abs().sort_values(ascending=False)
top_features = target_corr.head(6).index.tolist()  # +target

sns.pairplot(
    df[top_features],
    hue='target',
    diag_kind='hist'
)
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. –ö—Ä–∏–≤—ã–µ –æ–±—É—á–µ–Ω–∏—è</h2>
    <pre><code>from sklearn.model_selection import learning_curve

def plot_learning_curves(estimator, X, y, cv=5):
    train_sizes, train_scores, val_scores = learning_curve(
        estimator, X, y,
        cv=cv,
        n_jobs=-1,
        train_sizes=np.linspace(0.1, 1.0, 10),
        scoring='accuracy'
    )
    
    # –°—Ä–µ–¥–Ω–∏–µ –∏ std
    train_mean = np.mean(train_scores, axis=1)
    train_std = np.std(train_scores, axis=1)
    val_mean = np.mean(val_scores, axis=1)
    val_std = np.std(val_scores, axis=1)
    
    plt.figure(figsize=(10, 6))
    
    # Train
    plt.plot(train_sizes, train_mean, 
             label='Train', marker='o', linewidth=2)
    plt.fill_between(train_sizes, 
                     train_mean - train_std,
                     train_mean + train_std,
                     alpha=0.2)
    
    # Validation
    plt.plot(train_sizes, val_mean,
             label='Validation', marker='s', linewidth=2)
    plt.fill_between(train_sizes,
                     val_mean - val_std,
                     val_mean + val_std,
                     alpha=0.2)
    
    plt.xlabel('Training Set Size')
    plt.ylabel('Accuracy')
    plt.title('Learning Curves')
    plt.legend(loc='best')
    plt.grid(True, alpha=0.3)
    plt.tight_layout()
    plt.show()

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
from sklearn.ensemble import RandomForestClassifier
rf = RandomForestClassifier()
plot_learning_curves(rf, X, y)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. Confusion Matrix</h2>
    <pre><code>from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay

y_pred = model.predict(X_test)
cm = confusion_matrix(y_test, y_pred)

# –ö—Ä–∞—Å–∏–≤–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
fig, ax = plt.subplots(figsize=(8, 6))

disp = ConfusionMatrixDisplay(
    confusion_matrix=cm,
    display_labels=['Class 0', 'Class 1']
)

disp.plot(
    cmap='Blues',
    ax=ax,
    values_format='d',
    colorbar=True
)

plt.title('Confusion Matrix')
plt.tight_layout()
plt.show()

# –° –ø—Ä–æ—Ü–µ–Ω—Ç–∞–º–∏
cm_normalized = cm.astype('float') / cm.sum(axis=1)[:, np.newaxis]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# –ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
sns.heatmap(cm, annot=True, fmt='d', cmap='Blues', ax=ax1)
ax1.set_title('–ê–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è')
ax1.set_ylabel('True label')
ax1.set_xlabel('Predicted label')

# –ü—Ä–æ—Ü–µ–Ω—Ç—ã
sns.heatmap(cm_normalized, annot=True, fmt='.2%', cmap='Blues', ax=ax2)
ax2.set_title('–ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è')
ax2.set_ylabel('True label')
ax2.set_xlabel('Predicted label')

plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 9. ROC –∏ PR –∫—Ä–∏–≤—ã–µ</h2>
    <pre><code>from sklearn.metrics import roc_curve, auc, precision_recall_curve

y_proba = model.predict_proba(X_test)[:, 1]

fig, (ax1, ax2) = plt.subplots(1, 2, figsize=(14, 5))

# ROC Curve
fpr, tpr, _ = roc_curve(y_test, y_proba)
roc_auc = auc(fpr, tpr)

ax1.plot(fpr, tpr, linewidth=2, 
         label=f'ROC (AUC = {roc_auc:.3f})')
ax1.plot([0, 1], [0, 1], 'k--', linewidth=1, 
         label='Random')
ax1.set_xlabel('False Positive Rate')
ax1.set_ylabel('True Positive Rate')
ax1.set_title('ROC Curve')
ax1.legend(loc='lower right')
ax1.grid(True, alpha=0.3)

# Precision-Recall Curve
precision, recall, _ = precision_recall_curve(y_test, y_proba)
pr_auc = auc(recall, precision)

ax2.plot(recall, precision, linewidth=2,
         label=f'PR (AUC = {pr_auc:.3f})')
ax2.set_xlabel('Recall')
ax2.set_ylabel('Precision')
ax2.set_title('Precision-Recall Curve')
ax2.legend(loc='lower left')
ax2.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. Feature Importance</h2>
    <pre><code>from sklearn.ensemble import RandomForestClassifier

rf = RandomForestClassifier(n_estimators=100)
rf.fit(X_train, y_train)

# –í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
importances = rf.feature_importances_
indices = np.argsort(importances)[::-1]
feature_names = X_train.columns

plt.figure(figsize=(10, 8))

# –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π barplot
y_pos = np.arange(len(feature_names))
plt.barh(
    y_pos,
    importances[indices][::-1],
    align='center',
    color=plt.cm.viridis(importances[indices][::-1] / importances.max())
)

plt.yticks(y_pos, feature_names[indices][::-1])
plt.xlabel('Importance')
plt.title('Feature Importance (Random Forest)')
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 11. –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π</h2>
    <pre><code>from sklearn.tree import DecisionTreeClassifier, plot_tree

dt = DecisionTreeClassifier(max_depth=3)
dt.fit(X_train, y_train)

plt.figure(figsize=(20, 10))
plot_tree(
    dt,
    feature_names=X_train.columns,
    class_names=['Class 0', 'Class 1'],
    filled=True,
    rounded=True,
    fontsize=10
)
plt.title('Decision Tree Visualization')
plt.tight_layout()
plt.show()

# –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: graphviz
from sklearn.tree import export_graphviz
import graphviz

dot_data = export_graphviz(
    dt,
    feature_names=X_train.columns,
    class_names=['Class 0', 'Class 1'],
    filled=True,
    rounded=True,
    special_characters=True
)

graph = graphviz.Source(dot_data)
graph.render('tree', format='png', cleanup=True)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ö–ª–∞—Å—Ç–µ—Ä—ã (2D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è)</h2>
    <pre><code>from sklearn.cluster import KMeans
from sklearn.decomposition import PCA

# –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–µ - —Å–∂–∏–º–∞–µ–º –¥–æ 2D
pca = PCA(n_components=2)
X_2d = pca.fit_transform(X)

# –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
kmeans = KMeans(n_clusters=3, random_state=42)
labels = kmeans.fit_predict(X)

plt.figure(figsize=(10, 8))

# Scatter plot —Ç–æ—á–µ–∫
scatter = plt.scatter(
    X_2d[:, 0],
    X_2d[:, 1],
    c=labels,
    cmap='viridis',
    s=50,
    alpha=0.6,
    edgecolors='w',
    linewidth=0.5
)

# –¶–µ–Ω—Ç—Ä–æ–∏–¥—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
centers_2d = pca.transform(kmeans.cluster_centers_)
plt.scatter(
    centers_2d[:, 0],
    centers_2d[:, 1],
    c='red',
    s=300,
    alpha=0.8,
    marker='X',
    edgecolors='black',
    linewidth=2,
    label='Centroids'
)

plt.colorbar(scatter, label='Cluster')
plt.xlabel(f'PC1 ({pca.explained_variance_ratio_[0]:.2%})')
plt.ylabel(f'PC2 ({pca.explained_variance_ratio_[1]:.2%})')
plt.title('K-Means Clustering (PCA projection)')
plt.legend()
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 13. Residuals plot (—Ä–µ–≥—Ä–µ—Å—Å–∏—è)</h2>
    <pre><code>from sklearn.linear_model import LinearRegression

lr = LinearRegression()
lr.fit(X_train, y_train)

y_pred = lr.predict(X_test)
residuals = y_test - y_pred

fig, axes = plt.subplots(2, 2, figsize=(14, 10))

# 1. Predicted vs Actual
axes[0, 0].scatter(y_test, y_pred, alpha=0.5)
axes[0, 0].plot([y_test.min(), y_test.max()],
                [y_test.min(), y_test.max()],
                'r--', lw=2)
axes[0, 0].set_xlabel('Actual')
axes[0, 0].set_ylabel('Predicted')
axes[0, 0].set_title('Predicted vs Actual')

# 2. Residuals vs Predicted
axes[0, 1].scatter(y_pred, residuals, alpha=0.5)
axes[0, 1].axhline(y=0, color='r', linestyle='--')
axes[0, 1].set_xlabel('Predicted')
axes[0, 1].set_ylabel('Residuals')
axes[0, 1].set_title('Residuals vs Predicted')

# 3. Histogram of Residuals
axes[1, 0].hist(residuals, bins=30, edgecolor='black')
axes[1, 0].set_xlabel('Residuals')
axes[1, 0].set_ylabel('Frequency')
axes[1, 0].set_title('Distribution of Residuals')

# 4. Q-Q plot
from scipy import stats
stats.probplot(residuals, dist="norm", plot=axes[1, 1])
axes[1, 1].set_title('Q-Q Plot')

plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 14. Partial Dependence Plot</h2>
    <pre><code>from sklearn.inspection import PartialDependenceDisplay

features = [0, 1, (0, 1)]  # –∏–Ω–¥–µ–∫—Å—ã –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

fig, ax = plt.subplots(figsize=(14, 4))

PartialDependenceDisplay.from_estimator(
    rf,
    X_train,
    features,
    feature_names=X_train.columns,
    ax=ax,
    kind='both'  # –∏ –ª–∏–Ω–∏—è, –∏ ICE
)

plt.suptitle('Partial Dependence Plots')
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 15. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π</h2>
    <pre><code>from sklearn.model_selection import cross_val_score

models = {
    'Logistic Regression': LogisticRegression(),
    'Random Forest': RandomForestClassifier(),
    'SVM': SVC(),
    'Gradient Boosting': GradientBoostingClassifier()
}

results = []
for name, model in models.items():
    scores = cross_val_score(model, X, y, cv=5, scoring='accuracy')
    results.append({
        'Model': name,
        'Mean': scores.mean(),
        'Std': scores.std(),
        'Scores': scores
    })

# Boxplot
fig, ax = plt.subplots(figsize=(10, 6))

positions = range(len(models))
boxplot_data = [r['Scores'] for r in results]

bp = ax.boxplot(
    boxplot_data,
    positions=positions,
    labels=[r['Model'] for r in results],
    patch_artist=True,
    showmeans=True
)

# –†–∞—Å–∫—Ä–∞—à–∏–≤–∞–µ–º
colors = plt.cm.Set3(np.linspace(0, 1, len(models)))
for patch, color in zip(bp['boxes'], colors):
    patch.set_facecolor(color)

ax.set_ylabel('Accuracy')
ax.set_title('Model Comparison (Cross-Validation)')
ax.yaxis.grid(True, alpha=0.3)
plt.xticks(rotation=45, ha='right')
plt.tight_layout()
plt.show()</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 16. –ß–µ–∫-–ª–∏—Å—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏</h2>
    <ul>
      <li>[ ] –í—ã–±—Ä–∞—Ç—å –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Å—Ç–∏–ª—å (seaborn style)</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–µ —Ü–≤–µ—Ç–æ–≤—ã–µ –ø–∞–ª–∏—Ç—Ä—ã</li>
      <li>[ ] –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –ø–æ–¥–ø–∏—Å–∏ –æ—Å–µ–π</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–µ–≥–µ–Ω–¥—ã –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏</li>
      <li>[ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–æ–≤ (—á–∏—Ç–∞–µ–º–æ—Å—Ç—å)</li>
      <li>[ ] –î–æ–±–∞–≤–∏—Ç—å —Å–µ—Ç–∫—É –¥–ª—è —á–∏—Å–ª–æ–≤—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤</li>
      <li>[ ] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <code>tight_layout()</code> –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º</li>
      <li>[ ] –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≤ –≤—ã—Å–æ–∫–æ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ (DPI=300)</li>
      <li>[ ] –ò–∑–±–µ–≥–∞—Ç—å 3D –≥—Ä–∞—Ñ–∏–∫–æ–≤ (—Å–ª–æ–∂–Ω—ã –¥–ª—è –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è)</li>
      <li>[ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ —Ü–≤–µ—Ç–æ–≤—É—é —Å–ª–µ–ø–æ—Ç—É</li>
    </ul>

    <h3>üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑—á–∏–∫—É:</h3>
    <blockquote>
      ¬´–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Äî —ç—Ç–æ —è–∑—ã–∫, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –º–æ–¥–µ–ª—å –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –æ–±—ä—è—Å–Ω—è–µ—Ç —Å–≤–æ–∏ —Ä–µ—à–µ–Ω–∏—è. –•–æ—Ä–æ—à–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ —á–∏—Å–ª–∞ –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏, –ø–æ–º–æ–≥–∞—è –ø—Ä–∏–Ω–∏–º–∞—Ç—å –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Ä–µ—à–µ–Ω–∏—è¬ª.
    </blockquote>
  </div>



</div>
</body>
</html>
