<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è (SVD, NMF) Cheatsheet ‚Äî 3 –∫–æ–ª–æ–Ω–∫–∏</title>
  <style>
    @media screen {
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
        color: #333;
        background: #fafcff;
        padding: 10px;
      }
    }
    @media print {
      body {
        background: white;
        padding: 0;
      }
      @page {
        size: A4 landscape;
        margin: 10mm;
      }
    }

        .container {
      max-width: 100%;
    }

    /* Responsive columns: 3 columns on wide screens, fewer on narrow */
    @media (min-width: 900px) {
      .container {
        column-count: 3;
        column-gap: 20px;
      }
    }
    
    @media (min-width: 600px) and (max-width: 899px) {
      .container {
        column-count: 2;
        column-gap: 20px;
      }
    }
    
    @media (max-width: 599px) {
      .container {
        column-count: 1;
      }
    }

    .block {
      break-inside: avoid;
      margin-bottom: 1.2em;
      padding: 12px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    h1 {
      font-size: 1.6em;
      font-weight: 700;
      color: #1a5fb4;
      text-align: center;
      margin: 0 0 8px;
      column-span: all;
    }

    .subtitle {
      text-align: center;
      color: #666;
      font-size: 0.9em;
      margin-bottom: 12px;
      column-span: all;
    }

    h2 {
      font-size: 1.15em;
      font-weight: 700;
      color: #1a5fb4;
      margin: 0 0 8px;
      padding-bottom: 4px;
      border-bottom: 1px solid #e0e7ff;
    }

    p, ul, ol {
      font-size: 0.92em;
      margin: 0.6em 0;
    }

    ul, ol {
      padding-left: 18px;
    }

    li {
      margin-bottom: 4px;
    }

    code {
      font-family: 'Consolas', 'Courier New', monospace;
      background-color: #f0f4ff;
      padding: 1px 4px;
      border-radius: 3px;
      font-size: 0.88em;
    }

    pre {
      background-color: #f0f4ff;
      padding: 8px;
      border-radius: 4px;
      overflow-x: auto;
      font-size: 0.84em;
      margin: 6px 0;
    }

    pre code {
      padding: 0;
      background: none;
      white-space: pre-wrap;
    }

    blockquote {
      font-style: italic;
      margin: 8px 0;
      padding: 6px 10px;
      background: #f8fbff;
      border-left: 2px solid #1a5fb4;
      font-size: 0.88em;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.88em;
      margin: 6px 0;
    }

    th, td {
      padding: 6px 8px;
      text-align: left;
      border: 1px solid #e0e7ff;
    }

    th {
      background-color: #1a5fb4;
      color: white;
      font-weight: 700;
    }

    tr:nth-child(even) {
      background-color: #f8fbff;
    }

    @media print {
      .container { column-gap: 12px; }
      .block { box-shadow: none; }
      code, pre { font-size: 0.78em; }
      h1 { font-size: 1.4em; }
      h2 { font-size: 1em; }
    }
  </style>
</head>
<body>

<div class="container">

  <h1>üî¢ –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: SVD & NMF</h1>
  <div class="subtitle">üìÖ –Ø–Ω–≤–∞—Ä—å 2026</div>

  <div class="block">
    <h2>üî∑ 1. –°—É—Ç—å –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</h2>
    <p><strong>Matrix Factorization</strong>: —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –Ω–∞ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</p>
    <ul>
      <li><strong>–ò–¥–µ—è</strong>: –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –æ–±—ä–µ–∫—Ç—ã –≤ –µ–¥–∏–Ω–æ–º –ª–∞—Ç–µ–Ω—Ç–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ</li>
      <li><strong>–¶–µ–ª—å</strong>: R ‚âà UV<sup>T</sup>, –≥–¥–µ R - –º–∞—Ç—Ä–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ (m√ón)</li>
      <li><strong>U</strong>: –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (m√ók) - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</li>
      <li><strong>V</strong>: –º–∞—Ç—Ä–∏—Ü–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (n√ók) - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤</li>
      <li><strong>k</strong>: —á–∏—Å–ª–æ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ (–æ–±—ã—á–Ω–æ 20-200)</li>
      <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞</strong>: —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º</li>
    </ul>
    <blockquote>
      üí° –õ–∞—Ç–µ–Ω—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã –º–æ–≥—É—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –∂–∞–Ω—Ä–∞–º, —Ç–µ–º–∞–º –∏–ª–∏ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞–º
    </blockquote>

  <div class="block">
    <h2>üî∑ 2. SVD (Singular Value Decomposition)</h2>
    <p><strong>SVD —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ</strong>: R = UŒ£V<sup>T</sup></p>
    <ul>
      <li><strong>U</strong>: –ª–µ–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (m√óm)</li>
      <li><strong>Œ£</strong>: –¥–∏–∞–≥–æ–Ω–∞–ª—å–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (m√ón)</li>
      <li><strong>V<sup>T</sup></strong>: –ø—Ä–∞–≤—ã–µ —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã (n√ón)</li>
      <li><strong>–£—Å–µ—á—ë–Ω–Ω—ã–π SVD</strong>: –æ—Å—Ç–∞–≤–ª—è–µ–º k –Ω–∞–∏–±–æ–ª—å—à–∏—Ö —Å–∏–Ω–≥—É–ª—è—Ä–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π</li>
      <li><strong>–ü—Ä–æ–±–ª–µ–º–∞</strong>: –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π SVD —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω—É—é –º–∞—Ç—Ä–∏—Ü—É (–Ω–µ—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤)</li>
    </ul>
    <pre><code><strong>–£—Å–µ—á—ë–Ω–Ω—ã–π SVD:</strong>
R ‚âà U_k Œ£_k V_k^T

–≥–¥–µ:
U_k - –ø–µ—Ä–≤—ã–µ k —Å—Ç–æ–ª–±—Ü–æ–≤ U (m√ók)
Œ£_k - –ø–µ—Ä–≤—ã–µ k√ók –∑–Ω–∞—á–µ–Ω–∏–π Œ£
V_k - –ø–µ—Ä–≤—ã–µ k —Å—Ç–æ–ª–±—Ü–æ–≤ V (n√ók)

<strong>–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞:</strong>
rÃÇ_ui = (U_k Œ£_k V_k^T)_ui</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 3. SVD –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π (Surprise)</h2>
    <pre><code>from surprise import SVD, Dataset, Reader
from surprise.model_selection import cross_validate
import pandas as pd

# –î–∞–Ω–Ω—ã–µ: user, item, rating
data = pd.DataFrame([
    ('user1', 'movie1', 5),
    ('user1', 'movie2', 3),
    ('user2', 'movie1', 4),
    ('user2', 'movie3', 2),
    ('user3', 'movie2', 5),
    ('user3', 'movie3', 4),
])

reader = Reader(rating_scale=(1, 5))
dataset = Dataset.load_from_df(data, reader)

# SVD –º–æ–¥–µ–ª—å
model = SVD(
    n_factors=50,        # –ß–∏—Å–ª–æ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
    n_epochs=20,         # –ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
    lr_all=0.005,        # Learning rate
    reg_all=0.02,        # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
    random_state=42
)

# –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
cv_results = cross_validate(
    model, dataset, 
    measures=['RMSE', 'MAE'], 
    cv=5, 
    verbose=True
)

# –û–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–Ω–æ–º –Ω–∞–±–æ—Ä–µ
trainset = dataset.build_full_trainset()
model.fit(trainset)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
prediction = model.predict('user1', 'movie3')
print(f"Predicted rating: {prediction.est:.2f}")

# –¢–æ–ø-N —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
def get_top_n_recommendations(model, user_id, n=10):
    # –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –æ–±—ä–µ–∫—Ç—ã
    all_items = trainset.all_items()
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è –≤—Å–µ—Ö –æ–±—ä–µ–∫—Ç–æ–≤
    predictions = []
    for item_id in all_items:
        pred = model.predict(user_id, item_id)
        predictions.append((item_id, pred.est))
    
    # –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–ø-N
    predictions.sort(key=lambda x: x[1], reverse=True)
    return predictions[:n]

top_recs = get_top_n_recommendations(model, 'user1', n=5)
print(f"Top-5 recommendations: {top_recs}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 4. –§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å SVD</h2>
    <p><strong>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞</strong>: –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏ —Å —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π</p>
    <pre><code><strong>–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:</strong>
L = Œ£(r_ui - √ª_i^T vÃÇ_j)¬≤ + Œª(||√ª_i||¬≤ + ||vÃÇ_j||¬≤)

–≥–¥–µ:
r_ui - —Ä–µ–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
√ª_i - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è i
vÃÇ_j - –ª–∞—Ç–µ–Ω—Ç–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞ j
Œª - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

<strong>–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫:</strong>
e_ui = r_ui - √ª_i^T vÃÇ_j

√ª_i ‚Üê √ª_i + Œ±(e_ui ¬∑ vÃÇ_j - Œª ¬∑ √ª_i)
vÃÇ_j ‚Üê vÃÇ_j + Œ±(e_ui ¬∑ √ª_i - Œª ¬∑ vÃÇ_j)

–≥–¥–µ Œ± - learning rate</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 5. SVD —Å –±–∏–∞—Å–∞–º–∏ (SVD++)</h2>
    <p><strong>–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å</strong>: —É—á–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –∏ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã—Ö —Å–º–µ—â–µ–Ω–∏–π</p>
    <pre><code><strong>–§–æ—Ä–º—É–ª–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è:</strong>
rÃÇ_ui = Œº + b_u + b_i + √ª_i^T vÃÇ_j

–≥–¥–µ:
Œº - –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
b_u - bias –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è u
b_i - bias –æ–±—ä–µ–∫—Ç–∞ i

<strong>–ü—Ä–∏–º–µ—Ä:</strong>
–ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ: 3.5
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ç—Ä–æ–≥–∏–π: b_u = -0.5
–û–±—ä–µ–∫—Ç –ø–æ–ø—É–ª—è—Ä–Ω—ã–π: b_i = +0.8
–ë–∞–∑–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: 3.5 - 0.5 + 0.8 = 3.8
+ –ª–∞—Ç–µ–Ω—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã: √ª_i^T vÃÇ_j</code></pre>
    <pre><code>from surprise import SVDpp

# SVD++ —Å —É—á–µ—Ç–æ–º implicit feedback
model_svdpp = SVDpp(
    n_factors=20,
    n_epochs=20,
    lr_all=0.007,
    reg_all=0.02
)

model_svdpp.fit(trainset)
prediction = model_svdpp.predict('user1', 'movie3')
print(f"SVD++ prediction: {prediction.est:.2f}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 6. NMF (Non-negative Matrix Factorization)</h2>
    <p><strong>–ù–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</strong>: R ‚âà WH, –≥–¥–µ W,H ‚â• 0</p>
    <ul>
      <li><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ</strong>: –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã W –∏ H –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã</li>
      <li><strong>–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ</strong>: –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å (–∞–¥–¥–∏—Ç–∏–≤–Ω–∞—è –º–æ–¥–µ–ª—å)</li>
      <li><strong>W</strong>: –º–∞—Ç—Ä–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (m√ók), W ‚â• 0</li>
      <li><strong>H</strong>: –º–∞—Ç—Ä–∏—Ü–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (k√ón), H ‚â• 0</li>
      <li><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è</strong>: "—á–∞—Å—Ç–∏ —Ü–µ–ª–æ–≥–æ" (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∂–∞–Ω—Ä—ã —Ñ–∏–ª—å–º–æ–≤)</li>
    </ul>
    <pre><code><strong>–¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è:</strong>
L = ||R - WH||¬≤_F + Œ±||W||¬≤_F + Œ≤||H||¬≤_F

–≥–¥–µ ||¬∑||¬≤_F - –Ω–æ—Ä–º–∞ –§—Ä–æ–±–µ–Ω–∏—É—Å–∞

<strong>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ (multiplicative updates):</strong>
W ‚Üê W ‚äô [(RH^T) / (WHH^T + Œµ)]
H ‚Üê H ‚äô [(W^TR) / (W^TWH + Œµ)]

–≥–¥–µ ‚äô - –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ
Œµ - –º–∞–ª–∞—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 7. NMF –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π</h2>
    <pre><code>from surprise import NMF

# NMF –º–æ–¥–µ–ª—å
model_nmf = NMF(
    n_factors=15,
    n_epochs=50,
    biased=False,       # –ë–µ–∑ –±–∏–∞—Å–æ–≤
    reg_pu=0.06,        # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
    reg_qi=0.06,        # –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤
    random_state=42
)

# –û–±—É—á–µ–Ω–∏–µ
model_nmf.fit(trainset)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
prediction = model_nmf.predict('user1', 'movie3')
print(f"NMF prediction: {prediction.est:.2f}")

# –ê–Ω–∞–ª–∏–∑ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
print("User factors shape:", model_nmf.pu.shape)
print("Item factors shape:", model_nmf.qi.shape)

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤
import numpy as np

# –¢–æ–ø –æ–±—ä–µ–∫—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞
def interpret_factors(item_factors, item_ids, top_n=5):
    n_factors = item_factors.shape[1]
    
    for factor in range(n_factors):
        # –û–±—ä–µ–∫—Ç—ã —Å –Ω–∞–∏–±–æ–ª—å—à–∏–º –≤–µ—Å–æ–º –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞
        top_items_idx = np.argsort(item_factors[:, factor])[-top_n:][::-1]
        top_items = [item_ids[i] for i in top_items_idx]
        print(f"Factor {factor}: {top_items}")

# item_ids - —Å–ø–∏—Å–æ–∫ ID –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –ø–æ—Ä—è–¥–∫–µ –º–∞—Ç—Ä–∏—Ü—ã
# interpret_factors(model_nmf.qi, item_ids, top_n=3)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 8. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ SVD –∏ NMF</h2>
    <table>
      <tr><th>–ê—Å–ø–µ–∫—Ç</th><th>SVD</th><th>NMF</th></tr>
      <tr><td><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è</strong></td><td>–ù–µ—Ç</td><td>–ù–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</td></tr>
      <tr><td><strong>–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å</strong></td><td>–°—Ä–µ–¥–Ω—è—è</td><td>–í—ã—Å–æ–∫–∞—è</td></tr>
      <tr><td><strong>–¢–æ—á–Ω–æ—Å—Ç—å</strong></td><td>–û–±—ã—á–Ω–æ –≤—ã—à–µ</td><td>–ß—É—Ç—å –Ω–∏–∂–µ</td></tr>
      <tr><td><strong>–°–∫–æ—Ä–æ—Å—Ç—å</strong></td><td>–ë—ã—Å—Ç—Ä–µ–µ</td><td>–ú–µ–¥–ª–µ–Ω–Ω–µ–µ</td></tr>
      <tr><td><strong>–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å</strong></td><td>–ü–ª–æ—Ç–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</td><td>–†–∞–∑—Ä–µ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã</td></tr>
      <tr><td><strong>–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ</strong></td><td>–û–±—â–µ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è</td><td>–ß–∞—Å—Ç–∏ —Ü–µ–ª–æ–≥–æ</td></tr>
    </table>
    <blockquote>
      üí° –í—ã–±–æ—Ä –º–µ–∂–¥—É SVD –∏ NMF –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç–∏
    </blockquote>
  </div>

  <div class="block">
    <h2>üî∑ 9. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å NumPy/SciPy</h2>
    <pre><code>import numpy as np
from scipy.sparse.linalg import svds
from sklearn.decomposition import NMF as sklearn_NMF

# SVD —Å —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ–π –º–∞—Ç—Ä–∏—Ü–µ–π
from scipy.sparse import csr_matrix

# –ú–∞—Ç—Ä–∏—Ü–∞ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ (—Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è)
ratings = np.array([
    [5, 3, 0, 1],
    [4, 0, 0, 1],
    [1, 1, 0, 5],
    [0, 1, 5, 4],
])

# –ó–∞–º–µ–Ω—è–µ–º 0 –Ω–∞ —Å—Ä–µ–¥–Ω–µ–µ (–¥–ª—è SVD)
ratings_filled = ratings.copy().astype(float)
row_means = np.ma.masked_equal(ratings_filled, 0).mean(axis=1).data
for i in range(len(ratings_filled)):
    ratings_filled[i][ratings_filled[i] == 0] = row_means[i]

# SVD —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ (k=2 —Ñ–∞–∫—Ç–æ—Ä–∞)
U, sigma, Vt = svds(ratings_filled, k=2)

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—Ü—ã
sigma = np.diag(sigma)
predicted_ratings = np.dot(np.dot(U, sigma), Vt)

print("Predicted ratings:
", predicted_ratings)

# NMF —Å sklearn
nmf_model = sklearn_NMF(
    n_components=2,
    init='random',
    random_state=42,
    max_iter=200
)

# –ó–∞–º–µ–Ω—è–µ–º 0 –Ω–∞ –º–∞–ª–æ–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ
ratings_positive = np.where(ratings > 0, ratings, 0.1)

W = nmf_model.fit_transform(ratings_positive)
H = nmf_model.components_

predicted_nmf = np.dot(W, H)
print("
NMF predicted ratings:
", predicted_nmf)</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 10. –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –≤–∞—Ä–∏–∞–Ω—Ç—ã</h2>
    <p><strong>1. Probabilistic Matrix Factorization (PMF)</strong></p>
    <ul>
      <li>–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –∫ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</li>
      <li>–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏</li>
    </ul>
    <p><strong>2. Weighted Matrix Factorization</strong></p>
    <ul>
      <li>–†–∞–∑–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö/–Ω–µ–Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤</li>
      <li>–î–ª—è implicit feedback</li>
    </ul>
    <p><strong>3. Temporal SVD</strong></p>
    <pre><code># –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–∏
rÃÇ_ui(t) = Œº + b_u(t) + b_i(t) + √ª_i(t)^T vÃÇ_j(t)

–≥–¥–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤—Ä–µ–º–µ–Ω–∏</code></pre>
    <p><strong>4. Factorization Machines</strong></p>
    <ul>
      <li>–û–±–æ–±—â–µ–Ω–∏–µ –º–∞—Ç—Ä–∏—á–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏</li>
      <li>–£—á–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤</li>
    </ul>
  </div>

  <div class="block">
    <h2>üî∑ 11. –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</h2>
    <table>
      <tr><th>–ü–∞—Ä–∞–º–µ—Ç—Ä</th><th>–û–ø–∏—Å–∞–Ω–∏–µ</th><th>–¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</th></tr>
      <tr><td><code>n_factors</code></td><td>–ß–∏—Å–ª–æ –ª–∞—Ç–µ–Ω—Ç–Ω—ã—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤</td><td>20-200</td></tr>
      <tr><td><code>n_epochs</code></td><td>–ß–∏—Å–ª–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –æ–±—É—á–µ–Ω–∏—è</td><td>20-100</td></tr>
      <tr><td><code>lr_all</code></td><td>Learning rate</td><td>0.001-0.01</td></tr>
      <tr><td><code>reg_all</code></td><td>–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (L2)</td><td>0.01-0.1</td></tr>
      <tr><td><code>biased</code></td><td>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–∞—Å—ã</td><td>True (–æ–±—ã—á–Ω–æ)</td></tr>
    </table>
    <pre><code># Grid search –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
from surprise.model_selection import GridSearchCV

param_grid = {
    'n_factors': [20, 50, 100],
    'n_epochs': [20, 30],
    'lr_all': [0.002, 0.005],
    'reg_all': [0.02, 0.05]
}

gs = GridSearchCV(SVD, param_grid, measures=['rmse'], cv=3)
gs.fit(dataset)

print(f"Best RMSE: {gs.best_score['rmse']}")
print(f"Best params: {gs.best_params['rmse']}")</code></pre>
  </div>

  <div class="block">
    <h2>üî∑ 12. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã</h2>
    <ul>
      <li><strong>–ß–∏—Å–ª–æ —Ñ–∞–∫—Ç–æ—Ä–æ–≤</strong>: –Ω–∞—á–∏–Ω–∞–π—Ç–µ —Å 50, –ø–æ–¥–±–∏—Ä–∞–π—Ç–µ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏</li>
      <li><strong>–†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è</strong>: –≤–∞–∂–Ω–∞ –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è</li>
      <li><strong>–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–æ–≤</strong>: –Ω–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ –≤ [0,1] –∏–ª–∏ [-1,1]</li>
      <li><strong>–•–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç</strong>: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–∏–±—Ä–∏–¥–Ω—ã–µ –º–µ—Ç–æ–¥—ã</li>
      <li><strong>Implicit feedback</strong>: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ weighted approaches</li>
      <li><strong>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏</strong>: –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ</li>
      <li><strong>Bias terms</strong>: –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞ —É–ª—É—á—à–∞—é—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</li>
      <li><strong>–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç—å</strong>: MF —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ 90%+ —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–æ—Å—Ç–∏</li>
    </ul>
    <blockquote>
      üí° –ú–∞—Ç—Ä–∏—á–Ω–∞—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è - –æ—Å–Ω–æ–≤–∞ –º–Ω–æ–≥–∏—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
    </blockquote>
  </div>

</div>

</div>
</body>
</html>
